{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "d98f0cfd",
   "metadata": {
    "papermill": {
     "duration": 0.012601,
     "end_time": "2024-10-13T04:15:52.622620",
     "exception": false,
     "start_time": "2024-10-13T04:15:52.610019",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<a href=\"https://www.kaggle.com/code/pietrocaforio/unimodal-ct-training-kaggle?scriptVersionId=197281783\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "78ebb6d0",
   "metadata": {
    "papermill": {
     "duration": 0.012394,
     "end_time": "2024-10-13T04:15:52.646454",
     "exception": false,
     "start_time": "2024-10-13T04:15:52.634060",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Train 3D unimodal CT"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "28d25521",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-13T04:15:52.671726Z",
     "iopub.status.busy": "2024-10-13T04:15:52.671194Z",
     "iopub.status.idle": "2024-10-13T04:15:55.670272Z",
     "shell.execute_reply": "2024-10-13T04:15:55.669158Z"
    },
    "papermill": {
     "duration": 3.014848,
     "end_time": "2024-10-13T04:15:55.672788",
     "exception": false,
     "start_time": "2024-10-13T04:15:52.657940",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Cloning into 'research-biocv-proj'...\r\n",
      "remote: Enumerating objects: 489, done.\u001b[K\r\n",
      "remote: Counting objects: 100% (34/34), done.\u001b[K\r\n",
      "remote: Compressing objects: 100% (27/27), done.\u001b[K\r\n",
      "remote: Total 489 (delta 14), reused 21 (delta 7), pack-reused 455 (from 1)\u001b[K\r\n",
      "Receiving objects: 100% (489/489), 3.99 MiB | 19.83 MiB/s, done.\r\n",
      "Resolving deltas: 100% (294/294), done.\r\n",
      "Branch 'dev' set up to track remote branch 'dev' from 'origin'.\r\n",
      "Switched to a new branch 'dev'\r\n"
     ]
    }
   ],
   "source": [
    "!git clone https://github.com/PietroCaforio/research-biocv-proj\n",
    "!cd research-biocv-proj && git switch dev"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "7811abde",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-13T04:15:55.699955Z",
     "iopub.status.busy": "2024-10-13T04:15:55.699525Z",
     "iopub.status.idle": "2024-10-13T04:15:56.943342Z",
     "shell.execute_reply": "2024-10-13T04:15:56.942030Z"
    },
    "papermill": {
     "duration": 1.260824,
     "end_time": "2024-10-13T04:15:56.946255",
     "exception": false,
     "start_time": "2024-10-13T04:15:55.685431",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Already up to date.\r\n"
     ]
    }
   ],
   "source": [
    "!cd research-biocv-proj && git pull"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "47cc9e1c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-13T04:15:56.977572Z",
     "iopub.status.busy": "2024-10-13T04:15:56.977136Z",
     "iopub.status.idle": "2024-10-13T04:16:11.113792Z",
     "shell.execute_reply": "2024-10-13T04:16:11.112484Z"
    },
    "papermill": {
     "duration": 14.156845,
     "end_time": "2024-10-13T04:16:11.116690",
     "exception": false,
     "start_time": "2024-10-13T04:15:56.959845",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Requirement already satisfied: wandb in /opt/conda/lib/python3.10/site-packages (0.18.3)\r\n",
      "Requirement already satisfied: click!=8.0.0,>=7.1 in /opt/conda/lib/python3.10/site-packages (from wandb) (8.1.7)\r\n",
      "Requirement already satisfied: docker-pycreds>=0.4.0 in /opt/conda/lib/python3.10/site-packages (from wandb) (0.4.0)\r\n",
      "Requirement already satisfied: gitpython!=3.1.29,>=1.0.0 in /opt/conda/lib/python3.10/site-packages (from wandb) (3.1.43)\r\n",
      "Requirement already satisfied: platformdirs in /opt/conda/lib/python3.10/site-packages (from wandb) (3.11.0)\r\n",
      "Requirement already satisfied: protobuf!=4.21.0,!=5.28.0,<6,>=3.19.0 in /opt/conda/lib/python3.10/site-packages (from wandb) (3.20.3)\r\n",
      "Requirement already satisfied: psutil>=5.0.0 in /opt/conda/lib/python3.10/site-packages (from wandb) (5.9.3)\r\n",
      "Requirement already satisfied: pyyaml in /opt/conda/lib/python3.10/site-packages (from wandb) (6.0.2)\r\n",
      "Requirement already satisfied: requests<3,>=2.0.0 in /opt/conda/lib/python3.10/site-packages (from wandb) (2.32.3)\r\n",
      "Requirement already satisfied: sentry-sdk>=1.0.0 in /opt/conda/lib/python3.10/site-packages (from wandb) (2.15.0)\r\n",
      "Requirement already satisfied: setproctitle in /opt/conda/lib/python3.10/site-packages (from wandb) (1.3.3)\r\n",
      "Requirement already satisfied: setuptools in /opt/conda/lib/python3.10/site-packages (from wandb) (70.0.0)\r\n",
      "Requirement already satisfied: six>=1.4.0 in /opt/conda/lib/python3.10/site-packages (from docker-pycreds>=0.4.0->wandb) (1.16.0)\r\n",
      "Requirement already satisfied: gitdb<5,>=4.0.1 in /opt/conda/lib/python3.10/site-packages (from gitpython!=3.1.29,>=1.0.0->wandb) (4.0.11)\r\n",
      "Requirement already satisfied: charset-normalizer<4,>=2 in /opt/conda/lib/python3.10/site-packages (from requests<3,>=2.0.0->wandb) (3.3.2)\r\n",
      "Requirement already satisfied: idna<4,>=2.5 in /opt/conda/lib/python3.10/site-packages (from requests<3,>=2.0.0->wandb) (3.7)\r\n",
      "Requirement already satisfied: urllib3<3,>=1.21.1 in /opt/conda/lib/python3.10/site-packages (from requests<3,>=2.0.0->wandb) (1.26.18)\r\n",
      "Requirement already satisfied: certifi>=2017.4.17 in /opt/conda/lib/python3.10/site-packages (from requests<3,>=2.0.0->wandb) (2024.8.30)\r\n",
      "Requirement already satisfied: smmap<6,>=3.0.1 in /opt/conda/lib/python3.10/site-packages (from gitdb<5,>=4.0.1->gitpython!=3.1.29,>=1.0.0->wandb) (5.0.1)\r\n"
     ]
    }
   ],
   "source": [
    "!pip install wandb"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "e28c9e34",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-13T04:16:11.153204Z",
     "iopub.status.busy": "2024-10-13T04:16:11.152808Z",
     "iopub.status.idle": "2024-10-13T04:16:11.252934Z",
     "shell.execute_reply": "2024-10-13T04:16:11.251916Z"
    },
    "papermill": {
     "duration": 0.120235,
     "end_time": "2024-10-13T04:16:11.255471",
     "exception": false,
     "start_time": "2024-10-13T04:16:11.135236",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "from kaggle_secrets import UserSecretsClient\n",
    "user_secrets = UserSecretsClient()\n",
    "secret_value_0 = user_secrets.get_secret(\"3d_wandb_key\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "c44b95ad",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-13T04:16:11.291008Z",
     "iopub.status.busy": "2024-10-13T04:16:11.290212Z",
     "iopub.status.idle": "2024-10-13T04:16:12.889964Z",
     "shell.execute_reply": "2024-10-13T04:16:12.888918Z"
    },
    "papermill": {
     "duration": 1.621556,
     "end_time": "2024-10-13T04:16:12.892338",
     "exception": false,
     "start_time": "2024-10-13T04:16:11.270782",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\u001b[34m\u001b[1mwandb\u001b[0m: Using wandb-core as the SDK backend. Please refer to https://wandb.me/wandb-core for more information.\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: W&B API key is configured. Use \u001b[1m`wandb login --relogin`\u001b[0m to force relogin\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: \u001b[33mWARNING\u001b[0m If you're specifying your api key in code, ensure this code is not shared publicly.\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: \u001b[33mWARNING\u001b[0m Consider setting the WANDB_API_KEY environment variable, or running `wandb login` from the command line.\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: Appending key for api.wandb.ai to your netrc file: /root/.netrc\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "True"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import wandb\n",
    "wandb.login(key=secret_value_0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "e0016ac4",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-13T04:16:12.923047Z",
     "iopub.status.busy": "2024-10-13T04:16:12.922277Z",
     "iopub.status.idle": "2024-10-13T04:16:17.675873Z",
     "shell.execute_reply": "2024-10-13T04:16:17.674989Z"
    },
    "papermill": {
     "duration": 4.772015,
     "end_time": "2024-10-13T04:16:17.678715",
     "exception": false,
     "start_time": "2024-10-13T04:16:12.906700",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "import sys\n",
    "from pathlib import Path\n",
    "\n",
    "# Add the 'data' directory to sys.path\n",
    "sys.path.append(str(Path('research-biocv-proj').resolve()))\n",
    "from data.unimodal3D import *\n",
    "from pathlib import Path\n",
    "\n",
    "import numpy as np\n",
    "import torch\n",
    "from torch.utils.data import DataLoader\n",
    "\n",
    "from sklearn.utils.class_weight import compute_class_weight"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e1f0ddc9",
   "metadata": {
    "papermill": {
     "duration": 0.012751,
     "end_time": "2024-10-13T04:16:17.705486",
     "exception": false,
     "start_time": "2024-10-13T04:16:17.692735",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "### Train ResNet model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "5af05c0f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-13T04:16:17.734015Z",
     "iopub.status.busy": "2024-10-13T04:16:17.733058Z",
     "iopub.status.idle": "2024-10-13T04:16:17.745190Z",
     "shell.execute_reply": "2024-10-13T04:16:17.744170Z"
    },
    "papermill": {
     "duration": 0.028592,
     "end_time": "2024-10-13T04:16:17.747324",
     "exception": false,
     "start_time": "2024-10-13T04:16:17.718732",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "class EarlyStopping:\n",
    "    \"\"\"Early stops the training if validation loss doesn't improve after a given patience.\"\"\"\n",
    "    def __init__(self, patience=7, verbose=False, delta=0, path='checkpoint.pt', trace_func=print):\n",
    "        \"\"\"\n",
    "        Args:\n",
    "            patience (int): How long to wait after last time validation loss improved.\n",
    "                            Default: 7\n",
    "            verbose (bool): If True, prints a message for each validation loss improvement. \n",
    "                            Default: False\n",
    "            delta (float): Minimum change in the monitored quantity to qualify as an improvement.\n",
    "                            Default: 0\n",
    "            path (str): Path for the checkpoint to be saved to.\n",
    "                            Default: 'checkpoint.pt'\n",
    "            trace_func (function): trace print function.\n",
    "                            Default: print            \n",
    "        \"\"\"\n",
    "        self.patience = patience\n",
    "        self.verbose = verbose\n",
    "        self.counter = 0\n",
    "        self.best_score = None\n",
    "        self.early_stop = False\n",
    "        self.val_loss_min = np.Inf\n",
    "        self.delta = delta\n",
    "        self.path = path\n",
    "        self.trace_func = trace_func\n",
    "    def __call__(self, val_loss, model):\n",
    "\n",
    "        score = -val_loss\n",
    "\n",
    "        if self.best_score is None:\n",
    "            self.best_score = score\n",
    "            self.save_checkpoint(val_loss, model)\n",
    "        elif score < self.best_score + self.delta:\n",
    "            self.counter += 1\n",
    "            self.trace_func(f'EarlyStopping counter: {self.counter} out of {self.patience}')\n",
    "            if self.counter >= self.patience:\n",
    "                self.early_stop = True\n",
    "        else:\n",
    "            self.best_score = score\n",
    "            self.save_checkpoint(val_loss, model)\n",
    "            self.counter = 0\n",
    "\n",
    "    def save_checkpoint(self, val_loss, model):\n",
    "        '''Saves model when validation loss decrease.'''\n",
    "        if self.verbose:\n",
    "            self.trace_func(f'Validation loss decreased ({self.val_loss_min:.6f} --> {val_loss:.6f}).  Saving model ...')\n",
    "        torch.save(model.state_dict(), self.path)\n",
    "        self.val_loss_min = val_loss"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "326c42be",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-13T04:16:17.775938Z",
     "iopub.status.busy": "2024-10-13T04:16:17.775142Z",
     "iopub.status.idle": "2024-10-13T04:16:17.802650Z",
     "shell.execute_reply": "2024-10-13T04:16:17.801743Z"
    },
    "papermill": {
     "duration": 0.04372,
     "end_time": "2024-10-13T04:16:17.804592",
     "exception": false,
     "start_time": "2024-10-13T04:16:17.760872",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "def train(model,config, run_name=None):\n",
    "    wandb.init(\n",
    "        # set the wandb project where this run will be logged\n",
    "        project=\"3Dunimodal_ct_training\",\n",
    "        name = run_name,\n",
    "        # track hyperparameters and run metadata\n",
    "        config=config\n",
    "    )\n",
    "    optimizer = optim.Adam(model.parameters(), lr=config[\"learning_rate\"], weight_decay=config[\"weight_decay\"])\n",
    "    if config[\"class_weights\"] is not None: \n",
    "        config[\"class_weights\"] = torch.tensor(config[\"class_weights\"], dtype=torch.float).to(device)\n",
    "    \n",
    "    if config[\"focal_loss\"] is not None:\n",
    "        criterion = FocalLoss(gamma = config[\"focal_loss\"])\n",
    "    else:\n",
    "        criterion = nn.CrossEntropyLoss(weight = config[\"class_weights\"])\n",
    "    \n",
    "    scheduler = optim.lr_scheduler.ReduceLROnPlateau(optimizer, 'min',factor = config[\"reduce_lr_factor\"], patience = config[\"patience\"])\n",
    "    # initialize the early_stopping object\n",
    "    early_stopping = None\n",
    "    if config[\"early_stop_patience\"] is not None:\n",
    "        early_stopping = EarlyStopping(patience=config[\"early_stop_patience\"], verbose=True)\n",
    "    \n",
    "    # Training loop\n",
    "    num_epochs = config[\"epochs\"]\n",
    "    for epoch in range(num_epochs):\n",
    "        model.train()\n",
    "        running_loss = 0.0\n",
    "        train_correct = 0\n",
    "        total = 0\n",
    "        correct_per_class = [0, 0, 0]  # For G1, G2, G3\n",
    "        total_per_class = [0, 0, 0]  # For G1, G2, G3\n",
    "        for batch in train_loader:\n",
    "            volumes = batch['volume'].float().to(device)\n",
    "            labels = batch['label'].long().to(device)\n",
    "            #print(f\"volumes batch dimensions: {volumes.size()}\")\n",
    "            optimizer.zero_grad()\n",
    "            outputs = model(volumes.unsqueeze(1))\n",
    "            \n",
    "            if config[\"focal_loss\"]:\n",
    "                softmax = torch.nn.Softmax(dim=-1)\n",
    "                loss = criterion(softmax(outputs), labels)\n",
    "            else:\n",
    "                loss = criterion(outputs, labels)\n",
    "            \n",
    "            _, predicted = torch.max(outputs, 1)\n",
    "            train_correct += (predicted == labels).sum().item()\n",
    "            loss.backward()\n",
    "            optimizer.step()\n",
    "            total += labels.size(0)\n",
    "            running_loss += loss.item()\n",
    "            \n",
    "            # Calculate accuracy per class\n",
    "            for i in range(3):  # We have 3 classes: G1 (0), G2 (1), G3 (2)\n",
    "                correct_per_class[i] += ((predicted == i) & (labels == i)).sum().item()\n",
    "                total_per_class[i] += (labels == i).sum().item()\n",
    "\n",
    "        train_accuracy = 100 * train_correct / total\n",
    "        class_accuracy = [(100 * correct_per_class[i] / total_per_class[i]) if total_per_class[i] > 0 else 0 for i in range(3)]\n",
    "        print(f\"Epoch {epoch+1}, Loss: {running_loss/len(train_loader)}\")\n",
    "        wandb.log({\"Train Accuracy\": train_accuracy, \"Train loss\": running_loss/len(train_loader), \"G1_TrainAcc\":class_accuracy[0], \"G2_TrainAcc\":class_accuracy[1], \"G3_TrainAcc\":class_accuracy[2]})\n",
    "\n",
    "        # Validation loop\n",
    "        model.eval()\n",
    "        val_loss = 0.0\n",
    "        correct = 0\n",
    "        total = 0\n",
    "        # Initialize counters for each class (G1, G2, G3)\n",
    "        correct_per_class = [0, 0, 0]  # For G1, G2, G3\n",
    "        total_per_class = [0, 0, 0]  # For G1, G2, G3\n",
    "\n",
    "        with torch.no_grad():\n",
    "            for batch in val_loader:\n",
    "                volumes = batch['volume'].float().to(device)\n",
    "                labels = batch['label'].long().to(device)\n",
    "                \n",
    "                outputs = model(volumes.unsqueeze(1))\n",
    "                if config[\"focal_loss\"]:\n",
    "                    softmax = torch.nn.Softmax(dim=-1)\n",
    "                    loss = criterion(softmax(outputs), labels)\n",
    "                else:\n",
    "                    loss = criterion(outputs, labels)\n",
    "                \n",
    "                val_loss += loss.item()\n",
    "                _, predicted = torch.max(outputs, 1)\n",
    "                total += labels.size(0)\n",
    "                correct += (predicted == labels).sum().item()\n",
    "\n",
    "                # Calculate accuracy per class\n",
    "                for i in range(3):  # We have 3 classes: G1 (0), G2 (1), G3 (2)\n",
    "                    correct_per_class[i] += ((predicted == i) & (labels == i)).sum().item()\n",
    "                    total_per_class[i] += (labels == i).sum().item()\n",
    "        scheduler.step(val_loss)\n",
    "        # Compute total accuracy and per-class accuracy\n",
    "        total_accuracy = 100 * correct / total\n",
    "        class_accuracy = [(100 * correct_per_class[i] / total_per_class[i]) if total_per_class[i] > 0 else 0 for i in range(3)]\n",
    "        print(f\"Validation Loss: {val_loss/len(val_loader)}, Total Accuracy: {total_accuracy:.2f}%\")\n",
    "        print(f\"Accuracy per class - G1: {class_accuracy[0]:.2f}%, G2: {class_accuracy[1]:.2f}%, G3: {class_accuracy[2]:.2f}%\")\n",
    "        # log metrics to wandb\n",
    "        wandb.log({\"Total Accuracy\": total_accuracy, \"Validation Loss\": val_loss/len(val_loader), \"G1_Acc\":class_accuracy[0], \"G2_Acc\":class_accuracy[1], \"G3_Acc\":class_accuracy[2]})\n",
    "        if config[\"early_stop_patience\"] is not None:\n",
    "            early_stopping(val_loss, model)\n",
    "        \n",
    "        if config[\"early_stop_patience\"] is not None:\n",
    "            if early_stopping.early_stop:\n",
    "                print(\"Early stopping\")\n",
    "                break\n",
    "    wandb.finish()   "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "444047d8",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-13T04:16:17.833824Z",
     "iopub.status.busy": "2024-10-13T04:16:17.833102Z",
     "iopub.status.idle": "2024-10-13T04:16:20.073493Z",
     "shell.execute_reply": "2024-10-13T04:16:20.072348Z"
    },
    "papermill": {
     "duration": 2.25791,
     "end_time": "2024-10-13T04:16:20.076139",
     "exception": false,
     "start_time": "2024-10-13T04:16:17.818229",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "import torch.nn as nn\n",
    "import torch.optim as optim\n",
    "from transformers import ResNetForImageClassification"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "3cab2933",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-13T04:16:20.104833Z",
     "iopub.status.busy": "2024-10-13T04:16:20.104248Z",
     "iopub.status.idle": "2024-10-13T04:16:47.308458Z",
     "shell.execute_reply": "2024-10-13T04:16:47.307434Z"
    },
    "papermill": {
     "duration": 27.221523,
     "end_time": "2024-10-13T04:16:47.311247",
     "exception": false,
     "start_time": "2024-10-13T04:16:20.089724",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "train_dataset = UnimodalCTDataset3D(split='train',dataset_path = \"/kaggle/input/processed57patients3d/processed_3D_pad\" )\n",
    "val_dataset = UnimodalCTDataset3D(split='val',dataset_path = \"/kaggle/input/processed57patients3d/processed_3D_pad\")\n",
    "\n",
    "train_loader = DataLoader(train_dataset, batch_size=5, shuffle=True)\n",
    "val_loader = DataLoader(val_dataset, batch_size=2, shuffle=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "7c94f091",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-13T04:16:47.340957Z",
     "iopub.status.busy": "2024-10-13T04:16:47.340492Z",
     "iopub.status.idle": "2024-10-13T04:16:47.346301Z",
     "shell.execute_reply": "2024-10-13T04:16:47.345210Z"
    },
    "papermill": {
     "duration": 0.023786,
     "end_time": "2024-10-13T04:16:47.349041",
     "exception": false,
     "start_time": "2024-10-13T04:16:47.325255",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Training set stats:{'length': 139, 'class_frequency': {'G1': 11, 'G2': 91, 'G3': 37}}\n",
      "Validation set stats:{'length': 18, 'class_frequency': {'G1': 4, 'G2': 8, 'G3': 6}}\n"
     ]
    }
   ],
   "source": [
    "print(f\"Training set stats:{train_dataset.stats()}\")\n",
    "print(f\"Validation set stats:{val_dataset.stats()}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "5defb661",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-13T04:16:47.379436Z",
     "iopub.status.busy": "2024-10-13T04:16:47.379015Z",
     "iopub.status.idle": "2024-10-13T04:16:48.707580Z",
     "shell.execute_reply": "2024-10-13T04:16:48.706359Z"
    },
    "papermill": {
     "duration": 1.346982,
     "end_time": "2024-10-13T04:16:48.710294",
     "exception": false,
     "start_time": "2024-10-13T04:16:47.363312",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "labels = []\n",
    "for sample in train_dataset:\n",
    "    labels.append(sample[\"label\"])\n",
    "labels = np.array(labels)\n",
    "class_weights = compute_class_weight(\"balanced\", classes=np.unique(labels), y=labels)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "5136503f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-13T04:16:48.740569Z",
     "iopub.status.busy": "2024-10-13T04:16:48.739796Z",
     "iopub.status.idle": "2024-10-13T04:16:48.745715Z",
     "shell.execute_reply": "2024-10-13T04:16:48.744654Z"
    },
    "papermill": {
     "duration": 0.02308,
     "end_time": "2024-10-13T04:16:48.748121",
     "exception": false,
     "start_time": "2024-10-13T04:16:48.725041",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[4.21212121 0.50915751 1.25225225]\n"
     ]
    }
   ],
   "source": [
    "print(class_weights)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a5ade6a8",
   "metadata": {
    "papermill": {
     "duration": 0.014449,
     "end_time": "2024-10-13T04:16:48.777398",
     "exception": false,
     "start_time": "2024-10-13T04:16:48.762949",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "### 3D Resnet-18"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "de1de865",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-13T04:16:48.808749Z",
     "iopub.status.busy": "2024-10-13T04:16:48.808049Z",
     "iopub.status.idle": "2024-10-13T04:16:49.897613Z",
     "shell.execute_reply": "2024-10-13T04:16:49.896776Z"
    },
    "papermill": {
     "duration": 1.108033,
     "end_time": "2024-10-13T04:16:49.900228",
     "exception": false,
     "start_time": "2024-10-13T04:16:48.792195",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "import torchvision.models as models"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "d82f7aed",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-13T04:16:49.930273Z",
     "iopub.status.busy": "2024-10-13T04:16:49.929862Z",
     "iopub.status.idle": "2024-10-13T04:16:49.937047Z",
     "shell.execute_reply": "2024-10-13T04:16:49.936087Z"
    },
    "papermill": {
     "duration": 0.024527,
     "end_time": "2024-10-13T04:16:49.939150",
     "exception": false,
     "start_time": "2024-10-13T04:16:49.914623",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "class ResNet3D(nn.Module):\n",
    "    def __init__(self, num_classes):\n",
    "        super(ResNet3D, self).__init__()\n",
    "        self.model = models.video.r3d_18(pretrained=True)  # 3D ResNet18\n",
    "        self.model.stem[0] = nn.Conv3d(1, 64, kernel_size=(7, 7, 7), stride=(2, 2, 2), padding=(3, 3, 3), bias=False)\n",
    "        self.model.fc = nn.Linear(self.model.fc.in_features, num_classes)\n",
    "    \n",
    "    def forward(self, x):\n",
    "        return self.model(x)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "07b192e6",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-13T04:16:49.968018Z",
     "iopub.status.busy": "2024-10-13T04:16:49.967617Z",
     "iopub.status.idle": "2024-10-13T04:16:51.649161Z",
     "shell.execute_reply": "2024-10-13T04:16:51.647981Z"
    },
    "papermill": {
     "duration": 1.698684,
     "end_time": "2024-10-13T04:16:51.651833",
     "exception": false,
     "start_time": "2024-10-13T04:16:49.953149",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/opt/conda/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.\n",
      "  warnings.warn(\n",
      "/opt/conda/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=R3D_18_Weights.KINETICS400_V1`. You can also use `weights=R3D_18_Weights.DEFAULT` to get the most up-to-date weights.\n",
      "  warnings.warn(msg)\n",
      "Downloading: \"https://download.pytorch.org/models/r3d_18-b3b3357e.pth\" to /root/.cache/torch/hub/checkpoints/r3d_18-b3b3357e.pth\n",
      "100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 127M/127M [00:00<00:00, 174MB/s]\n"
     ]
    }
   ],
   "source": [
    "model = ResNet3D(num_classes = 3)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "62471657",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-13T04:16:51.686678Z",
     "iopub.status.busy": "2024-10-13T04:16:51.685858Z",
     "iopub.status.idle": "2024-10-13T04:16:51.952250Z",
     "shell.execute_reply": "2024-10-13T04:16:51.951244Z"
    },
    "papermill": {
     "duration": 0.286888,
     "end_time": "2024-10-13T04:16:51.954507",
     "exception": false,
     "start_time": "2024-10-13T04:16:51.667619",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "ResNet3D(\n",
       "  (model): VideoResNet(\n",
       "    (stem): BasicStem(\n",
       "      (0): Conv3d(1, 64, kernel_size=(7, 7, 7), stride=(2, 2, 2), padding=(3, 3, 3), bias=False)\n",
       "      (1): BatchNorm3d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "      (2): ReLU(inplace=True)\n",
       "    )\n",
       "    (layer1): Sequential(\n",
       "      (0): BasicBlock(\n",
       "        (conv1): Sequential(\n",
       "          (0): Conv3DSimple(64, 64, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "          (2): ReLU(inplace=True)\n",
       "        )\n",
       "        (conv2): Sequential(\n",
       "          (0): Conv3DSimple(64, 64, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "        )\n",
       "        (relu): ReLU(inplace=True)\n",
       "      )\n",
       "      (1): BasicBlock(\n",
       "        (conv1): Sequential(\n",
       "          (0): Conv3DSimple(64, 64, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "          (2): ReLU(inplace=True)\n",
       "        )\n",
       "        (conv2): Sequential(\n",
       "          (0): Conv3DSimple(64, 64, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "        )\n",
       "        (relu): ReLU(inplace=True)\n",
       "      )\n",
       "    )\n",
       "    (layer2): Sequential(\n",
       "      (0): BasicBlock(\n",
       "        (conv1): Sequential(\n",
       "          (0): Conv3DSimple(64, 128, kernel_size=(3, 3, 3), stride=(2, 2, 2), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "          (2): ReLU(inplace=True)\n",
       "        )\n",
       "        (conv2): Sequential(\n",
       "          (0): Conv3DSimple(128, 128, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "        )\n",
       "        (relu): ReLU(inplace=True)\n",
       "        (downsample): Sequential(\n",
       "          (0): Conv3d(64, 128, kernel_size=(1, 1, 1), stride=(2, 2, 2), bias=False)\n",
       "          (1): BatchNorm3d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "        )\n",
       "      )\n",
       "      (1): BasicBlock(\n",
       "        (conv1): Sequential(\n",
       "          (0): Conv3DSimple(128, 128, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "          (2): ReLU(inplace=True)\n",
       "        )\n",
       "        (conv2): Sequential(\n",
       "          (0): Conv3DSimple(128, 128, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "        )\n",
       "        (relu): ReLU(inplace=True)\n",
       "      )\n",
       "    )\n",
       "    (layer3): Sequential(\n",
       "      (0): BasicBlock(\n",
       "        (conv1): Sequential(\n",
       "          (0): Conv3DSimple(128, 256, kernel_size=(3, 3, 3), stride=(2, 2, 2), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "          (2): ReLU(inplace=True)\n",
       "        )\n",
       "        (conv2): Sequential(\n",
       "          (0): Conv3DSimple(256, 256, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "        )\n",
       "        (relu): ReLU(inplace=True)\n",
       "        (downsample): Sequential(\n",
       "          (0): Conv3d(128, 256, kernel_size=(1, 1, 1), stride=(2, 2, 2), bias=False)\n",
       "          (1): BatchNorm3d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "        )\n",
       "      )\n",
       "      (1): BasicBlock(\n",
       "        (conv1): Sequential(\n",
       "          (0): Conv3DSimple(256, 256, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "          (2): ReLU(inplace=True)\n",
       "        )\n",
       "        (conv2): Sequential(\n",
       "          (0): Conv3DSimple(256, 256, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "        )\n",
       "        (relu): ReLU(inplace=True)\n",
       "      )\n",
       "    )\n",
       "    (layer4): Sequential(\n",
       "      (0): BasicBlock(\n",
       "        (conv1): Sequential(\n",
       "          (0): Conv3DSimple(256, 512, kernel_size=(3, 3, 3), stride=(2, 2, 2), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "          (2): ReLU(inplace=True)\n",
       "        )\n",
       "        (conv2): Sequential(\n",
       "          (0): Conv3DSimple(512, 512, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "        )\n",
       "        (relu): ReLU(inplace=True)\n",
       "        (downsample): Sequential(\n",
       "          (0): Conv3d(256, 512, kernel_size=(1, 1, 1), stride=(2, 2, 2), bias=False)\n",
       "          (1): BatchNorm3d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "        )\n",
       "      )\n",
       "      (1): BasicBlock(\n",
       "        (conv1): Sequential(\n",
       "          (0): Conv3DSimple(512, 512, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "          (2): ReLU(inplace=True)\n",
       "        )\n",
       "        (conv2): Sequential(\n",
       "          (0): Conv3DSimple(512, 512, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "        )\n",
       "        (relu): ReLU(inplace=True)\n",
       "      )\n",
       "    )\n",
       "    (avgpool): AdaptiveAvgPool3d(output_size=(1, 1, 1))\n",
       "    (fc): Linear(in_features=512, out_features=3, bias=True)\n",
       "  )\n",
       ")"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "device = torch.device(\"cuda\" if torch.cuda.is_available() else \"cpu\")\n",
    "model.to(device)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "ce0e59b6",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-13T04:16:51.987617Z",
     "iopub.status.busy": "2024-10-13T04:16:51.987223Z",
     "iopub.status.idle": "2024-10-13T04:17:05.741547Z",
     "shell.execute_reply": "2024-10-13T04:17:05.739871Z"
    },
    "papermill": {
     "duration": 13.77432,
     "end_time": "2024-10-13T04:17:05.744430",
     "exception": false,
     "start_time": "2024-10-13T04:16:51.970110",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Collecting focal_loss_torch\r\n",
      "  Downloading focal_loss_torch-0.1.2-py3-none-any.whl.metadata (2.2 kB)\r\n",
      "Requirement already satisfied: torch in /opt/conda/lib/python3.10/site-packages (from focal_loss_torch) (2.4.0)\r\n",
      "Requirement already satisfied: numpy in /opt/conda/lib/python3.10/site-packages (from focal_loss_torch) (1.26.4)\r\n",
      "Requirement already satisfied: filelock in /opt/conda/lib/python3.10/site-packages (from torch->focal_loss_torch) (3.15.1)\r\n",
      "Requirement already satisfied: typing-extensions>=4.8.0 in /opt/conda/lib/python3.10/site-packages (from torch->focal_loss_torch) (4.12.2)\r\n",
      "Requirement already satisfied: sympy in /opt/conda/lib/python3.10/site-packages (from torch->focal_loss_torch) (1.13.3)\r\n",
      "Requirement already satisfied: networkx in /opt/conda/lib/python3.10/site-packages (from torch->focal_loss_torch) (3.3)\r\n",
      "Requirement already satisfied: jinja2 in /opt/conda/lib/python3.10/site-packages (from torch->focal_loss_torch) (3.1.4)\r\n",
      "Requirement already satisfied: fsspec in /opt/conda/lib/python3.10/site-packages (from torch->focal_loss_torch) (2024.6.1)\r\n",
      "Requirement already satisfied: MarkupSafe>=2.0 in /opt/conda/lib/python3.10/site-packages (from jinja2->torch->focal_loss_torch) (2.1.5)\r\n",
      "Requirement already satisfied: mpmath<1.4,>=1.1.0 in /opt/conda/lib/python3.10/site-packages (from sympy->torch->focal_loss_torch) (1.3.0)\r\n",
      "Downloading focal_loss_torch-0.1.2-py3-none-any.whl (4.5 kB)\r\n",
      "Installing collected packages: focal_loss_torch\r\n",
      "Successfully installed focal_loss_torch-0.1.2\r\n"
     ]
    }
   ],
   "source": [
    "#https://github.com/mathiaszinnen/focal_loss_torch/tree/main\n",
    "!pip install focal_loss_torch"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "8ddd69aa",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-13T04:17:05.781373Z",
     "iopub.status.busy": "2024-10-13T04:17:05.780932Z",
     "iopub.status.idle": "2024-10-13T10:05:29.088808Z",
     "shell.execute_reply": "2024-10-13T10:05:29.087581Z"
    },
    "papermill": {
     "duration": 20903.329669,
     "end_time": "2024-10-13T10:05:29.091694",
     "exception": false,
     "start_time": "2024-10-13T04:17:05.762025",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\u001b[34m\u001b[1mwandb\u001b[0m: Currently logged in as: \u001b[33mpietro-caforio\u001b[0m (\u001b[33mpietro-caforio-politecnico-di-milano\u001b[0m). Use \u001b[1m`wandb login --relogin`\u001b[0m to force relogin\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: Tracking run with wandb version 0.18.3\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: Run data is saved locally in \u001b[35m\u001b[1m/kaggle/working/wandb/run-20241013_041705-xtve4n8z\u001b[0m\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: Run \u001b[1m`wandb offline`\u001b[0m to turn off syncing.\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: Syncing run \u001b[33mResNet3D original best Focalloss\u001b[0m\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: ‚≠êÔ∏è View project at \u001b[34m\u001b[4mhttps://wandb.ai/pietro-caforio-politecnico-di-milano/3Dunimodal_ct_training\u001b[0m\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: üöÄ View run at \u001b[34m\u001b[4mhttps://wandb.ai/pietro-caforio-politecnico-di-milano/3Dunimodal_ct_training/runs/xtve4n8z\u001b[0m\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Epoch 1, Loss: 0.7398165347320693\n",
      "Validation Loss: 0.6599374314149221, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 2, Loss: 0.7475010092769351\n",
      "Validation Loss: 0.6285775999228159, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 3, Loss: 0.74124918452331\n",
      "Validation Loss: 0.632711198594835, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 4, Loss: 0.7303616340671267\n",
      "Validation Loss: 0.6339676943090227, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 5, Loss: 0.7340331716196877\n",
      "Validation Loss: 0.6320992012818655, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 6, Loss: 0.7181130849889347\n",
      "Validation Loss: 0.6316675825251473, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 7, Loss: 0.7159021986382348\n",
      "Validation Loss: 0.6263571547137367, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 8, Loss: 0.7166996992060116\n",
      "Validation Loss: 0.6305106216006808, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 9, Loss: 0.7113154732755252\n",
      "Validation Loss: 0.6248312360710568, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 10, Loss: 0.7137555895107133\n",
      "Validation Loss: 0.6255910131666396, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 11, Loss: 0.7025543195860726\n",
      "Validation Loss: 0.6238633096218109, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 12, Loss: 0.7079140160764966\n",
      "Validation Loss: 0.6150862375895182, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 13, Loss: 0.7024836455072675\n",
      "Validation Loss: 0.6308674563964208, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 14, Loss: 0.692955633359296\n",
      "Validation Loss: 0.6163748105367025, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 15, Loss: 0.6874475979379245\n",
      "Validation Loss: 0.6203946570555369, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 16, Loss: 0.6950953815664563\n",
      "Validation Loss: 0.6154585480690002, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 17, Loss: 0.6827167187418256\n",
      "Validation Loss: 0.612442746758461, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 18, Loss: 0.6888876706361771\n",
      "Validation Loss: 0.6069533709022734, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 19, Loss: 0.6846801904695374\n",
      "Validation Loss: 0.6091560042566724, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 20, Loss: 0.6761041592274394\n",
      "Validation Loss: 0.6141583853297763, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 21, Loss: 0.6719642441187587\n",
      "Validation Loss: 0.6091491331656774, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 22, Loss: 0.6783008756382125\n",
      "Validation Loss: 0.6175814966360728, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 23, Loss: 0.6671220005622932\n",
      "Validation Loss: 0.6185293081733916, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 24, Loss: 0.6608219934361321\n",
      "Validation Loss: 0.6130337880717384, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 25, Loss: 0.6601889303752354\n",
      "Validation Loss: 0.5977538691626655, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 26, Loss: 0.6611513580594744\n",
      "Validation Loss: 0.5977612502045102, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 27, Loss: 0.6640597241265433\n",
      "Validation Loss: 0.6111159142520692, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 28, Loss: 0.6498831404106957\n",
      "Validation Loss: 0.6035202807850308, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 29, Loss: 0.6539451000945908\n",
      "Validation Loss: 0.6083708984984292, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 30, Loss: 0.6557377225586346\n",
      "Validation Loss: 0.6083838310506609, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 31, Loss: 0.6394104287028313\n",
      "Validation Loss: 0.6004495239920087, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 32, Loss: 0.6335435477750642\n",
      "Validation Loss: 0.6042241354783376, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 33, Loss: 0.6478035811867032\n",
      "Validation Loss: 0.6010707848601871, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 34, Loss: 0.657798989542893\n",
      "Validation Loss: 0.6055757701396942, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 35, Loss: 0.6296984180808067\n",
      "Validation Loss: 0.6033415247996649, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 36, Loss: 0.6305415683559009\n",
      "Validation Loss: 0.6060644288857778, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 37, Loss: 0.623199928019728\n",
      "Validation Loss: 0.5952781273259057, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 38, Loss: 0.6215295961924961\n",
      "Validation Loss: 0.6041256189346313, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 39, Loss: 0.6142410125051226\n",
      "Validation Loss: 0.6060006999307208, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 40, Loss: 0.6245482691696712\n",
      "Validation Loss: 0.614604694975747, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 41, Loss: 0.6019962759954589\n",
      "Validation Loss: 0.5996865580479304, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 42, Loss: 0.605141607778413\n",
      "Validation Loss: 0.5960789869228998, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 43, Loss: 0.6083516670124871\n",
      "Validation Loss: 0.5993427932262421, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 44, Loss: 0.6094448108758245\n",
      "Validation Loss: 0.5981118281682333, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 45, Loss: 0.6178871488996914\n",
      "Validation Loss: 0.587846201327112, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 46, Loss: 0.6053321191242763\n",
      "Validation Loss: 0.587640192773607, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 47, Loss: 0.5930698290467262\n",
      "Validation Loss: 0.5876144236988492, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 48, Loss: 0.5874138485108104\n",
      "Validation Loss: 0.5901443991396162, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 49, Loss: 0.5981108152440616\n",
      "Validation Loss: 0.5746214323573642, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 50, Loss: 0.5943114895905767\n",
      "Validation Loss: 0.5735602792766359, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 51, Loss: 0.5930899573223931\n",
      "Validation Loss: 0.6002176337771945, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 52, Loss: 0.590209994997297\n",
      "Validation Loss: 0.6066654456986321, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 53, Loss: 0.594554962856429\n",
      "Validation Loss: 0.5895146396425035, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 54, Loss: 0.5812190792390278\n",
      "Validation Loss: 0.5917958302630318, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 55, Loss: 0.5842712542840413\n",
      "Validation Loss: 0.5942093580961227, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 56, Loss: 0.589795650116035\n",
      "Validation Loss: 0.5892369482252333, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 57, Loss: 0.574887250150953\n",
      "Validation Loss: 0.5785640047656165, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 58, Loss: 0.5702870339155197\n",
      "Validation Loss: 0.5870309803220961, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 59, Loss: 0.5819593774420875\n",
      "Validation Loss: 0.5786650660965178, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 60, Loss: 0.571041868201324\n",
      "Validation Loss: 0.5785084201229943, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 61, Loss: 0.5809043262686048\n",
      "Validation Loss: 0.5923127813471688, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 62, Loss: 0.5700987023966653\n",
      "Validation Loss: 0.589528093735377, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 63, Loss: 0.5744942884360041\n",
      "Validation Loss: 0.5974104040198855, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 64, Loss: 0.5607144949691636\n",
      "Validation Loss: 0.5901969439453549, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 65, Loss: 0.5615688370806831\n",
      "Validation Loss: 0.5973099768161774, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 66, Loss: 0.555264624101775\n",
      "Validation Loss: 0.5778388347890642, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 67, Loss: 0.5567700660654477\n",
      "Validation Loss: 0.5804637124141058, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 68, Loss: 0.5630207029836518\n",
      "Validation Loss: 0.5955419027143054, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 69, Loss: 0.5602404049464634\n",
      "Validation Loss: 0.595513148440255, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 70, Loss: 0.5501546849097524\n",
      "Validation Loss: 0.5933963457743326, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 71, Loss: 0.5473629470382418\n",
      "Validation Loss: 0.5839883519543542, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 72, Loss: 0.5360868509326663\n",
      "Validation Loss: 0.5812949422332976, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 73, Loss: 0.5635472536087036\n",
      "Validation Loss: 0.5991870396667056, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 74, Loss: 0.5468190397535052\n",
      "Validation Loss: 0.5647599962022569, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 75, Loss: 0.5413977312190192\n",
      "Validation Loss: 0.5882833467589484, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 76, Loss: 0.5528138535363334\n",
      "Validation Loss: 0.5980653448237313, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 77, Loss: 0.5457975310938699\n",
      "Validation Loss: 0.5785162846247355, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 78, Loss: 0.5400449324931417\n",
      "Validation Loss: 0.5805938575002882, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 79, Loss: 0.5365336920533862\n",
      "Validation Loss: 0.5831690662437015, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 80, Loss: 0.5337535845381873\n",
      "Validation Loss: 0.58551158507665, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 81, Loss: 0.5322466247848102\n",
      "Validation Loss: 0.5991659561793009, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 82, Loss: 0.5121298347200666\n",
      "Validation Loss: 0.5640442487266328, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 83, Loss: 0.520061483340604\n",
      "Validation Loss: 0.5713120152552923, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 100.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 84, Loss: 0.524361618927547\n",
      "Validation Loss: 0.5891563793023428, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 85, Loss: 0.5158580094575882\n",
      "Validation Loss: 0.5728485269678963, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 86, Loss: 0.5268277525901794\n",
      "Validation Loss: 0.5850370973348618, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 87, Loss: 0.5063201870237078\n",
      "Validation Loss: 0.5780898100799985, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 88, Loss: 0.5179481101887566\n",
      "Validation Loss: 0.5879186424944136, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 100.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 89, Loss: 0.5522754575525012\n",
      "Validation Loss: 0.5905811256832547, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 90, Loss: 0.5015024957912309\n",
      "Validation Loss: 0.567892892493142, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 100.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 91, Loss: 0.5161857934934753\n",
      "Validation Loss: 0.5658155414793227, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 92, Loss: 0.5253641775676182\n",
      "Validation Loss: 0.5737030953168869, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 93, Loss: 0.5194621756672859\n",
      "Validation Loss: 0.55970109336906, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 100.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 94, Loss: 0.5240805521607399\n",
      "Validation Loss: 0.5912341806623671, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 95, Loss: 0.5041152462363243\n",
      "Validation Loss: 0.5923202236493429, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 96, Loss: 0.5094086102076939\n",
      "Validation Loss: 0.5849265042278502, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 100.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 97, Loss: 0.47910341726882116\n",
      "Validation Loss: 0.5720045732127296, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 100.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 98, Loss: 0.48348222247191835\n",
      "Validation Loss: 0.5905470632844501, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 100.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 99, Loss: 0.4883150117737906\n",
      "Validation Loss: 0.5799282474650277, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 100.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 100, Loss: 0.5021235729966845\n",
      "Validation Loss: 0.5594327615367042, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 100.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 101, Loss: 0.4855673057692392\n",
      "Validation Loss: 0.5555727332830429, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 100.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 102, Loss: 0.487901787672724\n",
      "Validation Loss: 0.5827496515380012, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 100.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 103, Loss: 0.47571380010672976\n",
      "Validation Loss: 0.5638831125365363, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 100.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 104, Loss: 0.49548541541610447\n",
      "Validation Loss: 0.5592377980550131, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 100.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 105, Loss: 0.48938521104199545\n",
      "Validation Loss: 0.5571467015478346, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 100.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 106, Loss: 0.48961636956248966\n",
      "Validation Loss: 0.564546697669559, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 100.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 107, Loss: 0.4909046771270888\n",
      "Validation Loss: 0.5764676928520203, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 100.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 108, Loss: 0.4928877034357616\n",
      "Validation Loss: 0.5732889605893029, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 100.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 109, Loss: 0.4768556329820837\n",
      "Validation Loss: 0.5582834680875143, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 100.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 110, Loss: 0.4713682143815926\n",
      "Validation Loss: 0.568141864405738, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 100.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 111, Loss: 0.490714855492115\n",
      "Validation Loss: 0.5823451214366488, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 100.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 112, Loss: 0.47521146706172396\n",
      "Validation Loss: 0.5845549487405353, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 100.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 113, Loss: 0.4666259741144521\n",
      "Validation Loss: 0.5697167482641008, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 100.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 114, Loss: 0.4712896772793361\n",
      "Validation Loss: 0.5948452055454254, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 100.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 115, Loss: 0.46996746797646793\n",
      "Validation Loss: 0.5443850093417697, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 100.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 116, Loss: 0.4510147693966116\n",
      "Validation Loss: 0.5406006922324499, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 100.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 117, Loss: 0.46097294454063686\n",
      "Validation Loss: 0.5617533458603753, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 100.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 118, Loss: 0.46773154927151545\n",
      "Validation Loss: 0.5631327496634589, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 100.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 119, Loss: 0.452482354428087\n",
      "Validation Loss: 0.5656057132614983, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 100.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 120, Loss: 0.45190068760088514\n",
      "Validation Loss: 0.5699376795026991, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 100.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 121, Loss: 0.4682327519570078\n",
      "Validation Loss: 0.5634944637616476, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 100.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 122, Loss: 0.4521409794688225\n",
      "Validation Loss: 0.5467802203363843, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 100.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 123, Loss: 0.46436612946646555\n",
      "Validation Loss: 0.564493285285102, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 100.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 124, Loss: 0.44395820796489716\n",
      "Validation Loss: 0.5557987888654073, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 100.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 125, Loss: 0.45430848534618107\n",
      "Validation Loss: 0.5657066090239419, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 100.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 126, Loss: 0.4500902859227998\n",
      "Validation Loss: 0.5536113596624799, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 100.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 127, Loss: 0.4408442335469382\n",
      "Validation Loss: 0.5609910239775976, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 100.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 128, Loss: 0.4497517357979502\n",
      "Validation Loss: 0.5662344015306897, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 100.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 129, Loss: 0.45569242696676937\n",
      "Validation Loss: 0.5543465746773614, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 100.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 130, Loss: 0.4557683989405632\n",
      "Validation Loss: 0.5778545422686471, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 100.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 131, Loss: 0.446670012814658\n",
      "Validation Loss: 0.5463722050189972, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 100.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 132, Loss: 0.42280825121062143\n",
      "Validation Loss: 0.5404126081201766, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 100.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 133, Loss: 0.4238045997917652\n",
      "Validation Loss: 0.5581880758206049, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 100.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 134, Loss: 0.4182559661567211\n",
      "Validation Loss: 0.5585579408539666, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 135, Loss: 0.4383978710642883\n",
      "Validation Loss: 0.5831276906861199, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 100.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 136, Loss: 0.44042033169950756\n",
      "Validation Loss: 0.5695267154110802, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 100.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 137, Loss: 0.44585649775607245\n",
      "Validation Loss: 0.5739157232973311, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 100.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 138, Loss: 0.4616402355687959\n",
      "Validation Loss: 0.5463270644346873, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 100.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 139, Loss: 0.4446472259504454\n",
      "Validation Loss: 0.5467154781023661, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 100.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 140, Loss: 0.43242292957646505\n",
      "Validation Loss: 0.5676820327838262, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 100.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 141, Loss: 0.4352948782699449\n",
      "Validation Loss: 0.5322756469249725, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 100.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 142, Loss: 0.42027550882526804\n",
      "Validation Loss: 0.5363316800859239, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 100.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 143, Loss: 0.41978527179786135\n",
      "Validation Loss: 0.5640169249640571, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 100.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 144, Loss: 0.4176459312438965\n",
      "Validation Loss: 0.5513414343198141, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 145, Loss: 0.4239624898348536\n",
      "Validation Loss: 0.5555139117770724, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 100.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 146, Loss: 0.4234216553824289\n",
      "Validation Loss: 0.5499977651569579, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 147, Loss: 0.42183293934379307\n",
      "Validation Loss: 0.5494555963410271, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 148, Loss: 0.42974349217755453\n",
      "Validation Loss: 0.5760997666252984, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 149, Loss: 0.41726269998720716\n",
      "Validation Loss: 0.553627481063207, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 100.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 150, Loss: 0.4324054499822004\n",
      "Validation Loss: 0.553362273507648, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 100.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 151, Loss: 0.3998264138187681\n",
      "Validation Loss: 0.5346492015653186, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 152, Loss: 0.4122742052589144\n",
      "Validation Loss: 0.5469898283481598, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 153, Loss: 0.3882857082145555\n",
      "Validation Loss: 0.5671003841691546, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 100.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 154, Loss: 0.43259716566119877\n",
      "Validation Loss: 0.5433814426263174, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 155, Loss: 0.4157225468329021\n",
      "Validation Loss: 0.5463257746564018, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 156, Loss: 0.42389638615506037\n",
      "Validation Loss: 0.5321466988987393, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 157, Loss: 0.38572357275656294\n",
      "Validation Loss: 0.5544506510098776, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 158, Loss: 0.4292627977473395\n",
      "Validation Loss: 0.5388822621769376, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 159, Loss: 0.4111998427127089\n",
      "Validation Loss: 0.564965792828136, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 160, Loss: 0.40091984240072115\n",
      "Validation Loss: 0.5657826397154067, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 75.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 161, Loss: 0.4142845517822674\n",
      "Validation Loss: 0.5314641959137387, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 162, Loss: 0.36481914509619984\n",
      "Validation Loss: 0.5346267968416214, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 163, Loss: 0.41676330992153715\n",
      "Validation Loss: 0.5183748106161753, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 16.67%\n",
      "Epoch 164, Loss: 0.39201752628598896\n",
      "Validation Loss: 0.5187386903497908, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 16.67%\n",
      "Epoch 165, Loss: 0.4011779305125986\n",
      "Validation Loss: 0.554312547047933, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 166, Loss: 0.41772873273917605\n",
      "Validation Loss: 0.5550429158740573, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 167, Loss: 0.3897359387150833\n",
      "Validation Loss: 0.5739583737320371, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 168, Loss: 0.3915113466126578\n",
      "Validation Loss: 0.5563150015142229, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 169, Loss: 0.38121975266507696\n",
      "Validation Loss: 0.5535790986484952, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 100.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 170, Loss: 0.39833758771419525\n",
      "Validation Loss: 0.5462935268878937, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 171, Loss: 0.38809242631707874\n",
      "Validation Loss: 0.5610408286253611, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 172, Loss: 0.3912885987332889\n",
      "Validation Loss: 0.544093507859442, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 173, Loss: 0.4050543984132154\n",
      "Validation Loss: 0.5308675881889131, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 16.67%\n",
      "Epoch 174, Loss: 0.3850697672792843\n",
      "Validation Loss: 0.5692429410086738, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 175, Loss: 0.3750034070440701\n",
      "Validation Loss: 0.5490501870711645, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 176, Loss: 0.353838997227805\n",
      "Validation Loss: 0.5299226740996043, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 177, Loss: 0.372504680284432\n",
      "Validation Loss: 0.5432231194443173, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 100.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 178, Loss: 0.36955101415514946\n",
      "Validation Loss: 0.5495119558440315, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 179, Loss: 0.364622564720256\n",
      "Validation Loss: 0.5374767945872413, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 180, Loss: 0.3952963293663093\n",
      "Validation Loss: 0.5643121318684684, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 181, Loss: 0.3774971685239247\n",
      "Validation Loss: 0.5416693290074667, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 182, Loss: 0.35414455085992813\n",
      "Validation Loss: 0.5178093463182449, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 16.67%\n",
      "Epoch 183, Loss: 0.35745725514633314\n",
      "Validation Loss: 0.5383121503723992, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 184, Loss: 0.4020217965756144\n",
      "Validation Loss: 0.5464033550686307, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 185, Loss: 0.3670997598341533\n",
      "Validation Loss: 0.5346570362647375, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 186, Loss: 0.3526040959571089\n",
      "Validation Loss: 0.5522247933679156, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 187, Loss: 0.36215509314622196\n",
      "Validation Loss: 0.552978002362781, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 188, Loss: 0.376458436782871\n",
      "Validation Loss: 0.5655048622025384, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 189, Loss: 0.3465246983936855\n",
      "Validation Loss: 0.5318823440207375, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 190, Loss: 0.36130255460739136\n",
      "Validation Loss: 0.5499841670195261, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 191, Loss: 0.36634942782776697\n",
      "Validation Loss: 0.5442797773414187, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 192, Loss: 0.34396261775067877\n",
      "Validation Loss: 0.5391332805156708, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 193, Loss: 0.3682939330382006\n",
      "Validation Loss: 0.5621458954281278, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 194, Loss: 0.3565833957067558\n",
      "Validation Loss: 0.5402962333626218, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 195, Loss: 0.35405551908271654\n",
      "Validation Loss: 0.5380455984009637, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 196, Loss: 0.3744230344891548\n",
      "Validation Loss: 0.5214620431264242, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 197, Loss: 0.34004573257906096\n",
      "Validation Loss: 0.5317498942216238, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 198, Loss: 0.3477854984147208\n",
      "Validation Loss: 0.5461942586633894, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 199, Loss: 0.36254370159336496\n",
      "Validation Loss: 0.519117135140631, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 16.67%\n",
      "Epoch 200, Loss: 0.3667558250682695\n",
      "Validation Loss: 0.5470585591263242, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 201, Loss: 0.32464276999235153\n",
      "Validation Loss: 0.5322758158047994, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 202, Loss: 0.3463823598410402\n",
      "Validation Loss: 0.5752974185678694, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 203, Loss: 0.32983185031584333\n",
      "Validation Loss: 0.5191649612453249, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 50.00%, G2: 50.00%, G3: 16.67%\n",
      "Epoch 204, Loss: 0.35215037741831373\n",
      "Validation Loss: 0.5319274995062087, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 205, Loss: 0.3324356621929577\n",
      "Validation Loss: 0.5424125476015939, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 206, Loss: 0.3196289438222136\n",
      "Validation Loss: 0.5535839233133528, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 207, Loss: 0.3478549639029162\n",
      "Validation Loss: 0.545029976301723, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 208, Loss: 0.3214495267186846\n",
      "Validation Loss: 0.552411879102389, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 209, Loss: 0.3436504527926445\n",
      "Validation Loss: 0.5539086494180891, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 210, Loss: 0.34818495490721296\n",
      "Validation Loss: 0.5320974306927787, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 75.00%, G2: 62.50%, G3: 0.00%\n",
      "Epoch 211, Loss: 0.3514863901904651\n",
      "Validation Loss: 0.5294888185130225, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 212, Loss: 0.3279010696070535\n",
      "Validation Loss: 0.5453233371178309, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 213, Loss: 0.32125663863761084\n",
      "Validation Loss: 0.519505457745658, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 75.00%, G2: 62.50%, G3: 16.67%\n",
      "Epoch 214, Loss: 0.3411574869283608\n",
      "Validation Loss: 0.5092311153809229, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 16.67%\n",
      "Epoch 215, Loss: 0.3483182473906449\n",
      "Validation Loss: 0.5200068801641464, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 16.67%\n",
      "Epoch 216, Loss: 0.33587347875748363\n",
      "Validation Loss: 0.5395591474241681, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 50.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 217, Loss: 0.3213671972709043\n",
      "Validation Loss: 0.5193785429000854, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 50.00%, G2: 50.00%, G3: 16.67%\n",
      "Epoch 218, Loss: 0.32270077243447304\n",
      "Validation Loss: 0.5457470383909013, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 219, Loss: 0.30957681259938646\n",
      "Validation Loss: 0.5415148105886247, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 220, Loss: 0.3347407063203199\n",
      "Validation Loss: 0.5509014659457736, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 75.00%, G2: 62.50%, G3: 0.00%\n",
      "Epoch 221, Loss: 0.30992407564605984\n",
      "Validation Loss: 0.5321319235695733, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 50.00%, G2: 75.00%, G3: 0.00%\n",
      "Epoch 222, Loss: 0.32294350011008127\n",
      "Validation Loss: 0.5433534615569644, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 75.00%, G2: 62.50%, G3: 0.00%\n",
      "Epoch 223, Loss: 0.33738814507211956\n",
      "Validation Loss: 0.5413264748122957, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 50.00%, G2: 62.50%, G3: 0.00%\n",
      "Epoch 224, Loss: 0.31899580572332653\n",
      "Validation Loss: 0.5411400430732303, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 75.00%, G2: 62.50%, G3: 0.00%\n",
      "Epoch 225, Loss: 0.3352561497262546\n",
      "Validation Loss: 0.5372887750466665, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 50.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 226, Loss: 0.3128232013966356\n",
      "Validation Loss: 0.5269598282045789, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 25.00%, G2: 62.50%, G3: 0.00%\n",
      "Epoch 227, Loss: 0.31539599544235636\n",
      "Validation Loss: 0.5477621422873603, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 228, Loss: 0.33776447230151724\n",
      "Validation Loss: 0.5290684302647909, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 50.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 229, Loss: 0.3037056401371956\n",
      "Validation Loss: 0.5425800763898425, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 50.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 230, Loss: 0.35497609792011126\n",
      "Validation Loss: 0.5519957260953056, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 50.00%, G2: 62.50%, G3: 0.00%\n",
      "Epoch 231, Loss: 0.3340139782854489\n",
      "Validation Loss: 0.5420713325341543, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 75.00%, G2: 50.00%, G3: 16.67%\n",
      "Epoch 232, Loss: 0.3287856456424509\n",
      "Validation Loss: 0.5259686840905083, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 50.00%, G2: 62.50%, G3: 16.67%\n",
      "Epoch 233, Loss: 0.31878264248371124\n",
      "Validation Loss: 0.5294374393092262, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 25.00%, G2: 75.00%, G3: 0.00%\n",
      "Epoch 234, Loss: 0.28721027076244354\n",
      "Validation Loss: 0.518898093038135, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 25.00%, G2: 62.50%, G3: 0.00%\n",
      "Epoch 235, Loss: 0.30235619310821804\n",
      "Validation Loss: 0.5271928111712137, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 50.00%, G2: 62.50%, G3: 0.00%\n",
      "Epoch 236, Loss: 0.3170857881861074\n",
      "Validation Loss: 0.5064243839846717, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 50.00%, G2: 62.50%, G3: 33.33%\n",
      "Epoch 237, Loss: 0.30850987136363983\n",
      "Validation Loss: 0.5296232021517224, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 25.00%, G2: 62.50%, G3: 33.33%\n",
      "Epoch 238, Loss: 0.3068384352539267\n",
      "Validation Loss: 0.53774294257164, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 50.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 239, Loss: 0.29955682876919\n",
      "Validation Loss: 0.5203526582982805, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 25.00%, G2: 62.50%, G3: 16.67%\n",
      "Epoch 240, Loss: 0.2938462980091572\n",
      "Validation Loss: 0.5251260879966948, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 50.00%, G2: 50.00%, G3: 33.33%\n",
      "Epoch 241, Loss: 0.3163242739226137\n",
      "Validation Loss: 0.5133278965950012, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 50.00%, G2: 62.50%, G3: 33.33%\n",
      "Epoch 242, Loss: 0.2992888939167772\n",
      "Validation Loss: 0.5243836541970571, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 25.00%, G2: 62.50%, G3: 16.67%\n",
      "Epoch 243, Loss: 0.306481732321637\n",
      "Validation Loss: 0.5222402628925111, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 25.00%, G2: 75.00%, G3: 16.67%\n",
      "Epoch 244, Loss: 0.291902631521225\n",
      "Validation Loss: 0.5375666519006094, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 0.00%\n",
      "Epoch 245, Loss: 0.3111790434590408\n",
      "Validation Loss: 0.5423146618737115, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 25.00%, G2: 62.50%, G3: 16.67%\n",
      "Epoch 246, Loss: 0.30753193316715105\n",
      "Validation Loss: 0.5278064029084312, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 25.00%, G2: 62.50%, G3: 16.67%\n",
      "Epoch 247, Loss: 0.3149268797465733\n",
      "Validation Loss: 0.5445778369903564, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 25.00%, G2: 62.50%, G3: 16.67%\n",
      "Epoch 248, Loss: 0.2791562271969659\n",
      "Validation Loss: 0.5156161205636131, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 16.67%\n",
      "Epoch 249, Loss: 0.29393320583871435\n",
      "Validation Loss: 0.551396346754498, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 25.00%, G2: 62.50%, G3: 0.00%\n",
      "Epoch 250, Loss: 0.28198835413370815\n",
      "Validation Loss: 0.535814118054178, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 25.00%, G2: 62.50%, G3: 16.67%\n",
      "Epoch 251, Loss: 0.2825579765651907\n",
      "Validation Loss: 0.52288475798236, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 16.67%\n",
      "Epoch 252, Loss: 0.2924164996615478\n",
      "Validation Loss: 0.523939466310872, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 25.00%, G2: 75.00%, G3: 16.67%\n",
      "Epoch 253, Loss: 0.29068347439169884\n",
      "Validation Loss: 0.5340508934524324, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 25.00%, G2: 62.50%, G3: 16.67%\n",
      "Epoch 254, Loss: 0.29207225143909454\n",
      "Validation Loss: 0.5118093341588974, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 25.00%, G2: 75.00%, G3: 33.33%\n",
      "Epoch 255, Loss: 0.24779165270073072\n",
      "Validation Loss: 0.5329836010932922, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 16.67%\n",
      "Epoch 256, Loss: 0.2952142001262733\n",
      "Validation Loss: 0.5144463280836741, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 33.33%\n",
      "Epoch 257, Loss: 0.29552855236189707\n",
      "Validation Loss: 0.5422515976760123, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 16.67%\n",
      "Epoch 258, Loss: 0.2866764898811068\n",
      "Validation Loss: 0.5596152577135298, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 16.67%\n",
      "Epoch 259, Loss: 0.3267659236277853\n",
      "Validation Loss: 0.5579491688145531, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 25.00%, G2: 62.50%, G3: 16.67%\n",
      "Epoch 260, Loss: 0.29537091084889006\n",
      "Validation Loss: 0.5416930731799867, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 16.67%\n",
      "Epoch 261, Loss: 0.2909495428736721\n",
      "Validation Loss: 0.5144734978675842, Total Accuracy: 55.56%\n",
      "Accuracy per class - G1: 25.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 262, Loss: 0.27802416895117077\n",
      "Validation Loss: 0.5188971873786714, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 33.33%\n",
      "Epoch 263, Loss: 0.2582261030163084\n",
      "Validation Loss: 0.5042725834581587, Total Accuracy: 55.56%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 66.67%\n",
      "Epoch 264, Loss: 0.2836149845804487\n",
      "Validation Loss: 0.5162250159515275, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 265, Loss: 0.27307763269969393\n",
      "Validation Loss: 0.5431650727987289, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 25.00%, G2: 62.50%, G3: 33.33%\n",
      "Epoch 266, Loss: 0.2962373649435384\n",
      "Validation Loss: 0.5349064204427931, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 33.33%\n",
      "Epoch 267, Loss: 0.27415467080261025\n",
      "Validation Loss: 0.5483359512355592, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 16.67%\n",
      "Epoch 268, Loss: 0.3031005300581455\n",
      "Validation Loss: 0.5453649312257767, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 33.33%\n",
      "Epoch 269, Loss: 0.2966220778013979\n",
      "Validation Loss: 0.5478804210821787, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 16.67%\n",
      "Epoch 270, Loss: 0.25862071343830656\n",
      "Validation Loss: 0.5354512698120542, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 33.33%\n",
      "Epoch 271, Loss: 0.26106242196900503\n",
      "Validation Loss: 0.5306506372160382, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 272, Loss: 0.2724590487778187\n",
      "Validation Loss: 0.5238493200805452, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 273, Loss: 0.2710375961448465\n",
      "Validation Loss: 0.5254408733712302, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 274, Loss: 0.2541661486029625\n",
      "Validation Loss: 0.509007591340277, Total Accuracy: 61.11%\n",
      "Accuracy per class - G1: 25.00%, G2: 75.00%, G3: 66.67%\n",
      "Epoch 275, Loss: 0.31903510806815966\n",
      "Validation Loss: 0.5172003648347325, Total Accuracy: 55.56%\n",
      "Accuracy per class - G1: 25.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 276, Loss: 0.24029473694307463\n",
      "Validation Loss: 0.5234073532952203, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 277, Loss: 0.23319862729736737\n",
      "Validation Loss: 0.5191033093465699, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 278, Loss: 0.26577854422586306\n",
      "Validation Loss: 0.5264306830035316, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 279, Loss: 0.2897944711148739\n",
      "Validation Loss: 0.5059909439749188, Total Accuracy: 55.56%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 66.67%\n",
      "Epoch 280, Loss: 0.26763200759887695\n",
      "Validation Loss: 0.547016427748733, Total Accuracy: 55.56%\n",
      "Accuracy per class - G1: 25.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 281, Loss: 0.27502122787492617\n",
      "Validation Loss: 0.5507243259085549, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 33.33%\n",
      "Epoch 282, Loss: 0.25116512711559025\n",
      "Validation Loss: 0.5155996042821143, Total Accuracy: 55.56%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 66.67%\n",
      "Epoch 283, Loss: 0.2341841927596501\n",
      "Validation Loss: 0.5358347511953778, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 284, Loss: 0.2676945190344538\n",
      "Validation Loss: 0.5041509229275916, Total Accuracy: 55.56%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 66.67%\n",
      "Epoch 285, Loss: 0.25013047004384653\n",
      "Validation Loss: 0.5384743130869336, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 286, Loss: 0.262640760413238\n",
      "Validation Loss: 0.5321116613017188, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 33.33%\n",
      "Epoch 287, Loss: 0.2582123098628862\n",
      "Validation Loss: 0.5435864809486601, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 33.33%\n",
      "Epoch 288, Loss: 0.2604119407811335\n",
      "Validation Loss: 0.5183201216989093, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 289, Loss: 0.24363900667854718\n",
      "Validation Loss: 0.5263291622201601, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 290, Loss: 0.23565584048628807\n",
      "Validation Loss: 0.5119862862759166, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 291, Loss: 0.23069587482937745\n",
      "Validation Loss: 0.5175105929374695, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 292, Loss: 0.27142074544514927\n",
      "Validation Loss: 0.5406892548004786, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 293, Loss: 0.2557764542954309\n",
      "Validation Loss: 0.5522918121682273, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 294, Loss: 0.2838564249021666\n",
      "Validation Loss: 0.5403053561846415, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 295, Loss: 0.25360722999487606\n",
      "Validation Loss: 0.5358062783877054, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 296, Loss: 0.2450220627444131\n",
      "Validation Loss: 0.554868054886659, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 297, Loss: 0.26942186882453306\n",
      "Validation Loss: 0.5351656725009283, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 298, Loss: 0.23223954705255373\n",
      "Validation Loss: 0.5510613454712762, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 299, Loss: 0.2552652529307774\n",
      "Validation Loss: 0.5510386750102043, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 300, Loss: 0.2381736444575446\n",
      "Validation Loss: 0.538116460873021, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 301, Loss: 0.24921972650502408\n",
      "Validation Loss: 0.5006978420747651, Total Accuracy: 55.56%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 66.67%\n",
      "Epoch 302, Loss: 0.2595424029443945\n",
      "Validation Loss: 0.5258298615614573, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 303, Loss: 0.2560076822659799\n",
      "Validation Loss: 0.5431956930292977, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 304, Loss: 0.2773552419883864\n",
      "Validation Loss: 0.5450019265214602, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 305, Loss: 0.24110118406159536\n",
      "Validation Loss: 0.5138125047087669, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 306, Loss: 0.254870147843446\n",
      "Validation Loss: 0.5245279909835922, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 307, Loss: 0.2389475940061467\n",
      "Validation Loss: 0.5156595483422279, Total Accuracy: 55.56%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 66.67%\n",
      "Epoch 308, Loss: 0.22802612797490188\n",
      "Validation Loss: 0.5585498362779617, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 309, Loss: 0.21290036317493236\n",
      "Validation Loss: 0.5252579732073678, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 310, Loss: 0.2617055294769151\n",
      "Validation Loss: 0.5500686897171868, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 311, Loss: 0.23030385481459753\n",
      "Validation Loss: 0.5372054908010695, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 312, Loss: 0.23063613447759831\n",
      "Validation Loss: 0.5442224327060912, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 313, Loss: 0.2571907243026154\n",
      "Validation Loss: 0.535594168636534, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 314, Loss: 0.2707131438489471\n",
      "Validation Loss: 0.537974537246757, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 315, Loss: 0.22816333680280618\n",
      "Validation Loss: 0.5233569054139985, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 316, Loss: 0.24074581717806204\n",
      "Validation Loss: 0.5438878784577051, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 317, Loss: 0.23403127704347884\n",
      "Validation Loss: 0.5095603383249707, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 318, Loss: 0.23536282112555845\n",
      "Validation Loss: 0.5357252657413483, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 319, Loss: 0.2376196144946984\n",
      "Validation Loss: 0.5317392241623666, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 320, Loss: 0.2326484112335103\n",
      "Validation Loss: 0.5249251516328918, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 321, Loss: 0.2231447874967541\n",
      "Validation Loss: 0.5530968846546279, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 322, Loss: 0.26274346294147627\n",
      "Validation Loss: 0.5348081886768341, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 323, Loss: 0.24233235259141242\n",
      "Validation Loss: 0.5211622052722507, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 324, Loss: 0.2561127849455391\n",
      "Validation Loss: 0.5198657462994257, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 325, Loss: 0.2226985426885741\n",
      "Validation Loss: 0.5159813736875852, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 326, Loss: 0.2503259325666087\n",
      "Validation Loss: 0.5325684630208545, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 327, Loss: 0.23791021321501052\n",
      "Validation Loss: 0.5174508028560214, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 328, Loss: 0.2166326181696994\n",
      "Validation Loss: 0.5346328334675895, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 329, Loss: 0.21352857377912318\n",
      "Validation Loss: 0.5220678407284949, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 330, Loss: 0.22746998124888965\n",
      "Validation Loss: 0.529763277206156, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 331, Loss: 0.23017225787043571\n",
      "Validation Loss: 0.5091580135954751, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 332, Loss: 0.19601290194051607\n",
      "Validation Loss: 0.5365491029289033, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 333, Loss: 0.22330973989197186\n",
      "Validation Loss: 0.5326828666859202, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 334, Loss: 0.22965632272618158\n",
      "Validation Loss: 0.5390142467286851, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 335, Loss: 0.2415274301809924\n",
      "Validation Loss: 0.5101908619205157, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 336, Loss: 0.2122535596468619\n",
      "Validation Loss: 0.5254027644793192, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 337, Loss: 0.19006034785083362\n",
      "Validation Loss: 0.5034737661480904, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 338, Loss: 0.21499774445380485\n",
      "Validation Loss: 0.5138258106178708, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 339, Loss: 0.2049307817859309\n",
      "Validation Loss: 0.5259860323535072, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 340, Loss: 0.2229908686131239\n",
      "Validation Loss: 0.5503163147303793, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 341, Loss: 0.21453250891395978\n",
      "Validation Loss: 0.5330808212359747, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 342, Loss: 0.21893906939242566\n",
      "Validation Loss: 0.5184110949436823, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 343, Loss: 0.2543643247336149\n",
      "Validation Loss: 0.540105875995424, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 344, Loss: 0.21225698398692266\n",
      "Validation Loss: 0.5290493907199966, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 345, Loss: 0.22282713625047887\n",
      "Validation Loss: 0.5462288997239537, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 346, Loss: 0.2442350121481078\n",
      "Validation Loss: 0.5586690828204155, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 347, Loss: 0.19888645011399472\n",
      "Validation Loss: 0.551668342616823, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 348, Loss: 0.19042822186435973\n",
      "Validation Loss: 0.5509208225541644, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 349, Loss: 0.2016646433621645\n",
      "Validation Loss: 0.5477852001786232, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 350, Loss: 0.21615457029214927\n",
      "Validation Loss: 0.5393240025473965, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 351, Loss: 0.21731142034488066\n",
      "Validation Loss: 0.5270669394069247, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 352, Loss: 0.2037960003529276\n",
      "Validation Loss: 0.5345607010854615, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 353, Loss: 0.2065787443092891\n",
      "Validation Loss: 0.5286168224281735, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 354, Loss: 0.19128501841000148\n",
      "Validation Loss: 0.5432882085442543, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 355, Loss: 0.20443759512688434\n",
      "Validation Loss: 0.5577463780840238, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 356, Loss: 0.21231374304209435\n",
      "Validation Loss: 0.5403775423765182, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 357, Loss: 0.21508764981159142\n",
      "Validation Loss: 0.5123721477058198, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 358, Loss: 0.24324461604867662\n",
      "Validation Loss: 0.554467364317841, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 359, Loss: 0.21484970088515962\n",
      "Validation Loss: 0.5354008658064736, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 360, Loss: 0.2110361440905503\n",
      "Validation Loss: 0.5309290968709521, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 361, Loss: 0.1860895130251135\n",
      "Validation Loss: 0.5536676612165239, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 362, Loss: 0.19927086015897139\n",
      "Validation Loss: 0.5178092593948046, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 363, Loss: 0.19120148329862527\n",
      "Validation Loss: 0.5317394162217776, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 364, Loss: 0.20215884875506163\n",
      "Validation Loss: 0.5058851854668723, Total Accuracy: 55.56%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 66.67%\n",
      "Epoch 365, Loss: 0.18785991785781725\n",
      "Validation Loss: 0.5061765677399106, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 366, Loss: 0.2060800263924258\n",
      "Validation Loss: 0.5308473863535457, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 367, Loss: 0.2246557106929166\n",
      "Validation Loss: 0.5339132439759042, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 368, Loss: 0.20473957913262503\n",
      "Validation Loss: 0.5418220609426498, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 369, Loss: 0.22127991089863436\n",
      "Validation Loss: 0.5314629963702626, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 370, Loss: 0.23298741105411733\n",
      "Validation Loss: 0.5202455553743575, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 371, Loss: 0.2341943582785981\n",
      "Validation Loss: 0.525773737165663, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 372, Loss: 0.22816985898784228\n",
      "Validation Loss: 0.5779442398084534, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 373, Loss: 0.2132402097008058\n",
      "Validation Loss: 0.5352067276835442, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 374, Loss: 0.2365573857511793\n",
      "Validation Loss: 0.5354071466459168, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 375, Loss: 0.25641176477074623\n",
      "Validation Loss: 0.5525898436705271, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 376, Loss: 0.23467850472245896\n",
      "Validation Loss: 0.53653384745121, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 377, Loss: 0.2112588318330901\n",
      "Validation Loss: 0.5464891990025839, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 378, Loss: 0.20269670417266233\n",
      "Validation Loss: 0.5294665520389875, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 379, Loss: 0.17888227397842066\n",
      "Validation Loss: 0.5181587785482407, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 380, Loss: 0.21248467000467436\n",
      "Validation Loss: 0.513686435090171, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 381, Loss: 0.21707520288016116\n",
      "Validation Loss: 0.520993580420812, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 382, Loss: 0.19865358674100467\n",
      "Validation Loss: 0.5451721631818347, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 383, Loss: 0.21036922772015845\n",
      "Validation Loss: 0.5389693338010046, Total Accuracy: 55.56%\n",
      "Accuracy per class - G1: 0.00%, G2: 87.50%, G3: 50.00%\n",
      "Epoch 384, Loss: 0.20673359957124507\n",
      "Validation Loss: 0.510209864212407, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 385, Loss: 0.21003537571855954\n",
      "Validation Loss: 0.5349180499712626, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 386, Loss: 0.2069469510710665\n",
      "Validation Loss: 0.5338918285237418, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 387, Loss: 0.22934891123856818\n",
      "Validation Loss: 0.5343345544404454, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 388, Loss: 0.23283094034663268\n",
      "Validation Loss: 0.5265324811140696, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 389, Loss: 0.19781919196248055\n",
      "Validation Loss: 0.5237225339644485, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 390, Loss: 0.1884449033864907\n",
      "Validation Loss: 0.5476612961954541, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 391, Loss: 0.21289157015936716\n",
      "Validation Loss: 0.5384088564250205, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 392, Loss: 0.19557962406958854\n",
      "Validation Loss: 0.5400029387738969, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 393, Loss: 0.21571041537182672\n",
      "Validation Loss: 0.5478301892677943, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 394, Loss: 0.19406466026391303\n",
      "Validation Loss: 0.528258310423957, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 395, Loss: 0.18786721224231379\n",
      "Validation Loss: 0.5393901417652766, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 396, Loss: 0.2153787272317069\n",
      "Validation Loss: 0.5352388181620173, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 397, Loss: 0.18503401747771672\n",
      "Validation Loss: 0.5490172952413559, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 398, Loss: 0.20993642508983612\n",
      "Validation Loss: 0.5278222834070524, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 399, Loss: 0.18827150509293591\n",
      "Validation Loss: 0.5251444213920169, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 75.00%, G3: 50.00%\n",
      "Epoch 400, Loss: 0.1938761193305254\n",
      "Validation Loss: 0.5419583511021402, Total Accuracy: 55.56%\n",
      "Accuracy per class - G1: 0.00%, G2: 87.50%, G3: 50.00%\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\u001b[34m\u001b[1mwandb\u001b[0m:                                                                                \n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: \n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: Run history:\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:          G1_Acc ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÖ‚ñÖ‚ñÖ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:     G1_TrainAcc ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñÅ‚ñà‚ñà‚ñÅ‚ñà‚ñà‚ñà‚ñÅ‚ñà‚ñà\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:          G2_Acc ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÉ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñà‚ñá‚ñá‚ñà‚ñá‚ñà‚ñà‚ñá‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:     G2_TrainAcc ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÖ‚ñÑ‚ñÑ‚ñÖ‚ñÑ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñà‚ñá‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:          G3_Acc ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÉ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÜ‚ñÉ‚ñÉ‚ñÜ‚ñÜ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:     G3_TrainAcc ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÉ‚ñÇ‚ñÉ‚ñÖ‚ñÖ‚ñÑ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñÜ‚ñà‚ñá‚ñÜ‚ñà‚ñÜ‚ñá‚ñà‚ñá‚ñá‚ñá‚ñà‚ñá‚ñá\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:  Total Accuracy ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÖ‚ñÖ‚ñÇ‚ñÜ‚ñÖ‚ñÖ‚ñÜ‚ñÖ‚ñÜ‚ñÜ‚ñÉ‚ñÖ‚ñÜ‚ñá‚ñÜ‚ñà‚ñÖ‚ñá‚ñá‚ñà‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá‚ñá\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:  Train Accuracy ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÑ‚ñÉ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñà‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà‚ñà\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:      Train loss ‚ñà‚ñà‚ñà‚ñá‚ñá‚ñá‚ñá‚ñÜ‚ñÜ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÑ‚ñÑ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÇ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÇ‚ñÅ\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: Validation Loss ‚ñà‚ñà‚ñá‚ñá‚ñá‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÑ‚ñÉ‚ñÑ‚ñÖ‚ñÑ‚ñÑ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÉ‚ñÉ‚ñÉ‚ñÑ‚ñÇ‚ñÇ‚ñÅ‚ñÉ‚ñÑ‚ñÅ‚ñÅ‚ñÑ‚ñÑ‚ñÑ‚ñÉ‚ñÇ‚ñÇ\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: \n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: Run summary:\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:          G1_Acc 0\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:     G1_TrainAcc 90.90909\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:          G2_Acc 87.5\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:     G2_TrainAcc 94.50549\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:          G3_Acc 50\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:     G3_TrainAcc 75.67568\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:  Total Accuracy 55.55556\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:  Train Accuracy 89.20863\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:      Train loss 0.19388\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: Validation Loss 0.54196\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: \n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: üöÄ View run \u001b[33mResNet3D original best Focalloss\u001b[0m at: \u001b[34m\u001b[4mhttps://wandb.ai/pietro-caforio-politecnico-di-milano/3Dunimodal_ct_training/runs/xtve4n8z\u001b[0m\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: ‚≠êÔ∏è View project at: \u001b[34m\u001b[4mhttps://wandb.ai/pietro-caforio-politecnico-di-milano/3Dunimodal_ct_training\u001b[0m\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: Find logs at: \u001b[35m\u001b[1m./wandb/run-20241013_041705-xtve4n8z/logs\u001b[0m\n"
     ]
    }
   ],
   "source": [
    "from focal_loss.focal_loss import FocalLoss\n",
    "config={\n",
    "    \"learning_rate\": 1e-7,\n",
    "    \"architecture\": \"ResNet3D original best Focalloss\",\n",
    "    \"epochs\": 400,\n",
    "    \"weight_decay\": 1e-5,\n",
    "    \"reduce_lr_factor\": 0.25,\n",
    "    \"patience\": 40,\n",
    "    \"class_weights\": None,\n",
    "    \"early_stop_patience\": None,\n",
    "    \"focal_loss\": 2\n",
    "    }\n",
    "train(model, config, run_name = config[\"architecture\"])"
   ]
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "gpu",
   "dataSources": [
    {
     "datasetId": 5664308,
     "sourceId": 9547833,
     "sourceType": "datasetVersion"
    },
    {
     "datasetId": 5863281,
     "sourceId": 9609374,
     "sourceType": "datasetVersion"
    }
   ],
   "dockerImageVersionId": 30787,
   "isGpuEnabled": true,
   "isInternetEnabled": true,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.14"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 20982.074492,
   "end_time": "2024-10-13T10:05:31.634291",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2024-10-13T04:15:49.559799",
   "version": "2.6.0"
  },
  "widgets": {
   "application/vnd.jupyter.widget-state+json": {
    "state": {
     "0f74e50d11824c589594423e545fb4fd": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.5.0",
      "model_name": "DescriptionStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "1.5.0",
       "_model_name": "DescriptionStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "1.2.0",
       "_view_name": "StyleView",
       "description_width": ""
      }
     },
     "143ad20d35434be89f39cdac70e0081d": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.5.0",
      "model_name": "DescriptionStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "1.5.0",
       "_model_name": "DescriptionStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "1.2.0",
       "_view_name": "StyleView",
       "description_width": ""
      }
     },
     "148dbfbb28564c9392b3e506f8ad78d6": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.5.0",
      "model_name": "HBoxModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "1.5.0",
       "_model_name": "HBoxModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "1.5.0",
       "_view_name": "HBoxView",
       "box_style": "",
       "children": [
        "IPY_MODEL_6a4a435278744922ba00185fa0628e06",
        "IPY_MODEL_a290bba08f9542f9bf35798535d390d9",
        "IPY_MODEL_4dc614faa4bd4cf9a688353619da2b0e"
       ],
       "layout": "IPY_MODEL_655f98d76beb4cfdbd790f0620af4fce"
      }
     },
     "19c4b812c58d4ab6bc3cd5d7bea9fdf8": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.2.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "1.2.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "1.2.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "overflow_x": null,
       "overflow_y": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "4dc614faa4bd4cf9a688353619da2b0e": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.5.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "1.5.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "1.5.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_tooltip": null,
       "layout": "IPY_MODEL_19c4b812c58d4ab6bc3cd5d7bea9fdf8",
       "placeholder": "‚Äã",
       "style": "IPY_MODEL_b13021f1f89f4786a7353648fc1a5884",
       "value": "‚Äá46.8M/46.8M‚Äá[00:03&lt;00:00,‚Äá15.1MB/s]"
      }
     },
     "5aabee46e73c4e1e949fe611f697add0": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.5.0",
      "model_name": "ProgressStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "1.5.0",
       "_model_name": "ProgressStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "1.2.0",
       "_view_name": "StyleView",
       "bar_color": null,
       "description_width": ""
      }
     },
     "5e578b3fcc5c437791b41c60ead2f373": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.2.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "1.2.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "1.2.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "overflow_x": null,
       "overflow_y": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "6213dd8318994913b79d296acfb123b7": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.5.0",
      "model_name": "FloatProgressModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "1.5.0",
       "_model_name": "FloatProgressModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "1.5.0",
       "_view_name": "ProgressView",
       "bar_style": "success",
       "description": "",
       "description_tooltip": null,
       "layout": "IPY_MODEL_5e578b3fcc5c437791b41c60ead2f373",
       "max": 69548,
       "min": 0,
       "orientation": "horizontal",
       "style": "IPY_MODEL_5aabee46e73c4e1e949fe611f697add0",
       "value": 69548
      }
     },
     "62de300bb21143b68602e94c74e3f39b": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.2.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "1.2.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "1.2.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "overflow_x": null,
       "overflow_y": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "655f98d76beb4cfdbd790f0620af4fce": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.2.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "1.2.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "1.2.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "overflow_x": null,
       "overflow_y": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "6a4a435278744922ba00185fa0628e06": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.5.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "1.5.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "1.5.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_tooltip": null,
       "layout": "IPY_MODEL_f1e9deee886e441990c8086b244101b2",
       "placeholder": "‚Äã",
       "style": "IPY_MODEL_143ad20d35434be89f39cdac70e0081d",
       "value": "model.safetensors:‚Äá100%"
      }
     },
     "70c0081ec8cf4159b2cd1184eae53b5d": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.2.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "1.2.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "1.2.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "overflow_x": null,
       "overflow_y": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "7dd733ad658b48359feb02f8c0436c62": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.2.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "1.2.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "1.2.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "overflow_x": null,
       "overflow_y": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "7f4be5cd22f64a6ebf8629388d9fe314": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.5.0",
      "model_name": "HBoxModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "1.5.0",
       "_model_name": "HBoxModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "1.5.0",
       "_view_name": "HBoxView",
       "box_style": "",
       "children": [
        "IPY_MODEL_f98e6a28a77b460aa5b9c367684afbf6",
        "IPY_MODEL_6213dd8318994913b79d296acfb123b7",
        "IPY_MODEL_97a6dfab7007407cac133d69ba3394c0"
       ],
       "layout": "IPY_MODEL_7fe107f7ec564556bbd41a700510e787"
      }
     },
     "7fe107f7ec564556bbd41a700510e787": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.2.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "1.2.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "1.2.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "overflow_x": null,
       "overflow_y": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "8c90ff6ae7f44ed1a6a8496e9269d845": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.5.0",
      "model_name": "ProgressStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "1.5.0",
       "_model_name": "ProgressStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "1.2.0",
       "_view_name": "StyleView",
       "bar_color": null,
       "description_width": ""
      }
     },
     "97a6dfab7007407cac133d69ba3394c0": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.5.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "1.5.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "1.5.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_tooltip": null,
       "layout": "IPY_MODEL_70c0081ec8cf4159b2cd1184eae53b5d",
       "placeholder": "‚Äã",
       "style": "IPY_MODEL_e7c6b1c1c6304d2ca4e35472b1f690b4",
       "value": "‚Äá69.5k/69.5k‚Äá[00:00&lt;00:00,‚Äá326kB/s]"
      }
     },
     "a290bba08f9542f9bf35798535d390d9": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.5.0",
      "model_name": "FloatProgressModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "1.5.0",
       "_model_name": "FloatProgressModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "1.5.0",
       "_view_name": "ProgressView",
       "bar_style": "success",
       "description": "",
       "description_tooltip": null,
       "layout": "IPY_MODEL_7dd733ad658b48359feb02f8c0436c62",
       "max": 46812324,
       "min": 0,
       "orientation": "horizontal",
       "style": "IPY_MODEL_8c90ff6ae7f44ed1a6a8496e9269d845",
       "value": 46812324
      }
     },
     "b13021f1f89f4786a7353648fc1a5884": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.5.0",
      "model_name": "DescriptionStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "1.5.0",
       "_model_name": "DescriptionStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "1.2.0",
       "_view_name": "StyleView",
       "description_width": ""
      }
     },
     "e7c6b1c1c6304d2ca4e35472b1f690b4": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.5.0",
      "model_name": "DescriptionStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "1.5.0",
       "_model_name": "DescriptionStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "1.2.0",
       "_view_name": "StyleView",
       "description_width": ""
      }
     },
     "f1e9deee886e441990c8086b244101b2": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.2.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "1.2.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "1.2.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "overflow_x": null,
       "overflow_y": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "f98e6a28a77b460aa5b9c367684afbf6": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.5.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "1.5.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "1.5.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_tooltip": null,
       "layout": "IPY_MODEL_62de300bb21143b68602e94c74e3f39b",
       "placeholder": "‚Äã",
       "style": "IPY_MODEL_0f74e50d11824c589594423e545fb4fd",
       "value": "config.json:‚Äá100%"
      }
     }
    },
    "version_major": 2,
    "version_minor": 0
   }
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
