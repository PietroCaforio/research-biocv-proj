{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "b0c0ace0",
   "metadata": {
    "papermill": {
     "duration": 0.01161,
     "end_time": "2024-10-12T10:26:05.123504",
     "exception": false,
     "start_time": "2024-10-12T10:26:05.111894",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<a href=\"https://www.kaggle.com/code/pietrocaforio/unimodal-ct-training-kaggle?scriptVersionId=197281783\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "eacacd02",
   "metadata": {
    "papermill": {
     "duration": 0.011275,
     "end_time": "2024-10-12T10:26:05.145338",
     "exception": false,
     "start_time": "2024-10-12T10:26:05.134063",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Train 3D unimodal CT"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "bce6c9a4",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-12T10:26:05.167851Z",
     "iopub.status.busy": "2024-10-12T10:26:05.167431Z",
     "iopub.status.idle": "2024-10-12T10:26:08.610465Z",
     "shell.execute_reply": "2024-10-12T10:26:08.609320Z"
    },
    "papermill": {
     "duration": 3.457166,
     "end_time": "2024-10-12T10:26:08.612791",
     "exception": false,
     "start_time": "2024-10-12T10:26:05.155625",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Cloning into 'research-biocv-proj'...\r\n",
      "remote: Enumerating objects: 462, done.\u001b[K\r\n",
      "remote: Counting objects: 100% (7/7), done.\u001b[K\r\n",
      "remote: Compressing objects: 100% (7/7), done.\u001b[K\r\n",
      "remote: Total 462 (delta 1), reused 1 (delta 0), pack-reused 455 (from 1)\u001b[K\r\n",
      "Receiving objects: 100% (462/462), 3.96 MiB | 6.71 MiB/s, done.\r\n",
      "Resolving deltas: 100% (281/281), done.\r\n",
      "Branch 'dev' set up to track remote branch 'dev' from 'origin'.\r\n",
      "Switched to a new branch 'dev'\r\n"
     ]
    }
   ],
   "source": [
    "!git clone https://github.com/PietroCaforio/research-biocv-proj\n",
    "!cd research-biocv-proj && git switch dev"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "768d4b14",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-12T10:26:08.637413Z",
     "iopub.status.busy": "2024-10-12T10:26:08.637013Z",
     "iopub.status.idle": "2024-10-12T10:26:09.951797Z",
     "shell.execute_reply": "2024-10-12T10:26:09.950596Z"
    },
    "papermill": {
     "duration": 1.329858,
     "end_time": "2024-10-12T10:26:09.954336",
     "exception": false,
     "start_time": "2024-10-12T10:26:08.624478",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Already up to date.\r\n"
     ]
    }
   ],
   "source": [
    "!cd research-biocv-proj && git pull"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "0ed23002",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-12T10:26:09.978739Z",
     "iopub.status.busy": "2024-10-12T10:26:09.978342Z",
     "iopub.status.idle": "2024-10-12T10:26:22.687408Z",
     "shell.execute_reply": "2024-10-12T10:26:22.686161Z"
    },
    "papermill": {
     "duration": 12.723969,
     "end_time": "2024-10-12T10:26:22.689929",
     "exception": false,
     "start_time": "2024-10-12T10:26:09.965960",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Requirement already satisfied: wandb in /opt/conda/lib/python3.10/site-packages (0.18.3)\r\n",
      "Requirement already satisfied: click!=8.0.0,>=7.1 in /opt/conda/lib/python3.10/site-packages (from wandb) (8.1.7)\r\n",
      "Requirement already satisfied: docker-pycreds>=0.4.0 in /opt/conda/lib/python3.10/site-packages (from wandb) (0.4.0)\r\n",
      "Requirement already satisfied: gitpython!=3.1.29,>=1.0.0 in /opt/conda/lib/python3.10/site-packages (from wandb) (3.1.43)\r\n",
      "Requirement already satisfied: platformdirs in /opt/conda/lib/python3.10/site-packages (from wandb) (3.11.0)\r\n",
      "Requirement already satisfied: protobuf!=4.21.0,!=5.28.0,<6,>=3.19.0 in /opt/conda/lib/python3.10/site-packages (from wandb) (3.20.3)\r\n",
      "Requirement already satisfied: psutil>=5.0.0 in /opt/conda/lib/python3.10/site-packages (from wandb) (5.9.3)\r\n",
      "Requirement already satisfied: pyyaml in /opt/conda/lib/python3.10/site-packages (from wandb) (6.0.2)\r\n",
      "Requirement already satisfied: requests<3,>=2.0.0 in /opt/conda/lib/python3.10/site-packages (from wandb) (2.32.3)\r\n",
      "Requirement already satisfied: sentry-sdk>=1.0.0 in /opt/conda/lib/python3.10/site-packages (from wandb) (2.15.0)\r\n",
      "Requirement already satisfied: setproctitle in /opt/conda/lib/python3.10/site-packages (from wandb) (1.3.3)\r\n",
      "Requirement already satisfied: setuptools in /opt/conda/lib/python3.10/site-packages (from wandb) (70.0.0)\r\n",
      "Requirement already satisfied: six>=1.4.0 in /opt/conda/lib/python3.10/site-packages (from docker-pycreds>=0.4.0->wandb) (1.16.0)\r\n",
      "Requirement already satisfied: gitdb<5,>=4.0.1 in /opt/conda/lib/python3.10/site-packages (from gitpython!=3.1.29,>=1.0.0->wandb) (4.0.11)\r\n",
      "Requirement already satisfied: charset-normalizer<4,>=2 in /opt/conda/lib/python3.10/site-packages (from requests<3,>=2.0.0->wandb) (3.3.2)\r\n",
      "Requirement already satisfied: idna<4,>=2.5 in /opt/conda/lib/python3.10/site-packages (from requests<3,>=2.0.0->wandb) (3.7)\r\n",
      "Requirement already satisfied: urllib3<3,>=1.21.1 in /opt/conda/lib/python3.10/site-packages (from requests<3,>=2.0.0->wandb) (1.26.18)\r\n",
      "Requirement already satisfied: certifi>=2017.4.17 in /opt/conda/lib/python3.10/site-packages (from requests<3,>=2.0.0->wandb) (2024.8.30)\r\n",
      "Requirement already satisfied: smmap<6,>=3.0.1 in /opt/conda/lib/python3.10/site-packages (from gitdb<5,>=4.0.1->gitpython!=3.1.29,>=1.0.0->wandb) (5.0.1)\r\n"
     ]
    }
   ],
   "source": [
    "!pip install wandb"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "128ce585",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-12T10:26:22.716101Z",
     "iopub.status.busy": "2024-10-12T10:26:22.715250Z",
     "iopub.status.idle": "2024-10-12T10:26:22.919742Z",
     "shell.execute_reply": "2024-10-12T10:26:22.918847Z"
    },
    "papermill": {
     "duration": 0.219631,
     "end_time": "2024-10-12T10:26:22.921996",
     "exception": false,
     "start_time": "2024-10-12T10:26:22.702365",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "from kaggle_secrets import UserSecretsClient\n",
    "user_secrets = UserSecretsClient()\n",
    "secret_value_0 = user_secrets.get_secret(\"3d_wandb_key\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "39401ea0",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-12T10:26:22.946904Z",
     "iopub.status.busy": "2024-10-12T10:26:22.946598Z",
     "iopub.status.idle": "2024-10-12T10:26:24.916864Z",
     "shell.execute_reply": "2024-10-12T10:26:24.915916Z"
    },
    "papermill": {
     "duration": 1.985213,
     "end_time": "2024-10-12T10:26:24.919061",
     "exception": false,
     "start_time": "2024-10-12T10:26:22.933848",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\u001b[34m\u001b[1mwandb\u001b[0m: Using wandb-core as the SDK backend. Please refer to https://wandb.me/wandb-core for more information.\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: W&B API key is configured. Use \u001b[1m`wandb login --relogin`\u001b[0m to force relogin\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: \u001b[33mWARNING\u001b[0m If you're specifying your api key in code, ensure this code is not shared publicly.\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: \u001b[33mWARNING\u001b[0m Consider setting the WANDB_API_KEY environment variable, or running `wandb login` from the command line.\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: Appending key for api.wandb.ai to your netrc file: /root/.netrc\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "True"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import wandb\n",
    "wandb.login(key=secret_value_0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "6555e27f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-12T10:26:24.945019Z",
     "iopub.status.busy": "2024-10-12T10:26:24.944693Z",
     "iopub.status.idle": "2024-10-12T10:26:29.225084Z",
     "shell.execute_reply": "2024-10-12T10:26:29.224294Z"
    },
    "papermill": {
     "duration": 4.29589,
     "end_time": "2024-10-12T10:26:29.227422",
     "exception": false,
     "start_time": "2024-10-12T10:26:24.931532",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "import sys\n",
    "from pathlib import Path\n",
    "\n",
    "# Add the 'data' directory to sys.path\n",
    "sys.path.append(str(Path('research-biocv-proj').resolve()))\n",
    "from data.unimodal3D import *\n",
    "from pathlib import Path\n",
    "\n",
    "import numpy as np\n",
    "import torch\n",
    "from torch.utils.data import DataLoader\n",
    "\n",
    "from sklearn.utils.class_weight import compute_class_weight"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "df805d77",
   "metadata": {
    "papermill": {
     "duration": 0.011908,
     "end_time": "2024-10-12T10:26:29.252116",
     "exception": false,
     "start_time": "2024-10-12T10:26:29.240208",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "### Train ResNet model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "06edb54e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-12T10:26:29.278022Z",
     "iopub.status.busy": "2024-10-12T10:26:29.277493Z",
     "iopub.status.idle": "2024-10-12T10:26:29.288406Z",
     "shell.execute_reply": "2024-10-12T10:26:29.287504Z"
    },
    "papermill": {
     "duration": 0.026305,
     "end_time": "2024-10-12T10:26:29.290368",
     "exception": false,
     "start_time": "2024-10-12T10:26:29.264063",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "class EarlyStopping:\n",
    "    \"\"\"Early stops the training if validation loss doesn't improve after a given patience.\"\"\"\n",
    "    def __init__(self, patience=7, verbose=False, delta=0, path='checkpoint.pt', trace_func=print):\n",
    "        \"\"\"\n",
    "        Args:\n",
    "            patience (int): How long to wait after last time validation loss improved.\n",
    "                            Default: 7\n",
    "            verbose (bool): If True, prints a message for each validation loss improvement. \n",
    "                            Default: False\n",
    "            delta (float): Minimum change in the monitored quantity to qualify as an improvement.\n",
    "                            Default: 0\n",
    "            path (str): Path for the checkpoint to be saved to.\n",
    "                            Default: 'checkpoint.pt'\n",
    "            trace_func (function): trace print function.\n",
    "                            Default: print            \n",
    "        \"\"\"\n",
    "        self.patience = patience\n",
    "        self.verbose = verbose\n",
    "        self.counter = 0\n",
    "        self.best_score = None\n",
    "        self.early_stop = False\n",
    "        self.val_loss_min = np.Inf\n",
    "        self.delta = delta\n",
    "        self.path = path\n",
    "        self.trace_func = trace_func\n",
    "    def __call__(self, val_loss, model):\n",
    "\n",
    "        score = -val_loss\n",
    "\n",
    "        if self.best_score is None:\n",
    "            self.best_score = score\n",
    "            self.save_checkpoint(val_loss, model)\n",
    "        elif score < self.best_score + self.delta:\n",
    "            self.counter += 1\n",
    "            self.trace_func(f'EarlyStopping counter: {self.counter} out of {self.patience}')\n",
    "            if self.counter >= self.patience:\n",
    "                self.early_stop = True\n",
    "        else:\n",
    "            self.best_score = score\n",
    "            self.save_checkpoint(val_loss, model)\n",
    "            self.counter = 0\n",
    "\n",
    "    def save_checkpoint(self, val_loss, model):\n",
    "        '''Saves model when validation loss decrease.'''\n",
    "        if self.verbose:\n",
    "            self.trace_func(f'Validation loss decreased ({self.val_loss_min:.6f} --> {val_loss:.6f}).  Saving model ...')\n",
    "        torch.save(model.state_dict(), self.path)\n",
    "        self.val_loss_min = val_loss"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "39f1026d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-12T10:26:29.315857Z",
     "iopub.status.busy": "2024-10-12T10:26:29.315545Z",
     "iopub.status.idle": "2024-10-12T10:26:29.339613Z",
     "shell.execute_reply": "2024-10-12T10:26:29.338857Z"
    },
    "papermill": {
     "duration": 0.039117,
     "end_time": "2024-10-12T10:26:29.341461",
     "exception": false,
     "start_time": "2024-10-12T10:26:29.302344",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "def train(model,config, run_name=None):\n",
    "    wandb.init(\n",
    "        # set the wandb project where this run will be logged\n",
    "        project=\"3Dunimodal_ct_training\",\n",
    "        name = run_name,\n",
    "        # track hyperparameters and run metadata\n",
    "        config=config\n",
    "    )\n",
    "    optimizer = optim.Adam(model.parameters(), lr=config[\"learning_rate\"], weight_decay=config[\"weight_decay\"])\n",
    "    if config[\"class_weights\"] is not None: \n",
    "        config[\"class_weights\"] = torch.tensor(config[\"class_weights\"], dtype=torch.float).to(device)\n",
    "    \n",
    "    if config[\"focal_loss\"] is not None:\n",
    "        criterion = FocalLoss(gamma = config[\"focal_loss\"])\n",
    "    else:\n",
    "        criterion = nn.CrossEntropyLoss(weight = config[\"class_weights\"])\n",
    "    \n",
    "    scheduler = optim.lr_scheduler.ReduceLROnPlateau(optimizer, 'min',factor = config[\"reduce_lr_factor\"], patience = config[\"patience\"])\n",
    "    # initialize the early_stopping object\n",
    "    early_stopping = None\n",
    "    if config[\"early_stop_patience\"] is not None:\n",
    "        early_stopping = EarlyStopping(patience=config[\"early_stop_patience\"], verbose=True)\n",
    "    \n",
    "    # Training loop\n",
    "    num_epochs = config[\"epochs\"]\n",
    "    for epoch in range(num_epochs):\n",
    "        model.train()\n",
    "        running_loss = 0.0\n",
    "        train_correct = 0\n",
    "        total = 0\n",
    "        correct_per_class = [0, 0, 0]  # For G1, G2, G3\n",
    "        total_per_class = [0, 0, 0]  # For G1, G2, G3\n",
    "        for batch in train_loader:\n",
    "            volumes = batch['volume'].float().to(device)\n",
    "            labels = batch['label'].long().to(device)\n",
    "            #print(f\"volumes batch dimensions: {volumes.size()}\")\n",
    "            optimizer.zero_grad()\n",
    "            outputs = model(volumes.unsqueeze(1))\n",
    "            \n",
    "            if config[\"focal_loss\"]:\n",
    "                softmax = torch.nn.Softmax(dim=-1)\n",
    "                loss = criterion(softmax(outputs), labels)\n",
    "            else:\n",
    "                loss = criterion(outputs, labels)\n",
    "            \n",
    "            _, predicted = torch.max(outputs, 1)\n",
    "            train_correct += (predicted == labels).sum().item()\n",
    "            loss.backward()\n",
    "            optimizer.step()\n",
    "            total += labels.size(0)\n",
    "            running_loss += loss.item()\n",
    "            \n",
    "            # Calculate accuracy per class\n",
    "            for i in range(3):  # We have 3 classes: G1 (0), G2 (1), G3 (2)\n",
    "                correct_per_class[i] += ((predicted == i) & (labels == i)).sum().item()\n",
    "                total_per_class[i] += (labels == i).sum().item()\n",
    "\n",
    "        train_accuracy = 100 * train_correct / total\n",
    "        class_accuracy = [(100 * correct_per_class[i] / total_per_class[i]) if total_per_class[i] > 0 else 0 for i in range(3)]\n",
    "        print(f\"Epoch {epoch+1}, Loss: {running_loss/len(train_loader)}\")\n",
    "        wandb.log({\"Train Accuracy\": train_accuracy, \"Train loss\": running_loss/len(train_loader), \"G1_TrainAcc\":class_accuracy[0], \"G2_TrainAcc\":class_accuracy[1], \"G3_TrainAcc\":class_accuracy[2]})\n",
    "\n",
    "        # Validation loop\n",
    "        model.eval()\n",
    "        val_loss = 0.0\n",
    "        correct = 0\n",
    "        total = 0\n",
    "        # Initialize counters for each class (G1, G2, G3)\n",
    "        correct_per_class = [0, 0, 0]  # For G1, G2, G3\n",
    "        total_per_class = [0, 0, 0]  # For G1, G2, G3\n",
    "\n",
    "        with torch.no_grad():\n",
    "            for batch in val_loader:\n",
    "                volumes = batch['volume'].float().to(device)\n",
    "                labels = batch['label'].long().to(device)\n",
    "                \n",
    "                outputs = model(volumes.unsqueeze(1))\n",
    "                if config[\"focal_loss\"]:\n",
    "                    softmax = torch.nn.Softmax(dim=-1)\n",
    "                    loss = criterion(softmax(outputs), labels)\n",
    "                else:\n",
    "                    loss = criterion(outputs, labels)\n",
    "                \n",
    "                val_loss += loss.item()\n",
    "                _, predicted = torch.max(outputs, 1)\n",
    "                total += labels.size(0)\n",
    "                correct += (predicted == labels).sum().item()\n",
    "\n",
    "                # Calculate accuracy per class\n",
    "                for i in range(3):  # We have 3 classes: G1 (0), G2 (1), G3 (2)\n",
    "                    correct_per_class[i] += ((predicted == i) & (labels == i)).sum().item()\n",
    "                    total_per_class[i] += (labels == i).sum().item()\n",
    "        scheduler.step(val_loss)\n",
    "        # Compute total accuracy and per-class accuracy\n",
    "        total_accuracy = 100 * correct / total\n",
    "        class_accuracy = [(100 * correct_per_class[i] / total_per_class[i]) if total_per_class[i] > 0 else 0 for i in range(3)]\n",
    "        print(f\"Validation Loss: {val_loss/len(val_loader)}, Total Accuracy: {total_accuracy:.2f}%\")\n",
    "        print(f\"Accuracy per class - G1: {class_accuracy[0]:.2f}%, G2: {class_accuracy[1]:.2f}%, G3: {class_accuracy[2]:.2f}%\")\n",
    "        # log metrics to wandb\n",
    "        wandb.log({\"Total Accuracy\": total_accuracy, \"Validation Loss\": val_loss/len(val_loader), \"G1_Acc\":class_accuracy[0], \"G2_Acc\":class_accuracy[1], \"G3_Acc\":class_accuracy[2]})\n",
    "        if config[\"early_stop_patience\"] is not None:\n",
    "            early_stopping(val_loss, model)\n",
    "        \n",
    "        if config[\"early_stop_patience\"] is not None:\n",
    "            if early_stopping.early_stop:\n",
    "                print(\"Early stopping\")\n",
    "                break\n",
    "    wandb.finish()   "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "8cf0ed72",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-12T10:26:29.368117Z",
     "iopub.status.busy": "2024-10-12T10:26:29.367765Z",
     "iopub.status.idle": "2024-10-12T10:26:31.395718Z",
     "shell.execute_reply": "2024-10-12T10:26:31.394791Z"
    },
    "papermill": {
     "duration": 2.044634,
     "end_time": "2024-10-12T10:26:31.398114",
     "exception": false,
     "start_time": "2024-10-12T10:26:29.353480",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "import torch.nn as nn\n",
    "import torch.optim as optim\n",
    "from transformers import ResNetForImageClassification"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "c5ee92ba",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-12T10:26:31.424174Z",
     "iopub.status.busy": "2024-10-12T10:26:31.423683Z",
     "iopub.status.idle": "2024-10-12T10:26:47.662611Z",
     "shell.execute_reply": "2024-10-12T10:26:47.661538Z"
    },
    "papermill": {
     "duration": 16.25458,
     "end_time": "2024-10-12T10:26:47.665033",
     "exception": false,
     "start_time": "2024-10-12T10:26:31.410453",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "train_dataset = UnimodalCTDataset3D(split='train',dataset_path = \"/kaggle/input/preprocessed57patientscptacpda/processed/\" )\n",
    "val_dataset = UnimodalCTDataset3D(split='val',dataset_path = \"/kaggle/input/preprocessed57patientscptacpda/processed/\")\n",
    "\n",
    "train_loader = DataLoader(train_dataset, batch_size=5, shuffle=True)\n",
    "val_loader = DataLoader(val_dataset, batch_size=2, shuffle=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "6edc0cb4",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-12T10:26:47.691151Z",
     "iopub.status.busy": "2024-10-12T10:26:47.690813Z",
     "iopub.status.idle": "2024-10-12T10:26:47.695837Z",
     "shell.execute_reply": "2024-10-12T10:26:47.694915Z"
    },
    "papermill": {
     "duration": 0.020092,
     "end_time": "2024-10-12T10:26:47.697924",
     "exception": false,
     "start_time": "2024-10-12T10:26:47.677832",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Training set stats:{'length': 139, 'class_frequency': {'G1': 11, 'G2': 91, 'G3': 37}}\n",
      "Validation set stats:{'length': 18, 'class_frequency': {'G1': 4, 'G2': 8, 'G3': 6}}\n"
     ]
    }
   ],
   "source": [
    "print(f\"Training set stats:{train_dataset.stats()}\")\n",
    "print(f\"Validation set stats:{val_dataset.stats()}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "d27502cd",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-12T10:26:47.723660Z",
     "iopub.status.busy": "2024-10-12T10:26:47.722947Z",
     "iopub.status.idle": "2024-10-12T10:26:48.739643Z",
     "shell.execute_reply": "2024-10-12T10:26:48.738855Z"
    },
    "papermill": {
     "duration": 1.032045,
     "end_time": "2024-10-12T10:26:48.741970",
     "exception": false,
     "start_time": "2024-10-12T10:26:47.709925",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "labels = []\n",
    "for sample in train_dataset:\n",
    "    labels.append(sample[\"label\"])\n",
    "labels = np.array(labels)\n",
    "class_weights = compute_class_weight(\"balanced\", classes=np.unique(labels), y=labels)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "064d9941",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-12T10:26:48.768876Z",
     "iopub.status.busy": "2024-10-12T10:26:48.768207Z",
     "iopub.status.idle": "2024-10-12T10:26:48.773049Z",
     "shell.execute_reply": "2024-10-12T10:26:48.772173Z"
    },
    "papermill": {
     "duration": 0.020318,
     "end_time": "2024-10-12T10:26:48.775240",
     "exception": false,
     "start_time": "2024-10-12T10:26:48.754922",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[4.21212121 0.50915751 1.25225225]\n"
     ]
    }
   ],
   "source": [
    "print(class_weights)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "31f7f694",
   "metadata": {
    "papermill": {
     "duration": 0.012099,
     "end_time": "2024-10-12T10:26:48.800056",
     "exception": false,
     "start_time": "2024-10-12T10:26:48.787957",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "### 3D Resnet-18"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "684e042c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-12T10:26:48.825799Z",
     "iopub.status.busy": "2024-10-12T10:26:48.825453Z",
     "iopub.status.idle": "2024-10-12T10:26:49.771409Z",
     "shell.execute_reply": "2024-10-12T10:26:49.770611Z"
    },
    "papermill": {
     "duration": 0.9616,
     "end_time": "2024-10-12T10:26:49.773736",
     "exception": false,
     "start_time": "2024-10-12T10:26:48.812136",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "import torchvision.models as models"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "41408f18",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-12T10:26:49.799971Z",
     "iopub.status.busy": "2024-10-12T10:26:49.799624Z",
     "iopub.status.idle": "2024-10-12T10:26:49.806045Z",
     "shell.execute_reply": "2024-10-12T10:26:49.805266Z"
    },
    "papermill": {
     "duration": 0.021589,
     "end_time": "2024-10-12T10:26:49.807913",
     "exception": false,
     "start_time": "2024-10-12T10:26:49.786324",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "class ResNet3D(nn.Module):\n",
    "    def __init__(self, num_classes):\n",
    "        super(ResNet3D, self).__init__()\n",
    "        self.model = models.video.r3d_18(pretrained=True)  # 3D ResNet18\n",
    "        self.model.stem[0] = nn.Conv3d(1, 64, kernel_size=(7, 7, 7), stride=(2, 2, 2), padding=(3, 3, 3), bias=False)\n",
    "        self.model.fc = nn.Linear(self.model.fc.in_features, num_classes)\n",
    "    \n",
    "    def forward(self, x):\n",
    "        return self.model(x)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "bebc3adb",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-12T10:26:49.833658Z",
     "iopub.status.busy": "2024-10-12T10:26:49.833320Z",
     "iopub.status.idle": "2024-10-12T10:26:51.236390Z",
     "shell.execute_reply": "2024-10-12T10:26:51.235521Z"
    },
    "papermill": {
     "duration": 1.418868,
     "end_time": "2024-10-12T10:26:51.239070",
     "exception": false,
     "start_time": "2024-10-12T10:26:49.820202",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/opt/conda/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.\n",
      "  warnings.warn(\n",
      "/opt/conda/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=R3D_18_Weights.KINETICS400_V1`. You can also use `weights=R3D_18_Weights.DEFAULT` to get the most up-to-date weights.\n",
      "  warnings.warn(msg)\n",
      "Downloading: \"https://download.pytorch.org/models/r3d_18-b3b3357e.pth\" to /root/.cache/torch/hub/checkpoints/r3d_18-b3b3357e.pth\n",
      "100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 127M/127M [00:00<00:00, 198MB/s]\n"
     ]
    }
   ],
   "source": [
    "model = ResNet3D(num_classes = 3)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "c67c4404",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-12T10:26:51.267389Z",
     "iopub.status.busy": "2024-10-12T10:26:51.267042Z",
     "iopub.status.idle": "2024-10-12T10:26:51.542999Z",
     "shell.execute_reply": "2024-10-12T10:26:51.542040Z"
    },
    "papermill": {
     "duration": 0.292174,
     "end_time": "2024-10-12T10:26:51.544942",
     "exception": false,
     "start_time": "2024-10-12T10:26:51.252768",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "ResNet3D(\n",
       "  (model): VideoResNet(\n",
       "    (stem): BasicStem(\n",
       "      (0): Conv3d(1, 64, kernel_size=(7, 7, 7), stride=(2, 2, 2), padding=(3, 3, 3), bias=False)\n",
       "      (1): BatchNorm3d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "      (2): ReLU(inplace=True)\n",
       "    )\n",
       "    (layer1): Sequential(\n",
       "      (0): BasicBlock(\n",
       "        (conv1): Sequential(\n",
       "          (0): Conv3DSimple(64, 64, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "          (2): ReLU(inplace=True)\n",
       "        )\n",
       "        (conv2): Sequential(\n",
       "          (0): Conv3DSimple(64, 64, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "        )\n",
       "        (relu): ReLU(inplace=True)\n",
       "      )\n",
       "      (1): BasicBlock(\n",
       "        (conv1): Sequential(\n",
       "          (0): Conv3DSimple(64, 64, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "          (2): ReLU(inplace=True)\n",
       "        )\n",
       "        (conv2): Sequential(\n",
       "          (0): Conv3DSimple(64, 64, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "        )\n",
       "        (relu): ReLU(inplace=True)\n",
       "      )\n",
       "    )\n",
       "    (layer2): Sequential(\n",
       "      (0): BasicBlock(\n",
       "        (conv1): Sequential(\n",
       "          (0): Conv3DSimple(64, 128, kernel_size=(3, 3, 3), stride=(2, 2, 2), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "          (2): ReLU(inplace=True)\n",
       "        )\n",
       "        (conv2): Sequential(\n",
       "          (0): Conv3DSimple(128, 128, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "        )\n",
       "        (relu): ReLU(inplace=True)\n",
       "        (downsample): Sequential(\n",
       "          (0): Conv3d(64, 128, kernel_size=(1, 1, 1), stride=(2, 2, 2), bias=False)\n",
       "          (1): BatchNorm3d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "        )\n",
       "      )\n",
       "      (1): BasicBlock(\n",
       "        (conv1): Sequential(\n",
       "          (0): Conv3DSimple(128, 128, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "          (2): ReLU(inplace=True)\n",
       "        )\n",
       "        (conv2): Sequential(\n",
       "          (0): Conv3DSimple(128, 128, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "        )\n",
       "        (relu): ReLU(inplace=True)\n",
       "      )\n",
       "    )\n",
       "    (layer3): Sequential(\n",
       "      (0): BasicBlock(\n",
       "        (conv1): Sequential(\n",
       "          (0): Conv3DSimple(128, 256, kernel_size=(3, 3, 3), stride=(2, 2, 2), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "          (2): ReLU(inplace=True)\n",
       "        )\n",
       "        (conv2): Sequential(\n",
       "          (0): Conv3DSimple(256, 256, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "        )\n",
       "        (relu): ReLU(inplace=True)\n",
       "        (downsample): Sequential(\n",
       "          (0): Conv3d(128, 256, kernel_size=(1, 1, 1), stride=(2, 2, 2), bias=False)\n",
       "          (1): BatchNorm3d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "        )\n",
       "      )\n",
       "      (1): BasicBlock(\n",
       "        (conv1): Sequential(\n",
       "          (0): Conv3DSimple(256, 256, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "          (2): ReLU(inplace=True)\n",
       "        )\n",
       "        (conv2): Sequential(\n",
       "          (0): Conv3DSimple(256, 256, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "        )\n",
       "        (relu): ReLU(inplace=True)\n",
       "      )\n",
       "    )\n",
       "    (layer4): Sequential(\n",
       "      (0): BasicBlock(\n",
       "        (conv1): Sequential(\n",
       "          (0): Conv3DSimple(256, 512, kernel_size=(3, 3, 3), stride=(2, 2, 2), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "          (2): ReLU(inplace=True)\n",
       "        )\n",
       "        (conv2): Sequential(\n",
       "          (0): Conv3DSimple(512, 512, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "        )\n",
       "        (relu): ReLU(inplace=True)\n",
       "        (downsample): Sequential(\n",
       "          (0): Conv3d(256, 512, kernel_size=(1, 1, 1), stride=(2, 2, 2), bias=False)\n",
       "          (1): BatchNorm3d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "        )\n",
       "      )\n",
       "      (1): BasicBlock(\n",
       "        (conv1): Sequential(\n",
       "          (0): Conv3DSimple(512, 512, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "          (2): ReLU(inplace=True)\n",
       "        )\n",
       "        (conv2): Sequential(\n",
       "          (0): Conv3DSimple(512, 512, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "        )\n",
       "        (relu): ReLU(inplace=True)\n",
       "      )\n",
       "    )\n",
       "    (avgpool): AdaptiveAvgPool3d(output_size=(1, 1, 1))\n",
       "    (fc): Linear(in_features=512, out_features=3, bias=True)\n",
       "  )\n",
       ")"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "device = torch.device(\"cuda\" if torch.cuda.is_available() else \"cpu\")\n",
    "model.to(device)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "9e82ee9b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-12T10:26:51.573995Z",
     "iopub.status.busy": "2024-10-12T10:26:51.573627Z",
     "iopub.status.idle": "2024-10-12T10:27:03.721735Z",
     "shell.execute_reply": "2024-10-12T10:27:03.720498Z"
    },
    "papermill": {
     "duration": 12.165559,
     "end_time": "2024-10-12T10:27:03.724206",
     "exception": false,
     "start_time": "2024-10-12T10:26:51.558647",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Collecting focal_loss_torch\r\n",
      "  Downloading focal_loss_torch-0.1.2-py3-none-any.whl.metadata (2.2 kB)\r\n",
      "Requirement already satisfied: torch in /opt/conda/lib/python3.10/site-packages (from focal_loss_torch) (2.4.0)\r\n",
      "Requirement already satisfied: numpy in /opt/conda/lib/python3.10/site-packages (from focal_loss_torch) (1.26.4)\r\n",
      "Requirement already satisfied: filelock in /opt/conda/lib/python3.10/site-packages (from torch->focal_loss_torch) (3.15.1)\r\n",
      "Requirement already satisfied: typing-extensions>=4.8.0 in /opt/conda/lib/python3.10/site-packages (from torch->focal_loss_torch) (4.12.2)\r\n",
      "Requirement already satisfied: sympy in /opt/conda/lib/python3.10/site-packages (from torch->focal_loss_torch) (1.13.3)\r\n",
      "Requirement already satisfied: networkx in /opt/conda/lib/python3.10/site-packages (from torch->focal_loss_torch) (3.3)\r\n",
      "Requirement already satisfied: jinja2 in /opt/conda/lib/python3.10/site-packages (from torch->focal_loss_torch) (3.1.4)\r\n",
      "Requirement already satisfied: fsspec in /opt/conda/lib/python3.10/site-packages (from torch->focal_loss_torch) (2024.6.1)\r\n",
      "Requirement already satisfied: MarkupSafe>=2.0 in /opt/conda/lib/python3.10/site-packages (from jinja2->torch->focal_loss_torch) (2.1.5)\r\n",
      "Requirement already satisfied: mpmath<1.4,>=1.1.0 in /opt/conda/lib/python3.10/site-packages (from sympy->torch->focal_loss_torch) (1.3.0)\r\n",
      "Downloading focal_loss_torch-0.1.2-py3-none-any.whl (4.5 kB)\r\n",
      "Installing collected packages: focal_loss_torch\r\n",
      "Successfully installed focal_loss_torch-0.1.2\r\n"
     ]
    }
   ],
   "source": [
    "#https://github.com/mathiaszinnen/focal_loss_torch/tree/main\n",
    "!pip install focal_loss_torch"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "701449bb",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-12T10:27:03.754102Z",
     "iopub.status.busy": "2024-10-12T10:27:03.753731Z",
     "iopub.status.idle": "2024-10-12T16:12:16.733458Z",
     "shell.execute_reply": "2024-10-12T16:12:16.732507Z"
    },
    "papermill": {
     "duration": 20712.996783,
     "end_time": "2024-10-12T16:12:16.735498",
     "exception": false,
     "start_time": "2024-10-12T10:27:03.738715",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\u001b[34m\u001b[1mwandb\u001b[0m: Currently logged in as: \u001b[33mpietro-caforio\u001b[0m (\u001b[33mpietro-caforio-politecnico-di-milano\u001b[0m). Use \u001b[1m`wandb login --relogin`\u001b[0m to force relogin\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: Tracking run with wandb version 0.18.3\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: Run data is saved locally in \u001b[35m\u001b[1m/kaggle/working/wandb/run-20241012_102703-plhqdwcn\u001b[0m\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: Run \u001b[1m`wandb offline`\u001b[0m to turn off syncing.\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: Syncing run \u001b[33mResNet3D original best Focalloss\u001b[0m\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: ‚≠êÔ∏è View project at \u001b[34m\u001b[4mhttps://wandb.ai/pietro-caforio-politecnico-di-milano/3Dunimodal_ct_training\u001b[0m\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: üöÄ View run at \u001b[34m\u001b[4mhttps://wandb.ai/pietro-caforio-politecnico-di-milano/3Dunimodal_ct_training/runs/plhqdwcn\u001b[0m\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Epoch 1, Loss: 0.5598972833582333\n",
      "Validation Loss: 0.556920760207706, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 0.00%\n",
      "Epoch 2, Loss: 0.5585518298404557\n",
      "Validation Loss: 0.5687957108020782, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 50.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 3, Loss: 0.5667200492961066\n",
      "Validation Loss: 0.5963587992721133, Total Accuracy: 16.67%\n",
      "Accuracy per class - G1: 75.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 4, Loss: 0.5547193267515728\n",
      "Validation Loss: 0.5848674409919314, Total Accuracy: 16.67%\n",
      "Accuracy per class - G1: 75.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 5, Loss: 0.5526112594774791\n",
      "Validation Loss: 0.5840732422139909, Total Accuracy: 16.67%\n",
      "Accuracy per class - G1: 75.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 6, Loss: 0.5556686435426984\n",
      "Validation Loss: 0.5776386492782168, Total Accuracy: 16.67%\n",
      "Accuracy per class - G1: 75.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 7, Loss: 0.5524364326681409\n",
      "Validation Loss: 0.5752132766776614, Total Accuracy: 16.67%\n",
      "Accuracy per class - G1: 75.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 8, Loss: 0.5410449451633862\n",
      "Validation Loss: 0.5851612769895129, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 9, Loss: 0.5431776738592556\n",
      "Validation Loss: 0.579573286904229, Total Accuracy: 16.67%\n",
      "Accuracy per class - G1: 75.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 10, Loss: 0.5387739901031766\n",
      "Validation Loss: 0.5705301728513505, Total Accuracy: 16.67%\n",
      "Accuracy per class - G1: 75.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 11, Loss: 0.5405936422092574\n",
      "Validation Loss: 0.5839270932806863, Total Accuracy: 16.67%\n",
      "Accuracy per class - G1: 75.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 12, Loss: 0.5394781146730695\n",
      "Validation Loss: 0.5842674043443468, Total Accuracy: 16.67%\n",
      "Accuracy per class - G1: 75.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 13, Loss: 0.5390290138976914\n",
      "Validation Loss: 0.5778930700487561, Total Accuracy: 16.67%\n",
      "Accuracy per class - G1: 75.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 14, Loss: 0.5290461289031165\n",
      "Validation Loss: 0.5654667185412513, Total Accuracy: 16.67%\n",
      "Accuracy per class - G1: 75.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 15, Loss: 0.5340330611382212\n",
      "Validation Loss: 0.5810636447535621, Total Accuracy: 16.67%\n",
      "Accuracy per class - G1: 75.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 16, Loss: 0.5301151254347393\n",
      "Validation Loss: 0.5758492052555084, Total Accuracy: 16.67%\n",
      "Accuracy per class - G1: 75.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 17, Loss: 0.5263874637229102\n",
      "Validation Loss: 0.5803867081801096, Total Accuracy: 16.67%\n",
      "Accuracy per class - G1: 75.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 18, Loss: 0.5317275949886867\n",
      "Validation Loss: 0.5672239926126268, Total Accuracy: 16.67%\n",
      "Accuracy per class - G1: 75.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 19, Loss: 0.5266907779233796\n",
      "Validation Loss: 0.570925795369678, Total Accuracy: 16.67%\n",
      "Accuracy per class - G1: 75.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 20, Loss: 0.5219837192978177\n",
      "Validation Loss: 0.579442087146971, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 21, Loss: 0.5193615502544812\n",
      "Validation Loss: 0.569571379158232, Total Accuracy: 16.67%\n",
      "Accuracy per class - G1: 75.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 22, Loss: 0.519939127777304\n",
      "Validation Loss: 0.5758137007554373, Total Accuracy: 16.67%\n",
      "Accuracy per class - G1: 75.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 23, Loss: 0.5193099177309445\n",
      "Validation Loss: 0.575717055135303, Total Accuracy: 16.67%\n",
      "Accuracy per class - G1: 75.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 24, Loss: 0.5158862407718386\n",
      "Validation Loss: 0.5758492979738448, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 25, Loss: 0.5186344874756676\n",
      "Validation Loss: 0.5787139534950256, Total Accuracy: 16.67%\n",
      "Accuracy per class - G1: 75.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 26, Loss: 0.5056414306163788\n",
      "Validation Loss: 0.5692781971560584, Total Accuracy: 16.67%\n",
      "Accuracy per class - G1: 75.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 27, Loss: 0.5065361016563007\n",
      "Validation Loss: 0.5598199764887491, Total Accuracy: 16.67%\n",
      "Accuracy per class - G1: 75.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 28, Loss: 0.5165212005376816\n",
      "Validation Loss: 0.581534312831031, Total Accuracy: 16.67%\n",
      "Accuracy per class - G1: 75.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 29, Loss: 0.517454706132412\n",
      "Validation Loss: 0.5782836443848081, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 30, Loss: 0.50008667579719\n",
      "Validation Loss: 0.5634768969482846, Total Accuracy: 16.67%\n",
      "Accuracy per class - G1: 75.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 31, Loss: 0.5024701846497399\n",
      "Validation Loss: 0.5530853569507599, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 32, Loss: 0.4981570062892778\n",
      "Validation Loss: 0.5640629761748843, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 33, Loss: 0.5006338176982743\n",
      "Validation Loss: 0.5542024771372477, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 34, Loss: 0.4887465877192361\n",
      "Validation Loss: 0.5549090405305227, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 35, Loss: 0.484908538205283\n",
      "Validation Loss: 0.5531229111883376, Total Accuracy: 16.67%\n",
      "Accuracy per class - G1: 75.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 36, Loss: 0.5000745579600334\n",
      "Validation Loss: 0.5643253790007697, Total Accuracy: 16.67%\n",
      "Accuracy per class - G1: 75.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 37, Loss: 0.5046681634017399\n",
      "Validation Loss: 0.5719354301691055, Total Accuracy: 16.67%\n",
      "Accuracy per class - G1: 75.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 38, Loss: 0.4841733915465219\n",
      "Validation Loss: 0.5556831392976973, Total Accuracy: 16.67%\n",
      "Accuracy per class - G1: 75.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 39, Loss: 0.5047457292675972\n",
      "Validation Loss: 0.5749730169773102, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 40, Loss: 0.5012939189161573\n",
      "Validation Loss: 0.5602052211761475, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 41, Loss: 0.47352858845676693\n",
      "Validation Loss: 0.5624698632293277, Total Accuracy: 16.67%\n",
      "Accuracy per class - G1: 75.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 42, Loss: 0.4891290302787508\n",
      "Validation Loss: 0.5633164578013949, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 43, Loss: 0.48297929550920216\n",
      "Validation Loss: 0.5616893205377791, Total Accuracy: 16.67%\n",
      "Accuracy per class - G1: 75.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 44, Loss: 0.4747458430273192\n",
      "Validation Loss: 0.55301719572809, Total Accuracy: 16.67%\n",
      "Accuracy per class - G1: 75.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 45, Loss: 0.4863053634762764\n",
      "Validation Loss: 0.5604557130071852, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 46, Loss: 0.4852423518896103\n",
      "Validation Loss: 0.5477495425277286, Total Accuracy: 16.67%\n",
      "Accuracy per class - G1: 75.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 47, Loss: 0.4802889845200947\n",
      "Validation Loss: 0.5510916610558828, Total Accuracy: 16.67%\n",
      "Accuracy per class - G1: 75.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 48, Loss: 0.47655243426561356\n",
      "Validation Loss: 0.5515473915470971, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 49, Loss: 0.46718986332416534\n",
      "Validation Loss: 0.5428409576416016, Total Accuracy: 16.67%\n",
      "Accuracy per class - G1: 75.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 50, Loss: 0.467950881591865\n",
      "Validation Loss: 0.542876296573215, Total Accuracy: 16.67%\n",
      "Accuracy per class - G1: 75.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 51, Loss: 0.46796528143542154\n",
      "Validation Loss: 0.5581642025046878, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 52, Loss: 0.47271213999816347\n",
      "Validation Loss: 0.5475453370147281, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 53, Loss: 0.45608372347695486\n",
      "Validation Loss: 0.5430344475640191, Total Accuracy: 16.67%\n",
      "Accuracy per class - G1: 75.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 54, Loss: 0.45567994671208517\n",
      "Validation Loss: 0.5527631011274126, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 55, Loss: 0.4603195403303419\n",
      "Validation Loss: 0.5525995923413171, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 56, Loss: 0.4562290481158665\n",
      "Validation Loss: 0.5594334668583341, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 57, Loss: 0.464001684316567\n",
      "Validation Loss: 0.5521424180931516, Total Accuracy: 16.67%\n",
      "Accuracy per class - G1: 75.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 58, Loss: 0.46983593702316284\n",
      "Validation Loss: 0.5477099849118127, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 59, Loss: 0.46354597381183077\n",
      "Validation Loss: 0.5568442808257209, Total Accuracy: 16.67%\n",
      "Accuracy per class - G1: 75.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 60, Loss: 0.45882511883974075\n",
      "Validation Loss: 0.5454937120278677, Total Accuracy: 16.67%\n",
      "Accuracy per class - G1: 75.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 61, Loss: 0.4615658436502729\n",
      "Validation Loss: 0.5437665217452579, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 75.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 62, Loss: 0.45661824622324537\n",
      "Validation Loss: 0.5443124969800314, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 63, Loss: 0.4470444385494505\n",
      "Validation Loss: 0.5510706735981835, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 64, Loss: 0.46166895223515375\n",
      "Validation Loss: 0.5402411222457886, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 75.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 65, Loss: 0.45585062354803085\n",
      "Validation Loss: 0.5487847427527109, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 75.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 66, Loss: 0.45179043816668646\n",
      "Validation Loss: 0.5500591761536069, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 100.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 67, Loss: 0.4504404919488089\n",
      "Validation Loss: 0.5367871721585592, Total Accuracy: 16.67%\n",
      "Accuracy per class - G1: 75.00%, G2: 0.00%, G3: 0.00%\n",
      "Epoch 68, Loss: 0.4420747703739575\n",
      "Validation Loss: 0.537459714545144, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 75.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 69, Loss: 0.4483255392738751\n",
      "Validation Loss: 0.5466607643498315, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 75.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 70, Loss: 0.4426672799246652\n",
      "Validation Loss: 0.5330080456203885, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 75.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 71, Loss: 0.44134160769837244\n",
      "Validation Loss: 0.5412932501898872, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 75.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 72, Loss: 0.4337097608617374\n",
      "Validation Loss: 0.5336815019448599, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 100.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 73, Loss: 0.4405115640589169\n",
      "Validation Loss: 0.53577611512608, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 75.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 74, Loss: 0.4398135415145329\n",
      "Validation Loss: 0.5429737336105771, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 100.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 75, Loss: 0.4367200253265245\n",
      "Validation Loss: 0.5462721520000033, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 100.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 76, Loss: 0.4427799295101847\n",
      "Validation Loss: 0.5370673404799567, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 75.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 77, Loss: 0.4414215758442879\n",
      "Validation Loss: 0.5329593386914995, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 75.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 78, Loss: 0.43396484426089693\n",
      "Validation Loss: 0.5277744995223151, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 75.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 79, Loss: 0.44428459235600065\n",
      "Validation Loss: 0.5415833857324388, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 100.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 80, Loss: 0.4330241445984159\n",
      "Validation Loss: 0.5392720003922781, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 75.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 81, Loss: 0.4282152886901583\n",
      "Validation Loss: 0.53660230173005, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 50.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 82, Loss: 0.4308799813900675\n",
      "Validation Loss: 0.5381840599907769, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 75.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 83, Loss: 0.4242176370961325\n",
      "Validation Loss: 0.5310905343956418, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 75.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 84, Loss: 0.43129338856254307\n",
      "Validation Loss: 0.5206150246991051, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 75.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 85, Loss: 0.4307570808700153\n",
      "Validation Loss: 0.5326797597938113, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 75.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 86, Loss: 0.4277714693120548\n",
      "Validation Loss: 0.5274974438879225, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 75.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 87, Loss: 0.42298704385757446\n",
      "Validation Loss: 0.5383954015043046, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 75.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 88, Loss: 0.4288885359253202\n",
      "Validation Loss: 0.5342946615484025, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 75.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 89, Loss: 0.4299137496522495\n",
      "Validation Loss: 0.5279289351569282, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 75.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 90, Loss: 0.4075571170875004\n",
      "Validation Loss: 0.5368524524900649, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 75.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 91, Loss: 0.4271371141076088\n",
      "Validation Loss: 0.531840807861752, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 75.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 92, Loss: 0.41334084208522526\n",
      "Validation Loss: 0.5246615707874298, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 75.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 93, Loss: 0.41630952060222626\n",
      "Validation Loss: 0.5327457818720076, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 75.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 94, Loss: 0.4166721659047263\n",
      "Validation Loss: 0.5316889584064484, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 75.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 95, Loss: 0.4098424113222531\n",
      "Validation Loss: 0.5305155946148766, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 75.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 96, Loss: 0.4124601717506136\n",
      "Validation Loss: 0.5327213141653273, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 75.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 97, Loss: 0.40513407971177784\n",
      "Validation Loss: 0.5361391405264536, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 50.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 98, Loss: 0.4153096473642758\n",
      "Validation Loss: 0.5309593611293368, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 75.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 99, Loss: 0.40637711329119547\n",
      "Validation Loss: 0.5312945312923856, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 75.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 100, Loss: 0.4031836305345808\n",
      "Validation Loss: 0.523109624783198, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 75.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 101, Loss: 0.40589180695159094\n",
      "Validation Loss: 0.5338773495621152, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 75.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 102, Loss: 0.4055841990879604\n",
      "Validation Loss: 0.5096437666151259, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 75.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 103, Loss: 0.41016040316649843\n",
      "Validation Loss: 0.540579186545478, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 100.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 104, Loss: 0.40456665733030867\n",
      "Validation Loss: 0.5364116529623667, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 75.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 105, Loss: 0.402043488408838\n",
      "Validation Loss: 0.533881684144338, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 100.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 106, Loss: 0.40237137355974745\n",
      "Validation Loss: 0.5258309543132782, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 100.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 107, Loss: 0.3972819873264858\n",
      "Validation Loss: 0.5280153751373291, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 75.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 108, Loss: 0.39286775035517557\n",
      "Validation Loss: 0.5281883875528971, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 75.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 109, Loss: 0.4033367389014789\n",
      "Validation Loss: 0.5341129071182675, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 100.00%, G2: 12.50%, G3: 0.00%\n",
      "Epoch 110, Loss: 0.3992652988859585\n",
      "Validation Loss: 0.5239299833774567, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 111, Loss: 0.39731002918311525\n",
      "Validation Loss: 0.5168721576531728, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 75.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 112, Loss: 0.39070936505283627\n",
      "Validation Loss: 0.5306390821933746, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 100.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 113, Loss: 0.3802486764533179\n",
      "Validation Loss: 0.5310478607813517, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 75.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 114, Loss: 0.3858379359756197\n",
      "Validation Loss: 0.5234375033113692, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 75.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 115, Loss: 0.39945037343672346\n",
      "Validation Loss: 0.5199068784713745, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 116, Loss: 0.39080878772905897\n",
      "Validation Loss: 0.5271950993272994, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 75.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 117, Loss: 0.38660679331847597\n",
      "Validation Loss: 0.5214450558026632, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 75.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 118, Loss: 0.37324122871671406\n",
      "Validation Loss: 0.529492136504915, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 119, Loss: 0.38782864809036255\n",
      "Validation Loss: 0.5207782404290305, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 120, Loss: 0.37572190910577774\n",
      "Validation Loss: 0.5206924842463599, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 75.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 121, Loss: 0.3855703143136842\n",
      "Validation Loss: 0.5250491003195444, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 100.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 122, Loss: 0.3748121054044792\n",
      "Validation Loss: 0.5241190923584832, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 123, Loss: 0.37978573249919073\n",
      "Validation Loss: 0.5237666898303561, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 124, Loss: 0.38596832539354053\n",
      "Validation Loss: 0.5246512591838837, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 125, Loss: 0.3727176444871085\n",
      "Validation Loss: 0.5200667017036014, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 75.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 126, Loss: 0.3844084973846163\n",
      "Validation Loss: 0.5100845148166021, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 127, Loss: 0.3903634803635733\n",
      "Validation Loss: 0.5303583840529124, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 128, Loss: 0.3625280665499823\n",
      "Validation Loss: 0.5183882017930349, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 129, Loss: 0.3755355498620442\n",
      "Validation Loss: 0.5202492359611723, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 130, Loss: 0.37717124447226524\n",
      "Validation Loss: 0.5230081975460052, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 131, Loss: 0.3615300218973841\n",
      "Validation Loss: 0.5271225869655609, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 132, Loss: 0.3773141865219389\n",
      "Validation Loss: 0.5160911447472043, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 133, Loss: 0.3659813978842327\n",
      "Validation Loss: 0.5170581705040402, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 75.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 134, Loss: 0.3700459141816412\n",
      "Validation Loss: 0.5211771395471361, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 100.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 135, Loss: 0.3529173455068043\n",
      "Validation Loss: 0.527416318655014, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 50.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 136, Loss: 0.3751659792448793\n",
      "Validation Loss: 0.5209622813595666, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 75.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 137, Loss: 0.37053931930235456\n",
      "Validation Loss: 0.5115349557664659, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 138, Loss: 0.3647516242095402\n",
      "Validation Loss: 0.5144087192085054, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 139, Loss: 0.36594473144837786\n",
      "Validation Loss: 0.5244027972221375, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 140, Loss: 0.37431794458201956\n",
      "Validation Loss: 0.5217794742849138, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 141, Loss: 0.35947306879929136\n",
      "Validation Loss: 0.5209499663776822, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 50.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 142, Loss: 0.35377450925963266\n",
      "Validation Loss: 0.5379996763335334, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 50.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 143, Loss: 0.3516913333109447\n",
      "Validation Loss: 0.5170523093806373, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 144, Loss: 0.3760485053062439\n",
      "Validation Loss: 0.5156623986032274, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 145, Loss: 0.34843251215560095\n",
      "Validation Loss: 0.5263969136608971, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 146, Loss: 0.359764999044793\n",
      "Validation Loss: 0.5146473695834478, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 50.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 147, Loss: 0.34928026476076673\n",
      "Validation Loss: 0.5247369176811643, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 100.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 148, Loss: 0.35191067095313755\n",
      "Validation Loss: 0.5186216831207275, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 50.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 149, Loss: 0.3578494446618216\n",
      "Validation Loss: 0.515409873591529, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 150, Loss: 0.35533623290913446\n",
      "Validation Loss: 0.5099922219912211, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 75.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 151, Loss: 0.3403089770248958\n",
      "Validation Loss: 0.5015431874328189, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 152, Loss: 0.35267961929951397\n",
      "Validation Loss: 0.5110173357857598, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 153, Loss: 0.35276373316134724\n",
      "Validation Loss: 0.5203367173671722, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 75.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 154, Loss: 0.349170446395874\n",
      "Validation Loss: 0.5253502428531647, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 155, Loss: 0.3471814032111849\n",
      "Validation Loss: 0.5102872418032752, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 156, Loss: 0.3479168324598244\n",
      "Validation Loss: 0.5167751097016864, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 157, Loss: 0.35940380447677206\n",
      "Validation Loss: 0.5242208739121755, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 100.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 158, Loss: 0.35798373392650057\n",
      "Validation Loss: 0.5103708174493577, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 159, Loss: 0.3693063259124756\n",
      "Validation Loss: 0.5089689923657311, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 160, Loss: 0.3534799356545721\n",
      "Validation Loss: 0.5078588061862521, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 161, Loss: 0.35307931154966354\n",
      "Validation Loss: 0.5237083666854434, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 162, Loss: 0.36188468283840586\n",
      "Validation Loss: 0.5134281929996278, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 163, Loss: 0.339631945426975\n",
      "Validation Loss: 0.5029713114102682, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 164, Loss: 0.35016936383077074\n",
      "Validation Loss: 0.5163773165808784, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 165, Loss: 0.3415790375854288\n",
      "Validation Loss: 0.5077024334006839, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 166, Loss: 0.3646772067461695\n",
      "Validation Loss: 0.5243659582402971, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 75.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 167, Loss: 0.3385073872549193\n",
      "Validation Loss: 0.5194979707400004, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 50.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 168, Loss: 0.3461084057177816\n",
      "Validation Loss: 0.5088674359851413, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 169, Loss: 0.3562982885965279\n",
      "Validation Loss: 0.5096915927198198, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 50.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 170, Loss: 0.35208316892385483\n",
      "Validation Loss: 0.5080269045299954, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 171, Loss: 0.34554475599101614\n",
      "Validation Loss: 0.5080776347054375, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 172, Loss: 0.34466399092759403\n",
      "Validation Loss: 0.5172238316800859, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 50.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 173, Loss: 0.3491690478154591\n",
      "Validation Loss: 0.5034757951895396, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 174, Loss: 0.3508950950843947\n",
      "Validation Loss: 0.5214599205387963, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 175, Loss: 0.3562271424702236\n",
      "Validation Loss: 0.5138245986567603, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 75.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 176, Loss: 0.349409175238439\n",
      "Validation Loss: 0.5195387966103024, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 177, Loss: 0.35319453318204197\n",
      "Validation Loss: 0.5126891434192657, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 178, Loss: 0.3526709420340402\n",
      "Validation Loss: 0.5099455316861471, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 50.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 179, Loss: 0.35696048608848024\n",
      "Validation Loss: 0.5177171727021536, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 180, Loss: 0.34285407247287886\n",
      "Validation Loss: 0.513595011499193, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 181, Loss: 0.35839739228997913\n",
      "Validation Loss: 0.5099159114890628, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 182, Loss: 0.35087424729551586\n",
      "Validation Loss: 0.5122261279159122, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 183, Loss: 0.340246141489063\n",
      "Validation Loss: 0.521657708618376, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 100.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 184, Loss: 0.3487634137272835\n",
      "Validation Loss: 0.5139989852905273, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 185, Loss: 0.34562561554568155\n",
      "Validation Loss: 0.5114246441258324, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 186, Loss: 0.34547863794224604\n",
      "Validation Loss: 0.5226774083243476, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 187, Loss: 0.34418595529028345\n",
      "Validation Loss: 0.5135859549045563, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 75.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 188, Loss: 0.3518306336232594\n",
      "Validation Loss: 0.5107430037524965, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 189, Loss: 0.34193472989967894\n",
      "Validation Loss: 0.5068719883759817, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 190, Loss: 0.35458420642784666\n",
      "Validation Loss: 0.5101108186774783, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 191, Loss: 0.34268596821597647\n",
      "Validation Loss: 0.5039756960339017, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 75.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 192, Loss: 0.33936742533530506\n",
      "Validation Loss: 0.5059094991948869, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 193, Loss: 0.34547019217695507\n",
      "Validation Loss: 0.5100579261779785, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 194, Loss: 0.3371849554990019\n",
      "Validation Loss: 0.5018125176429749, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 195, Loss: 0.3712692910007068\n",
      "Validation Loss: 0.5039976272318099, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 196, Loss: 0.34902394988707136\n",
      "Validation Loss: 0.5124810172451867, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 197, Loss: 0.3563108332455158\n",
      "Validation Loss: 0.5101939373546176, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 198, Loss: 0.3373469023832253\n",
      "Validation Loss: 0.5065005156728957, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 199, Loss: 0.34200948157480787\n",
      "Validation Loss: 0.5194306257698271, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 200, Loss: 0.3492785096168518\n",
      "Validation Loss: 0.5087360077434115, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 201, Loss: 0.34414152268852505\n",
      "Validation Loss: 0.5199872569905387, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 202, Loss: 0.3589248593364443\n",
      "Validation Loss: 0.5159974495569865, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 203, Loss: 0.3415678670363767\n",
      "Validation Loss: 0.5266906585958269, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 50.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 204, Loss: 0.35200529119798113\n",
      "Validation Loss: 0.5198940320147408, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 205, Loss: 0.3351959799017225\n",
      "Validation Loss: 0.5153809421592288, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 206, Loss: 0.3374105452426842\n",
      "Validation Loss: 0.5105636682775285, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 207, Loss: 0.350975228207452\n",
      "Validation Loss: 0.5123529566658868, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 208, Loss: 0.3551582082041672\n",
      "Validation Loss: 0.5102413379483752, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 209, Loss: 0.3448667435773781\n",
      "Validation Loss: 0.5093923542234633, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 210, Loss: 0.3520107391689505\n",
      "Validation Loss: 0.5131758087211185, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 50.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 211, Loss: 0.357682571879455\n",
      "Validation Loss: 0.5105752083990309, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 212, Loss: 0.3669416111494814\n",
      "Validation Loss: 0.5149423612488641, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 213, Loss: 0.34985892687525066\n",
      "Validation Loss: 0.5225297609965006, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 214, Loss: 0.33081982657313347\n",
      "Validation Loss: 0.516399160027504, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 215, Loss: 0.3324792246733393\n",
      "Validation Loss: 0.5038441866636276, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 216, Loss: 0.3413959358419691\n",
      "Validation Loss: 0.5150913331243727, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 75.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 217, Loss: 0.3356714802128928\n",
      "Validation Loss: 0.5138333472940657, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 218, Loss: 0.38044787517615725\n",
      "Validation Loss: 0.5116810467508104, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 219, Loss: 0.3395634831062385\n",
      "Validation Loss: 0.5195185724231932, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 50.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 220, Loss: 0.32964219844767023\n",
      "Validation Loss: 0.5249218973848555, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 221, Loss: 0.336674092071397\n",
      "Validation Loss: 0.5206257071759965, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 222, Loss: 0.3686615324446133\n",
      "Validation Loss: 0.5236864884694418, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 50.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 223, Loss: 0.36001749336719513\n",
      "Validation Loss: 0.5263413389523824, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 75.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 224, Loss: 0.3474840926272528\n",
      "Validation Loss: 0.5085299346182082, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 50.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 225, Loss: 0.34678558153765543\n",
      "Validation Loss: 0.5201029264264636, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 226, Loss: 0.34729597717523575\n",
      "Validation Loss: 0.5128249343898561, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 50.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 227, Loss: 0.3446484793509756\n",
      "Validation Loss: 0.5023296905888451, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 228, Loss: 0.34915019092815264\n",
      "Validation Loss: 0.5173841449949477, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 229, Loss: 0.3497132807970047\n",
      "Validation Loss: 0.5274026476674609, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 230, Loss: 0.34025117861373083\n",
      "Validation Loss: 0.5146611581246058, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 231, Loss: 0.3482169806957245\n",
      "Validation Loss: 0.5228219992584653, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 232, Loss: 0.34915399870702196\n",
      "Validation Loss: 0.5206353465716044, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 233, Loss: 0.33886723858969553\n",
      "Validation Loss: 0.524013853735394, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 234, Loss: 0.34009978388037\n",
      "Validation Loss: 0.5082128428750567, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 235, Loss: 0.35091292538813185\n",
      "Validation Loss: 0.5009856588310666, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 50.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 236, Loss: 0.3409882869039263\n",
      "Validation Loss: 0.5167285104592642, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 237, Loss: 0.349513977766037\n",
      "Validation Loss: 0.5314620518022113, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 100.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 238, Loss: 0.345711886882782\n",
      "Validation Loss: 0.5049758752187093, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 239, Loss: 0.3452760194029127\n",
      "Validation Loss: 0.5151976048946381, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 240, Loss: 0.35933154076337814\n",
      "Validation Loss: 0.5138344433572557, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 241, Loss: 0.3473247215151787\n",
      "Validation Loss: 0.506966405444675, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 242, Loss: 0.34539324045181274\n",
      "Validation Loss: 0.5307668364710278, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 243, Loss: 0.34248049184679985\n",
      "Validation Loss: 0.5103497637642754, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 244, Loss: 0.3368318575833525\n",
      "Validation Loss: 0.5167948818869061, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 245, Loss: 0.33747761962669237\n",
      "Validation Loss: 0.5091642108228471, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 246, Loss: 0.3547884752707822\n",
      "Validation Loss: 0.5199895434909396, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 247, Loss: 0.3413541960929121\n",
      "Validation Loss: 0.5135203136338128, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 248, Loss: 0.3401096367410251\n",
      "Validation Loss: 0.5149784253703223, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 249, Loss: 0.3313679237450872\n",
      "Validation Loss: 0.4974336177110672, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 50.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 250, Loss: 0.33996780855315073\n",
      "Validation Loss: 0.5067823777596155, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 251, Loss: 0.3448250096823488\n",
      "Validation Loss: 0.5178766383065118, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 252, Loss: 0.34250964703304426\n",
      "Validation Loss: 0.5167915324370066, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 253, Loss: 0.3440678795533521\n",
      "Validation Loss: 0.5003275805049472, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 50.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 254, Loss: 0.3531813094658511\n",
      "Validation Loss: 0.5071497427092658, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 255, Loss: 0.3276781216263771\n",
      "Validation Loss: 0.5097001178397073, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 50.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 256, Loss: 0.3486637957394123\n",
      "Validation Loss: 0.5180608563952975, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 257, Loss: 0.33536413844142643\n",
      "Validation Loss: 0.5136876040034823, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 258, Loss: 0.33242578378745485\n",
      "Validation Loss: 0.5109989560312695, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 50.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 259, Loss: 0.33381654268928934\n",
      "Validation Loss: 0.5102219929297765, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 50.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 260, Loss: 0.3460234967725618\n",
      "Validation Loss: 0.5102537605497572, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 261, Loss: 0.3425693815307958\n",
      "Validation Loss: 0.5143130421638489, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 262, Loss: 0.3470619592283453\n",
      "Validation Loss: 0.5053877333799998, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 263, Loss: 0.3484081578041826\n",
      "Validation Loss: 0.5124555180470148, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 264, Loss: 0.33554463354604586\n",
      "Validation Loss: 0.5139477286073897, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 265, Loss: 0.3489693967359407\n",
      "Validation Loss: 0.5146305859088898, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 266, Loss: 0.3462785727211407\n",
      "Validation Loss: 0.5124902808003955, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 267, Loss: 0.3452333664255483\n",
      "Validation Loss: 0.5050237245029874, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 268, Loss: 0.3495996764728001\n",
      "Validation Loss: 0.5169892940256331, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 269, Loss: 0.3351720821644579\n",
      "Validation Loss: 0.5234124395582411, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 270, Loss: 0.342864205794675\n",
      "Validation Loss: 0.514163977570004, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 271, Loss: 0.34091205788510187\n",
      "Validation Loss: 0.5031529234515296, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 272, Loss: 0.34446006800447193\n",
      "Validation Loss: 0.5152359108130137, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 273, Loss: 0.34323831860508236\n",
      "Validation Loss: 0.5088553097512987, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 274, Loss: 0.32763815351894926\n",
      "Validation Loss: 0.5117705977625318, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 275, Loss: 0.3403242751955986\n",
      "Validation Loss: 0.511138336526023, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 276, Loss: 0.36608326115778517\n",
      "Validation Loss: 0.5207613690031899, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 277, Loss: 0.33522904557841166\n",
      "Validation Loss: 0.5097430646419525, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 278, Loss: 0.3503233093236174\n",
      "Validation Loss: 0.5106063087781271, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 50.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 279, Loss: 0.33263557297842844\n",
      "Validation Loss: 0.5161389509836832, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 280, Loss: 0.34236143050449236\n",
      "Validation Loss: 0.5237042274740007, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 50.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 281, Loss: 0.33259641591991695\n",
      "Validation Loss: 0.5172250237729814, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 282, Loss: 0.3384660870901176\n",
      "Validation Loss: 0.5185789465904236, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 50.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 283, Loss: 0.33263587206602097\n",
      "Validation Loss: 0.5232501460446252, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 284, Loss: 0.3282148928514549\n",
      "Validation Loss: 0.5153880582915412, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 285, Loss: 0.36197790929249357\n",
      "Validation Loss: 0.5134795672363706, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 50.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 286, Loss: 0.34332000091671944\n",
      "Validation Loss: 0.5078166060977511, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 287, Loss: 0.3332575650087425\n",
      "Validation Loss: 0.5075279639826881, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 288, Loss: 0.34289890101977755\n",
      "Validation Loss: 0.5003968063328001, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 289, Loss: 0.356027752161026\n",
      "Validation Loss: 0.5126153462462955, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 290, Loss: 0.3388227378683431\n",
      "Validation Loss: 0.5059134397241805, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 291, Loss: 0.3452817606074469\n",
      "Validation Loss: 0.5148051066531075, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 292, Loss: 0.3299338902745928\n",
      "Validation Loss: 0.509864373339547, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 50.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 293, Loss: 0.34938837907144\n",
      "Validation Loss: 0.5085279742876688, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 50.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 294, Loss: 0.3520908983690398\n",
      "Validation Loss: 0.5202424559328291, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 295, Loss: 0.33558286832911627\n",
      "Validation Loss: 0.5133093827300601, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 296, Loss: 0.3487811120493071\n",
      "Validation Loss: 0.5157728857464261, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 297, Loss: 0.3395023675901549\n",
      "Validation Loss: 0.516117619143592, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 25.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 298, Loss: 0.3458680883049965\n",
      "Validation Loss: 0.5002534422609541, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 299, Loss: 0.3405166231095791\n",
      "Validation Loss: 0.515485919184155, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 300, Loss: 0.3473230398127011\n",
      "Validation Loss: 0.5211829940478007, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 301, Loss: 0.35337828365819796\n",
      "Validation Loss: 0.5104608949687746, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 302, Loss: 0.335408906851496\n",
      "Validation Loss: 0.5048039058844248, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 303, Loss: 0.35239342014704433\n",
      "Validation Loss: 0.5117378135522207, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 50.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 304, Loss: 0.34569326788187027\n",
      "Validation Loss: 0.508457769950231, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 305, Loss: 0.34068668846573147\n",
      "Validation Loss: 0.5031010922458437, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 306, Loss: 0.33286606999380247\n",
      "Validation Loss: 0.5035693943500519, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 50.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 307, Loss: 0.3367620546902929\n",
      "Validation Loss: 0.5189182344410155, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 308, Loss: 0.33975256979465485\n",
      "Validation Loss: 0.5065562129020691, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 50.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 309, Loss: 0.33521716403109686\n",
      "Validation Loss: 0.5181165635585785, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 310, Loss: 0.33383358057056156\n",
      "Validation Loss: 0.5034557117356194, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 311, Loss: 0.347039449427809\n",
      "Validation Loss: 0.5023412472671933, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 50.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 312, Loss: 0.33870624591197285\n",
      "Validation Loss: 0.522307985358768, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 313, Loss: 0.3421695413334029\n",
      "Validation Loss: 0.5039134158028497, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 50.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 314, Loss: 0.3313397839665413\n",
      "Validation Loss: 0.5016103287537893, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 315, Loss: 0.3538671370063509\n",
      "Validation Loss: 0.50902216302024, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 316, Loss: 0.32542514375277926\n",
      "Validation Loss: 0.5065981563594606, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 317, Loss: 0.33697635254689623\n",
      "Validation Loss: 0.5108213656478457, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 50.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 318, Loss: 0.3202610564018999\n",
      "Validation Loss: 0.5051698916488223, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 319, Loss: 0.33937017885702\n",
      "Validation Loss: 0.515770263142056, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 320, Loss: 0.3251835320677076\n",
      "Validation Loss: 0.5178856154282888, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 50.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 321, Loss: 0.33874581807426046\n",
      "Validation Loss: 0.5070619980494181, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 322, Loss: 0.34258746621864183\n",
      "Validation Loss: 0.5138000051180521, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 323, Loss: 0.332564431641783\n",
      "Validation Loss: 0.499789211485121, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 50.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 324, Loss: 0.3283666877874306\n",
      "Validation Loss: 0.508699271414015, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 325, Loss: 0.3371187618800572\n",
      "Validation Loss: 0.5147370298703512, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 326, Loss: 0.33607855652059826\n",
      "Validation Loss: 0.5192326307296753, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 327, Loss: 0.3580211821411337\n",
      "Validation Loss: 0.5166730185349783, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 328, Loss: 0.35290251672267914\n",
      "Validation Loss: 0.5080217172702154, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 50.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 329, Loss: 0.35424620817814556\n",
      "Validation Loss: 0.5123389926221635, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 100.00%, G2: 25.00%, G3: 0.00%\n",
      "Epoch 330, Loss: 0.352308452129364\n",
      "Validation Loss: 0.5098964075247446, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 50.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 331, Loss: 0.32574328194771496\n",
      "Validation Loss: 0.5094430148601532, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 50.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 332, Loss: 0.3250714423401015\n",
      "Validation Loss: 0.5194566117392646, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 333, Loss: 0.356912444212607\n",
      "Validation Loss: 0.5124665647745132, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 100.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 334, Loss: 0.33650533695306095\n",
      "Validation Loss: 0.5174236198266348, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 335, Loss: 0.3311605267226696\n",
      "Validation Loss: 0.504432694779502, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 336, Loss: 0.3433932512998581\n",
      "Validation Loss: 0.5080440739790598, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 337, Loss: 0.3354975400226457\n",
      "Validation Loss: 0.5123717983563741, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 338, Loss: 0.33266126098377363\n",
      "Validation Loss: 0.5188521759377586, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 339, Loss: 0.3294219342725618\n",
      "Validation Loss: 0.5080088194873598, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 340, Loss: 0.342224552163056\n",
      "Validation Loss: 0.5112462374899123, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 341, Loss: 0.32758179200547083\n",
      "Validation Loss: 0.5139813986089494, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 342, Loss: 0.3456834448235376\n",
      "Validation Loss: 0.5198975933922662, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 343, Loss: 0.3417063073388168\n",
      "Validation Loss: 0.5198253823651208, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 344, Loss: 0.3568834050425461\n",
      "Validation Loss: 0.5073795384830899, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 50.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 345, Loss: 0.33125558282647816\n",
      "Validation Loss: 0.5066226886378394, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 346, Loss: 0.3365703427365848\n",
      "Validation Loss: 0.4991150101025899, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 347, Loss: 0.3696543856390885\n",
      "Validation Loss: 0.5118824342886606, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 348, Loss: 0.34208506026438307\n",
      "Validation Loss: 0.5056061562564638, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 349, Loss: 0.3490398164306368\n",
      "Validation Loss: 0.5150193323691686, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 350, Loss: 0.3476260746163981\n",
      "Validation Loss: 0.5087314281198714, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 351, Loss: 0.34271737720285145\n",
      "Validation Loss: 0.5056150803963343, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 352, Loss: 0.34227452693240984\n",
      "Validation Loss: 0.5129005048010085, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 50.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 353, Loss: 0.3388144299387932\n",
      "Validation Loss: 0.5122873220178816, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 354, Loss: 0.3348796990300928\n",
      "Validation Loss: 0.5075398948457506, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 355, Loss: 0.33885233689631733\n",
      "Validation Loss: 0.5040038790967729, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 75.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 356, Loss: 0.3284945259136813\n",
      "Validation Loss: 0.5078815917174021, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 357, Loss: 0.33731979238135473\n",
      "Validation Loss: 0.5079538971185684, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 358, Loss: 0.3355383596249989\n",
      "Validation Loss: 0.5152787433730232, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 359, Loss: 0.34699980169534683\n",
      "Validation Loss: 0.5136792461077372, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 360, Loss: 0.3363752918584006\n",
      "Validation Loss: 0.5194943249225616, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 361, Loss: 0.3250199838408402\n",
      "Validation Loss: 0.5203806592358483, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 50.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 362, Loss: 0.3407849445939064\n",
      "Validation Loss: 0.5257658064365387, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 363, Loss: 0.35072729523692814\n",
      "Validation Loss: 0.5112905336750878, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 364, Loss: 0.3300268091261387\n",
      "Validation Loss: 0.5110119349426694, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 365, Loss: 0.3530339529471738\n",
      "Validation Loss: 0.5031516204277674, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 50.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 366, Loss: 0.32582215326172964\n",
      "Validation Loss: 0.5041029685073428, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 367, Loss: 0.330200835530247\n",
      "Validation Loss: 0.5094538281361262, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 368, Loss: 0.32215255073138643\n",
      "Validation Loss: 0.5073534962203767, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 369, Loss: 0.33464314735361506\n",
      "Validation Loss: 0.5080925722916921, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 370, Loss: 0.3322051518729755\n",
      "Validation Loss: 0.5157425966527727, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 371, Loss: 0.3378735865865435\n",
      "Validation Loss: 0.5066429641511705, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 372, Loss: 0.33181134558149744\n",
      "Validation Loss: 0.5147072209252251, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 373, Loss: 0.3401583486369678\n",
      "Validation Loss: 0.5230897102091048, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 25.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 374, Loss: 0.3347201661339828\n",
      "Validation Loss: 0.511618380745252, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 375, Loss: 0.3197747346545969\n",
      "Validation Loss: 0.5110594348775016, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 376, Loss: 0.34440849508558\n",
      "Validation Loss: 0.5133675038814545, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 377, Loss: 0.3286254198423454\n",
      "Validation Loss: 0.49490246176719666, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 25.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 378, Loss: 0.3415074183472565\n",
      "Validation Loss: 0.5025786525673337, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 50.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 379, Loss: 0.34511389849441393\n",
      "Validation Loss: 0.5172320504983267, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 380, Loss: 0.33015763759613037\n",
      "Validation Loss: 0.5070731076929305, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 381, Loss: 0.349068570882082\n",
      "Validation Loss: 0.5043317576249441, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 382, Loss: 0.3393805053617273\n",
      "Validation Loss: 0.5132056905163659, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 383, Loss: 0.3323906489780971\n",
      "Validation Loss: 0.50513899160756, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 384, Loss: 0.33376152919871466\n",
      "Validation Loss: 0.5090267790688409, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 385, Loss: 0.33667384726660593\n",
      "Validation Loss: 0.5144311520788405, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 386, Loss: 0.3362032191029617\n",
      "Validation Loss: 0.5207491053475274, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 25.00%, G2: 50.00%, G3: 0.00%\n",
      "Epoch 387, Loss: 0.32939530483313967\n",
      "Validation Loss: 0.5098169065184064, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 388, Loss: 0.3350631131657532\n",
      "Validation Loss: 0.5023069497611787, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 389, Loss: 0.3349830045231751\n",
      "Validation Loss: 0.5058771189716127, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 390, Loss: 0.3190427135143961\n",
      "Validation Loss: 0.5148255477348963, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 391, Loss: 0.34266756794282366\n",
      "Validation Loss: 0.5100599461131625, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 392, Loss: 0.33804719362940105\n",
      "Validation Loss: 0.5123832325140635, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 393, Loss: 0.34927995023982866\n",
      "Validation Loss: 0.5170840058061812, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 394, Loss: 0.3378255840923105\n",
      "Validation Loss: 0.5237865414884355, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 100.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 395, Loss: 0.3259526379406452\n",
      "Validation Loss: 0.5188646448983086, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 396, Loss: 0.33553164079785347\n",
      "Validation Loss: 0.5122789641221365, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 397, Loss: 0.33264634598578724\n",
      "Validation Loss: 0.5063869406779608, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 398, Loss: 0.3335623512310641\n",
      "Validation Loss: 0.5047214643822776, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 399, Loss: 0.32864500262907576\n",
      "Validation Loss: 0.5061815513504876, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n",
      "Epoch 400, Loss: 0.33279433101415634\n",
      "Validation Loss: 0.5178572171264224, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 50.00%, G2: 37.50%, G3: 0.00%\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\u001b[34m\u001b[1mwandb\u001b[0m:                                                                                \n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: \n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: Run history:\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:          G1_Acc ‚ñÜ‚ñÜ‚ñà‚ñà‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñà‚ñÜ‚ñà‚ñÉ‚ñÉ‚ñÜ‚ñÜ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÜ‚ñÅ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÅ‚ñÉ‚ñÉ‚ñÉ\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:     G1_TrainAcc ‚ñÜ‚ñà‚ñÜ‚ñÜ‚ñà‚ñÜ‚ñà‚ñÉ‚ñÜ‚ñÜ‚ñÜ‚ñà‚ñà‚ñà‚ñÜ‚ñÉ‚ñà‚ñà‚ñÜ‚ñÜ‚ñà‚ñÉ‚ñÜ‚ñÅ‚ñÜ‚ñÜ‚ñÜ‚ñÅ‚ñÜ‚ñÉ‚ñà‚ñÉ‚ñÜ‚ñÜ‚ñÉ‚ñÉ‚ñÜ‚ñÅ‚ñÉ‚ñÉ\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:          G2_Acc ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÉ‚ñÉ‚ñÉ‚ñÉ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñà‚ñÜ‚ñÜ‚ñà‚ñÜ‚ñÜ‚ñà‚ñÜ‚ñÜ‚ñÜ\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:     G2_TrainAcc ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÉ‚ñÖ‚ñÖ‚ñÑ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà‚ñá‚ñá‚ñá‚ñà‚ñá‚ñà‚ñá‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñá‚ñà‚ñá‚ñà‚ñà‚ñá‚ñà‚ñà\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:          G3_Acc ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:     G3_TrainAcc ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÑ‚ñÉ‚ñÖ‚ñá‚ñÖ‚ñá‚ñá‚ñÜ‚ñÜ‚ñá‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñÜ‚ñá‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñÜ‚ñá‚ñà‚ñá‚ñà‚ñÜ‚ñá‚ñÜ‚ñÖ\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:  Total Accuracy ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÉ‚ñÉ‚ñÉ‚ñÜ‚ñÖ‚ñÉ‚ñÜ‚ñÜ‚ñà‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÖ‚ñÖ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÖ‚ñÖ‚ñÜ‚ñÖ‚ñÖ‚ñÖ‚ñÖ\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:  Train Accuracy ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÑ‚ñÖ‚ñÖ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñá‚ñà‚ñà‚ñà‚ñá‚ñá‚ñá‚ñà‚ñà‚ñá‚ñà‚ñá‚ñà‚ñà‚ñà‚ñá‚ñà‚ñá‚ñà‚ñá‚ñá‚ñà‚ñà‚ñà‚ñà‚ñà\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:      Train loss ‚ñà‚ñá‚ñÜ‚ñÜ‚ñÜ‚ñÖ‚ñÑ‚ñÑ‚ñÑ‚ñÉ‚ñÉ‚ñÉ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÅ‚ñÇ\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: Validation Loss ‚ñÜ‚ñà‚ñà‚ñà‚ñá‚ñà‚ñÖ‚ñÜ‚ñÖ‚ñÖ‚ñÉ‚ñÑ‚ñÉ‚ñÇ‚ñÉ‚ñÇ‚ñÉ‚ñÅ‚ñÉ‚ñÇ‚ñÅ‚ñÇ‚ñÉ‚ñÑ‚ñÉ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÇ‚ñÇ‚ñÉ‚ñÅ‚ñÇ‚ñÇ‚ñÇ‚ñÅ‚ñÅ\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: \n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: Run summary:\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:          G1_Acc 50\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:     G1_TrainAcc 100\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:          G2_Acc 37.5\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:     G2_TrainAcc 93.40659\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:          G3_Acc 0\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:     G3_TrainAcc 43.24324\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:  Total Accuracy 27.77778\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:  Train Accuracy 80.57554\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:      Train loss 0.33279\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: Validation Loss 0.51786\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: \n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: üöÄ View run \u001b[33mResNet3D original best Focalloss\u001b[0m at: \u001b[34m\u001b[4mhttps://wandb.ai/pietro-caforio-politecnico-di-milano/3Dunimodal_ct_training/runs/plhqdwcn\u001b[0m\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: ‚≠êÔ∏è View project at: \u001b[34m\u001b[4mhttps://wandb.ai/pietro-caforio-politecnico-di-milano/3Dunimodal_ct_training\u001b[0m\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: Find logs at: \u001b[35m\u001b[1m./wandb/run-20241012_102703-plhqdwcn/logs\u001b[0m\n"
     ]
    }
   ],
   "source": [
    "from focal_loss.focal_loss import FocalLoss\n",
    "config={\n",
    "    \"learning_rate\": 1e-7,\n",
    "    \"architecture\": \"ResNet3D original best Focalloss\",\n",
    "    \"epochs\": 400,\n",
    "    \"weight_decay\": 1e-5,\n",
    "    \"reduce_lr_factor\": 0.25,\n",
    "    \"patience\": 40,\n",
    "    \"class_weights\": None,\n",
    "    \"early_stop_patience\": None,\n",
    "    \"focal_loss\": 2\n",
    "    }\n",
    "train(model, config, run_name = config[\"architecture\"])"
   ]
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "gpu",
   "dataSources": [
    {
     "datasetId": 5664308,
     "sourceId": 9547833,
     "sourceType": "datasetVersion"
    }
   ],
   "dockerImageVersionId": 30787,
   "isGpuEnabled": true,
   "isInternetEnabled": true,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.14"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 20776.881236,
   "end_time": "2024-10-12T16:12:19.234267",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2024-10-12T10:26:02.353031",
   "version": "2.6.0"
  },
  "widgets": {
   "application/vnd.jupyter.widget-state+json": {
    "state": {
     "0f74e50d11824c589594423e545fb4fd": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.5.0",
      "model_name": "DescriptionStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "1.5.0",
       "_model_name": "DescriptionStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "1.2.0",
       "_view_name": "StyleView",
       "description_width": ""
      }
     },
     "143ad20d35434be89f39cdac70e0081d": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.5.0",
      "model_name": "DescriptionStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "1.5.0",
       "_model_name": "DescriptionStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "1.2.0",
       "_view_name": "StyleView",
       "description_width": ""
      }
     },
     "148dbfbb28564c9392b3e506f8ad78d6": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.5.0",
      "model_name": "HBoxModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "1.5.0",
       "_model_name": "HBoxModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "1.5.0",
       "_view_name": "HBoxView",
       "box_style": "",
       "children": [
        "IPY_MODEL_6a4a435278744922ba00185fa0628e06",
        "IPY_MODEL_a290bba08f9542f9bf35798535d390d9",
        "IPY_MODEL_4dc614faa4bd4cf9a688353619da2b0e"
       ],
       "layout": "IPY_MODEL_655f98d76beb4cfdbd790f0620af4fce"
      }
     },
     "19c4b812c58d4ab6bc3cd5d7bea9fdf8": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.2.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "1.2.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "1.2.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "overflow_x": null,
       "overflow_y": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "4dc614faa4bd4cf9a688353619da2b0e": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.5.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "1.5.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "1.5.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_tooltip": null,
       "layout": "IPY_MODEL_19c4b812c58d4ab6bc3cd5d7bea9fdf8",
       "placeholder": "‚Äã",
       "style": "IPY_MODEL_b13021f1f89f4786a7353648fc1a5884",
       "value": "‚Äá46.8M/46.8M‚Äá[00:03&lt;00:00,‚Äá15.1MB/s]"
      }
     },
     "5aabee46e73c4e1e949fe611f697add0": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.5.0",
      "model_name": "ProgressStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "1.5.0",
       "_model_name": "ProgressStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "1.2.0",
       "_view_name": "StyleView",
       "bar_color": null,
       "description_width": ""
      }
     },
     "5e578b3fcc5c437791b41c60ead2f373": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.2.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "1.2.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "1.2.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "overflow_x": null,
       "overflow_y": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "6213dd8318994913b79d296acfb123b7": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.5.0",
      "model_name": "FloatProgressModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "1.5.0",
       "_model_name": "FloatProgressModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "1.5.0",
       "_view_name": "ProgressView",
       "bar_style": "success",
       "description": "",
       "description_tooltip": null,
       "layout": "IPY_MODEL_5e578b3fcc5c437791b41c60ead2f373",
       "max": 69548,
       "min": 0,
       "orientation": "horizontal",
       "style": "IPY_MODEL_5aabee46e73c4e1e949fe611f697add0",
       "value": 69548
      }
     },
     "62de300bb21143b68602e94c74e3f39b": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.2.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "1.2.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "1.2.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "overflow_x": null,
       "overflow_y": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "655f98d76beb4cfdbd790f0620af4fce": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.2.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "1.2.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "1.2.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "overflow_x": null,
       "overflow_y": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "6a4a435278744922ba00185fa0628e06": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.5.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "1.5.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "1.5.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_tooltip": null,
       "layout": "IPY_MODEL_f1e9deee886e441990c8086b244101b2",
       "placeholder": "‚Äã",
       "style": "IPY_MODEL_143ad20d35434be89f39cdac70e0081d",
       "value": "model.safetensors:‚Äá100%"
      }
     },
     "70c0081ec8cf4159b2cd1184eae53b5d": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.2.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "1.2.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "1.2.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "overflow_x": null,
       "overflow_y": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "7dd733ad658b48359feb02f8c0436c62": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.2.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "1.2.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "1.2.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "overflow_x": null,
       "overflow_y": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "7f4be5cd22f64a6ebf8629388d9fe314": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.5.0",
      "model_name": "HBoxModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "1.5.0",
       "_model_name": "HBoxModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "1.5.0",
       "_view_name": "HBoxView",
       "box_style": "",
       "children": [
        "IPY_MODEL_f98e6a28a77b460aa5b9c367684afbf6",
        "IPY_MODEL_6213dd8318994913b79d296acfb123b7",
        "IPY_MODEL_97a6dfab7007407cac133d69ba3394c0"
       ],
       "layout": "IPY_MODEL_7fe107f7ec564556bbd41a700510e787"
      }
     },
     "7fe107f7ec564556bbd41a700510e787": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.2.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "1.2.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "1.2.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "overflow_x": null,
       "overflow_y": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "8c90ff6ae7f44ed1a6a8496e9269d845": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.5.0",
      "model_name": "ProgressStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "1.5.0",
       "_model_name": "ProgressStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "1.2.0",
       "_view_name": "StyleView",
       "bar_color": null,
       "description_width": ""
      }
     },
     "97a6dfab7007407cac133d69ba3394c0": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.5.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "1.5.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "1.5.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_tooltip": null,
       "layout": "IPY_MODEL_70c0081ec8cf4159b2cd1184eae53b5d",
       "placeholder": "‚Äã",
       "style": "IPY_MODEL_e7c6b1c1c6304d2ca4e35472b1f690b4",
       "value": "‚Äá69.5k/69.5k‚Äá[00:00&lt;00:00,‚Äá326kB/s]"
      }
     },
     "a290bba08f9542f9bf35798535d390d9": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.5.0",
      "model_name": "FloatProgressModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "1.5.0",
       "_model_name": "FloatProgressModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "1.5.0",
       "_view_name": "ProgressView",
       "bar_style": "success",
       "description": "",
       "description_tooltip": null,
       "layout": "IPY_MODEL_7dd733ad658b48359feb02f8c0436c62",
       "max": 46812324,
       "min": 0,
       "orientation": "horizontal",
       "style": "IPY_MODEL_8c90ff6ae7f44ed1a6a8496e9269d845",
       "value": 46812324
      }
     },
     "b13021f1f89f4786a7353648fc1a5884": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.5.0",
      "model_name": "DescriptionStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "1.5.0",
       "_model_name": "DescriptionStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "1.2.0",
       "_view_name": "StyleView",
       "description_width": ""
      }
     },
     "e7c6b1c1c6304d2ca4e35472b1f690b4": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.5.0",
      "model_name": "DescriptionStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "1.5.0",
       "_model_name": "DescriptionStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "1.2.0",
       "_view_name": "StyleView",
       "description_width": ""
      }
     },
     "f1e9deee886e441990c8086b244101b2": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.2.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "1.2.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "1.2.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "overflow_x": null,
       "overflow_y": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "f98e6a28a77b460aa5b9c367684afbf6": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.5.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "1.5.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "1.5.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_tooltip": null,
       "layout": "IPY_MODEL_62de300bb21143b68602e94c74e3f39b",
       "placeholder": "‚Äã",
       "style": "IPY_MODEL_0f74e50d11824c589594423e545fb4fd",
       "value": "config.json:‚Äá100%"
      }
     }
    },
    "version_major": 2,
    "version_minor": 0
   }
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
