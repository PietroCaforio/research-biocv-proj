{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "8d1a2881",
   "metadata": {
    "papermill": {
     "duration": 0.011379,
     "end_time": "2024-10-13T04:21:42.260338",
     "exception": false,
     "start_time": "2024-10-13T04:21:42.248959",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "<a href=\"https://www.kaggle.com/code/pietrocaforio/unimodal-ct-training-kaggle?scriptVersionId=197281783\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e9953e00",
   "metadata": {
    "papermill": {
     "duration": 0.011065,
     "end_time": "2024-10-13T04:21:42.281956",
     "exception": false,
     "start_time": "2024-10-13T04:21:42.270891",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Train 3D unimodal CT"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "c220a69b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-13T04:21:42.304524Z",
     "iopub.status.busy": "2024-10-13T04:21:42.304154Z",
     "iopub.status.idle": "2024-10-13T04:21:45.302758Z",
     "shell.execute_reply": "2024-10-13T04:21:45.301699Z"
    },
    "papermill": {
     "duration": 3.012757,
     "end_time": "2024-10-13T04:21:45.305153",
     "exception": false,
     "start_time": "2024-10-13T04:21:42.292396",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Cloning into 'research-biocv-proj'...\r\n",
      "remote: Enumerating objects: 489, done.\u001b[K\r\n",
      "remote: Counting objects: 100% (34/34), done.\u001b[K\r\n",
      "remote: Compressing objects: 100% (27/27), done.\u001b[K\r\n",
      "remote: Total 489 (delta 14), reused 21 (delta 7), pack-reused 455 (from 1)\u001b[K\r\n",
      "Receiving objects: 100% (489/489), 3.99 MiB | 22.82 MiB/s, done.\r\n",
      "Resolving deltas: 100% (294/294), done.\r\n",
      "Branch 'dev' set up to track remote branch 'dev' from 'origin'.\r\n",
      "Switched to a new branch 'dev'\r\n"
     ]
    }
   ],
   "source": [
    "!git clone https://github.com/PietroCaforio/research-biocv-proj\n",
    "!cd research-biocv-proj && git switch dev"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "02f7a208",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-13T04:21:45.331207Z",
     "iopub.status.busy": "2024-10-13T04:21:45.330537Z",
     "iopub.status.idle": "2024-10-13T04:21:46.638762Z",
     "shell.execute_reply": "2024-10-13T04:21:46.637571Z"
    },
    "papermill": {
     "duration": 1.324034,
     "end_time": "2024-10-13T04:21:46.641303",
     "exception": false,
     "start_time": "2024-10-13T04:21:45.317269",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Already up to date.\r\n"
     ]
    }
   ],
   "source": [
    "!cd research-biocv-proj && git pull"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "1e9378d9",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-13T04:21:46.665845Z",
     "iopub.status.busy": "2024-10-13T04:21:46.665446Z",
     "iopub.status.idle": "2024-10-13T04:21:59.198039Z",
     "shell.execute_reply": "2024-10-13T04:21:59.197079Z"
    },
    "papermill": {
     "duration": 12.547491,
     "end_time": "2024-10-13T04:21:59.200467",
     "exception": false,
     "start_time": "2024-10-13T04:21:46.652976",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Requirement already satisfied: wandb in /opt/conda/lib/python3.10/site-packages (0.18.3)\r\n",
      "Requirement already satisfied: click!=8.0.0,>=7.1 in /opt/conda/lib/python3.10/site-packages (from wandb) (8.1.7)\r\n",
      "Requirement already satisfied: docker-pycreds>=0.4.0 in /opt/conda/lib/python3.10/site-packages (from wandb) (0.4.0)\r\n",
      "Requirement already satisfied: gitpython!=3.1.29,>=1.0.0 in /opt/conda/lib/python3.10/site-packages (from wandb) (3.1.43)\r\n",
      "Requirement already satisfied: platformdirs in /opt/conda/lib/python3.10/site-packages (from wandb) (3.11.0)\r\n",
      "Requirement already satisfied: protobuf!=4.21.0,!=5.28.0,<6,>=3.19.0 in /opt/conda/lib/python3.10/site-packages (from wandb) (3.20.3)\r\n",
      "Requirement already satisfied: psutil>=5.0.0 in /opt/conda/lib/python3.10/site-packages (from wandb) (5.9.3)\r\n",
      "Requirement already satisfied: pyyaml in /opt/conda/lib/python3.10/site-packages (from wandb) (6.0.2)\r\n",
      "Requirement already satisfied: requests<3,>=2.0.0 in /opt/conda/lib/python3.10/site-packages (from wandb) (2.32.3)\r\n",
      "Requirement already satisfied: sentry-sdk>=1.0.0 in /opt/conda/lib/python3.10/site-packages (from wandb) (2.15.0)\r\n",
      "Requirement already satisfied: setproctitle in /opt/conda/lib/python3.10/site-packages (from wandb) (1.3.3)\r\n",
      "Requirement already satisfied: setuptools in /opt/conda/lib/python3.10/site-packages (from wandb) (70.0.0)\r\n",
      "Requirement already satisfied: six>=1.4.0 in /opt/conda/lib/python3.10/site-packages (from docker-pycreds>=0.4.0->wandb) (1.16.0)\r\n",
      "Requirement already satisfied: gitdb<5,>=4.0.1 in /opt/conda/lib/python3.10/site-packages (from gitpython!=3.1.29,>=1.0.0->wandb) (4.0.11)\r\n",
      "Requirement already satisfied: charset-normalizer<4,>=2 in /opt/conda/lib/python3.10/site-packages (from requests<3,>=2.0.0->wandb) (3.3.2)\r\n",
      "Requirement already satisfied: idna<4,>=2.5 in /opt/conda/lib/python3.10/site-packages (from requests<3,>=2.0.0->wandb) (3.7)\r\n",
      "Requirement already satisfied: urllib3<3,>=1.21.1 in /opt/conda/lib/python3.10/site-packages (from requests<3,>=2.0.0->wandb) (1.26.18)\r\n",
      "Requirement already satisfied: certifi>=2017.4.17 in /opt/conda/lib/python3.10/site-packages (from requests<3,>=2.0.0->wandb) (2024.8.30)\r\n",
      "Requirement already satisfied: smmap<6,>=3.0.1 in /opt/conda/lib/python3.10/site-packages (from gitdb<5,>=4.0.1->gitpython!=3.1.29,>=1.0.0->wandb) (5.0.1)\r\n"
     ]
    }
   ],
   "source": [
    "!pip install wandb"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "c3f1b990",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-13T04:21:59.226163Z",
     "iopub.status.busy": "2024-10-13T04:21:59.225778Z",
     "iopub.status.idle": "2024-10-13T04:21:59.431034Z",
     "shell.execute_reply": "2024-10-13T04:21:59.430289Z"
    },
    "papermill": {
     "duration": 0.220448,
     "end_time": "2024-10-13T04:21:59.433213",
     "exception": false,
     "start_time": "2024-10-13T04:21:59.212765",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "from kaggle_secrets import UserSecretsClient\n",
    "user_secrets = UserSecretsClient()\n",
    "secret_value_0 = user_secrets.get_secret(\"3d_wandb_key\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "d5b0c52e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-13T04:21:59.458087Z",
     "iopub.status.busy": "2024-10-13T04:21:59.457777Z",
     "iopub.status.idle": "2024-10-13T04:22:01.259162Z",
     "shell.execute_reply": "2024-10-13T04:22:01.258199Z"
    },
    "papermill": {
     "duration": 1.816352,
     "end_time": "2024-10-13T04:22:01.261525",
     "exception": false,
     "start_time": "2024-10-13T04:21:59.445173",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\u001b[34m\u001b[1mwandb\u001b[0m: Using wandb-core as the SDK backend. Please refer to https://wandb.me/wandb-core for more information.\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: W&B API key is configured. Use \u001b[1m`wandb login --relogin`\u001b[0m to force relogin\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: \u001b[33mWARNING\u001b[0m If you're specifying your api key in code, ensure this code is not shared publicly.\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: \u001b[33mWARNING\u001b[0m Consider setting the WANDB_API_KEY environment variable, or running `wandb login` from the command line.\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: Appending key for api.wandb.ai to your netrc file: /root/.netrc\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "True"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import wandb\n",
    "wandb.login(key=secret_value_0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "6cbeca20",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-13T04:22:01.289541Z",
     "iopub.status.busy": "2024-10-13T04:22:01.289078Z",
     "iopub.status.idle": "2024-10-13T04:22:05.450416Z",
     "shell.execute_reply": "2024-10-13T04:22:05.449608Z"
    },
    "papermill": {
     "duration": 4.177859,
     "end_time": "2024-10-13T04:22:05.452745",
     "exception": false,
     "start_time": "2024-10-13T04:22:01.274886",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "import sys\n",
    "from pathlib import Path\n",
    "\n",
    "# Add the 'data' directory to sys.path\n",
    "sys.path.append(str(Path('research-biocv-proj').resolve()))\n",
    "from data.unimodal3D import *\n",
    "from pathlib import Path\n",
    "\n",
    "import numpy as np\n",
    "import torch\n",
    "from torch.utils.data import DataLoader\n",
    "\n",
    "from sklearn.utils.class_weight import compute_class_weight"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ae720630",
   "metadata": {
    "papermill": {
     "duration": 0.012082,
     "end_time": "2024-10-13T04:22:05.477484",
     "exception": false,
     "start_time": "2024-10-13T04:22:05.465402",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "### Train ResNet model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "c29bba5d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-13T04:22:05.503048Z",
     "iopub.status.busy": "2024-10-13T04:22:05.502584Z",
     "iopub.status.idle": "2024-10-13T04:22:05.513309Z",
     "shell.execute_reply": "2024-10-13T04:22:05.512511Z"
    },
    "papermill": {
     "duration": 0.025627,
     "end_time": "2024-10-13T04:22:05.515083",
     "exception": false,
     "start_time": "2024-10-13T04:22:05.489456",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "class EarlyStopping:\n",
    "    \"\"\"Early stops the training if validation loss doesn't improve after a given patience.\"\"\"\n",
    "    def __init__(self, patience=7, verbose=False, delta=0, path='checkpoint.pt', trace_func=print):\n",
    "        \"\"\"\n",
    "        Args:\n",
    "            patience (int): How long to wait after last time validation loss improved.\n",
    "                            Default: 7\n",
    "            verbose (bool): If True, prints a message for each validation loss improvement. \n",
    "                            Default: False\n",
    "            delta (float): Minimum change in the monitored quantity to qualify as an improvement.\n",
    "                            Default: 0\n",
    "            path (str): Path for the checkpoint to be saved to.\n",
    "                            Default: 'checkpoint.pt'\n",
    "            trace_func (function): trace print function.\n",
    "                            Default: print            \n",
    "        \"\"\"\n",
    "        self.patience = patience\n",
    "        self.verbose = verbose\n",
    "        self.counter = 0\n",
    "        self.best_score = None\n",
    "        self.early_stop = False\n",
    "        self.val_loss_min = np.Inf\n",
    "        self.delta = delta\n",
    "        self.path = path\n",
    "        self.trace_func = trace_func\n",
    "    def __call__(self, val_loss, model):\n",
    "\n",
    "        score = -val_loss\n",
    "\n",
    "        if self.best_score is None:\n",
    "            self.best_score = score\n",
    "            self.save_checkpoint(val_loss, model)\n",
    "        elif score < self.best_score + self.delta:\n",
    "            self.counter += 1\n",
    "            self.trace_func(f'EarlyStopping counter: {self.counter} out of {self.patience}')\n",
    "            if self.counter >= self.patience:\n",
    "                self.early_stop = True\n",
    "        else:\n",
    "            self.best_score = score\n",
    "            self.save_checkpoint(val_loss, model)\n",
    "            self.counter = 0\n",
    "\n",
    "    def save_checkpoint(self, val_loss, model):\n",
    "        '''Saves model when validation loss decrease.'''\n",
    "        if self.verbose:\n",
    "            self.trace_func(f'Validation loss decreased ({self.val_loss_min:.6f} --> {val_loss:.6f}).  Saving model ...')\n",
    "        torch.save(model.state_dict(), self.path)\n",
    "        self.val_loss_min = val_loss"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "dc42723d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-13T04:22:05.540752Z",
     "iopub.status.busy": "2024-10-13T04:22:05.540464Z",
     "iopub.status.idle": "2024-10-13T04:22:05.564104Z",
     "shell.execute_reply": "2024-10-13T04:22:05.563336Z"
    },
    "papermill": {
     "duration": 0.038757,
     "end_time": "2024-10-13T04:22:05.565963",
     "exception": false,
     "start_time": "2024-10-13T04:22:05.527206",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "def train(model,config, run_name=None):\n",
    "    wandb.init(\n",
    "        # set the wandb project where this run will be logged\n",
    "        project=\"3Dunimodal_ct_training\",\n",
    "        name = run_name,\n",
    "        # track hyperparameters and run metadata\n",
    "        config=config\n",
    "    )\n",
    "    optimizer = optim.Adam(model.parameters(), lr=config[\"learning_rate\"], weight_decay=config[\"weight_decay\"])\n",
    "    if config[\"class_weights\"] is not None: \n",
    "        config[\"class_weights\"] = torch.tensor(config[\"class_weights\"], dtype=torch.float).to(device)\n",
    "    \n",
    "    if config[\"focal_loss\"] is not None:\n",
    "        criterion = FocalLoss(gamma = config[\"focal_loss\"])\n",
    "    else:\n",
    "        criterion = nn.CrossEntropyLoss(weight = config[\"class_weights\"])\n",
    "    \n",
    "    scheduler = optim.lr_scheduler.ReduceLROnPlateau(optimizer, 'min',factor = config[\"reduce_lr_factor\"], patience = config[\"patience\"])\n",
    "    # initialize the early_stopping object\n",
    "    early_stopping = None\n",
    "    if config[\"early_stop_patience\"] is not None:\n",
    "        early_stopping = EarlyStopping(patience=config[\"early_stop_patience\"], verbose=True)\n",
    "    \n",
    "    # Training loop\n",
    "    num_epochs = config[\"epochs\"]\n",
    "    for epoch in range(num_epochs):\n",
    "        model.train()\n",
    "        running_loss = 0.0\n",
    "        train_correct = 0\n",
    "        total = 0\n",
    "        correct_per_class = [0, 0, 0]  # For G1, G2, G3\n",
    "        total_per_class = [0, 0, 0]  # For G1, G2, G3\n",
    "        for batch in train_loader:\n",
    "            volumes = batch['volume'].float().to(device)\n",
    "            labels = batch['label'].long().to(device)\n",
    "            #print(f\"volumes batch dimensions: {volumes.size()}\")\n",
    "            optimizer.zero_grad()\n",
    "            outputs = model(volumes.unsqueeze(1))\n",
    "            \n",
    "            if config[\"focal_loss\"]:\n",
    "                softmax = torch.nn.Softmax(dim=-1)\n",
    "                loss = criterion(softmax(outputs), labels)\n",
    "            else:\n",
    "                loss = criterion(outputs, labels)\n",
    "            \n",
    "            _, predicted = torch.max(outputs, 1)\n",
    "            train_correct += (predicted == labels).sum().item()\n",
    "            loss.backward()\n",
    "            optimizer.step()\n",
    "            total += labels.size(0)\n",
    "            running_loss += loss.item()\n",
    "            \n",
    "            # Calculate accuracy per class\n",
    "            for i in range(3):  # We have 3 classes: G1 (0), G2 (1), G3 (2)\n",
    "                correct_per_class[i] += ((predicted == i) & (labels == i)).sum().item()\n",
    "                total_per_class[i] += (labels == i).sum().item()\n",
    "\n",
    "        train_accuracy = 100 * train_correct / total\n",
    "        class_accuracy = [(100 * correct_per_class[i] / total_per_class[i]) if total_per_class[i] > 0 else 0 for i in range(3)]\n",
    "        print(f\"Epoch {epoch+1}, Loss: {running_loss/len(train_loader)}\")\n",
    "        wandb.log({\"Train Accuracy\": train_accuracy, \"Train loss\": running_loss/len(train_loader), \"G1_TrainAcc\":class_accuracy[0], \"G2_TrainAcc\":class_accuracy[1], \"G3_TrainAcc\":class_accuracy[2]})\n",
    "\n",
    "        # Validation loop\n",
    "        model.eval()\n",
    "        val_loss = 0.0\n",
    "        correct = 0\n",
    "        total = 0\n",
    "        # Initialize counters for each class (G1, G2, G3)\n",
    "        correct_per_class = [0, 0, 0]  # For G1, G2, G3\n",
    "        total_per_class = [0, 0, 0]  # For G1, G2, G3\n",
    "\n",
    "        with torch.no_grad():\n",
    "            for batch in val_loader:\n",
    "                volumes = batch['volume'].float().to(device)\n",
    "                labels = batch['label'].long().to(device)\n",
    "                \n",
    "                outputs = model(volumes.unsqueeze(1))\n",
    "                if config[\"focal_loss\"]:\n",
    "                    softmax = torch.nn.Softmax(dim=-1)\n",
    "                    loss = criterion(softmax(outputs), labels)\n",
    "                else:\n",
    "                    loss = criterion(outputs, labels)\n",
    "                \n",
    "                val_loss += loss.item()\n",
    "                _, predicted = torch.max(outputs, 1)\n",
    "                total += labels.size(0)\n",
    "                correct += (predicted == labels).sum().item()\n",
    "\n",
    "                # Calculate accuracy per class\n",
    "                for i in range(3):  # We have 3 classes: G1 (0), G2 (1), G3 (2)\n",
    "                    correct_per_class[i] += ((predicted == i) & (labels == i)).sum().item()\n",
    "                    total_per_class[i] += (labels == i).sum().item()\n",
    "        scheduler.step(val_loss)\n",
    "        # Compute total accuracy and per-class accuracy\n",
    "        total_accuracy = 100 * correct / total\n",
    "        class_accuracy = [(100 * correct_per_class[i] / total_per_class[i]) if total_per_class[i] > 0 else 0 for i in range(3)]\n",
    "        print(f\"Validation Loss: {val_loss/len(val_loader)}, Total Accuracy: {total_accuracy:.2f}%\")\n",
    "        print(f\"Accuracy per class - G1: {class_accuracy[0]:.2f}%, G2: {class_accuracy[1]:.2f}%, G3: {class_accuracy[2]:.2f}%\")\n",
    "        # log metrics to wandb\n",
    "        wandb.log({\"Total Accuracy\": total_accuracy, \"Validation Loss\": val_loss/len(val_loader), \"G1_Acc\":class_accuracy[0], \"G2_Acc\":class_accuracy[1], \"G3_Acc\":class_accuracy[2]})\n",
    "        if config[\"early_stop_patience\"] is not None:\n",
    "            early_stopping(val_loss, model)\n",
    "        \n",
    "        if config[\"early_stop_patience\"] is not None:\n",
    "            if early_stopping.early_stop:\n",
    "                print(\"Early stopping\")\n",
    "                break\n",
    "    wandb.finish()   "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "08129736",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-13T04:22:05.591509Z",
     "iopub.status.busy": "2024-10-13T04:22:05.591187Z",
     "iopub.status.idle": "2024-10-13T04:22:07.633317Z",
     "shell.execute_reply": "2024-10-13T04:22:07.632317Z"
    },
    "papermill": {
     "duration": 2.057582,
     "end_time": "2024-10-13T04:22:07.635662",
     "exception": false,
     "start_time": "2024-10-13T04:22:05.578080",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "import torch.nn as nn\n",
    "import torch.optim as optim\n",
    "from transformers import ResNetForImageClassification"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "b4987939",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-13T04:22:07.662244Z",
     "iopub.status.busy": "2024-10-13T04:22:07.661368Z",
     "iopub.status.idle": "2024-10-13T04:22:35.775663Z",
     "shell.execute_reply": "2024-10-13T04:22:35.774796Z"
    },
    "papermill": {
     "duration": 28.129764,
     "end_time": "2024-10-13T04:22:35.777959",
     "exception": false,
     "start_time": "2024-10-13T04:22:07.648195",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "train_dataset = UnimodalCTDataset3D(split='train',dataset_path = \"/kaggle/input/processed57patients3d/processed_3D_pad\" )\n",
    "val_dataset = UnimodalCTDataset3D(split='val',dataset_path = \"/kaggle/input/processed57patients3d/processed_3D_pad\")\n",
    "\n",
    "train_loader = DataLoader(train_dataset, batch_size=5, shuffle=True)\n",
    "val_loader = DataLoader(val_dataset, batch_size=2, shuffle=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "17c6c3c3",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-13T04:22:35.805001Z",
     "iopub.status.busy": "2024-10-13T04:22:35.804201Z",
     "iopub.status.idle": "2024-10-13T04:22:35.808983Z",
     "shell.execute_reply": "2024-10-13T04:22:35.808165Z"
    },
    "papermill": {
     "duration": 0.020346,
     "end_time": "2024-10-13T04:22:35.811222",
     "exception": false,
     "start_time": "2024-10-13T04:22:35.790876",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Training set stats:{'length': 139, 'class_frequency': {'G1': 11, 'G2': 91, 'G3': 37}}\n",
      "Validation set stats:{'length': 18, 'class_frequency': {'G1': 4, 'G2': 8, 'G3': 6}}\n"
     ]
    }
   ],
   "source": [
    "print(f\"Training set stats:{train_dataset.stats()}\")\n",
    "print(f\"Validation set stats:{val_dataset.stats()}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "72948e86",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-13T04:22:35.837052Z",
     "iopub.status.busy": "2024-10-13T04:22:35.836776Z",
     "iopub.status.idle": "2024-10-13T04:22:37.025098Z",
     "shell.execute_reply": "2024-10-13T04:22:37.024330Z"
    },
    "papermill": {
     "duration": 1.204055,
     "end_time": "2024-10-13T04:22:37.027392",
     "exception": false,
     "start_time": "2024-10-13T04:22:35.823337",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "labels = []\n",
    "for sample in train_dataset:\n",
    "    labels.append(sample[\"label\"])\n",
    "labels = np.array(labels)\n",
    "class_weights = compute_class_weight(\"balanced\", classes=np.unique(labels), y=labels)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "df851424",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-13T04:22:37.054473Z",
     "iopub.status.busy": "2024-10-13T04:22:37.054118Z",
     "iopub.status.idle": "2024-10-13T04:22:37.060044Z",
     "shell.execute_reply": "2024-10-13T04:22:37.059053Z"
    },
    "papermill": {
     "duration": 0.021918,
     "end_time": "2024-10-13T04:22:37.062094",
     "exception": false,
     "start_time": "2024-10-13T04:22:37.040176",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[4.21212121 0.50915751 1.25225225]\n"
     ]
    }
   ],
   "source": [
    "print(class_weights)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5f116a6e",
   "metadata": {
    "papermill": {
     "duration": 0.012814,
     "end_time": "2024-10-13T04:22:37.087909",
     "exception": false,
     "start_time": "2024-10-13T04:22:37.075095",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "### 3D Resnet-18"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "4cc1fffd",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-13T04:22:37.116380Z",
     "iopub.status.busy": "2024-10-13T04:22:37.115429Z",
     "iopub.status.idle": "2024-10-13T04:22:38.154098Z",
     "shell.execute_reply": "2024-10-13T04:22:38.153198Z"
    },
    "papermill": {
     "duration": 1.055715,
     "end_time": "2024-10-13T04:22:38.156741",
     "exception": false,
     "start_time": "2024-10-13T04:22:37.101026",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "import torchvision.models as models"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "42f867a0",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-13T04:22:38.188556Z",
     "iopub.status.busy": "2024-10-13T04:22:38.188143Z",
     "iopub.status.idle": "2024-10-13T04:22:38.195476Z",
     "shell.execute_reply": "2024-10-13T04:22:38.194462Z"
    },
    "papermill": {
     "duration": 0.025641,
     "end_time": "2024-10-13T04:22:38.197651",
     "exception": false,
     "start_time": "2024-10-13T04:22:38.172010",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "class ResNet3D(nn.Module):\n",
    "    def __init__(self, num_classes):\n",
    "        super(ResNet3D, self).__init__()\n",
    "        self.model = models.video.r3d_18(pretrained=True)  # 3D ResNet18\n",
    "        self.model.stem[0] = nn.Conv3d(1, 64, kernel_size=(7, 7, 7), stride=(2, 2, 2), padding=(3, 3, 3), bias=False)\n",
    "        self.model.fc = nn.Linear(self.model.fc.in_features, num_classes)\n",
    "    \n",
    "    def forward(self, x):\n",
    "        return self.model(x)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "5b9d1e59",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-13T04:22:38.226946Z",
     "iopub.status.busy": "2024-10-13T04:22:38.226244Z",
     "iopub.status.idle": "2024-10-13T04:22:39.646332Z",
     "shell.execute_reply": "2024-10-13T04:22:39.645333Z"
    },
    "papermill": {
     "duration": 1.437039,
     "end_time": "2024-10-13T04:22:39.649008",
     "exception": false,
     "start_time": "2024-10-13T04:22:38.211969",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/opt/conda/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.\n",
      "  warnings.warn(\n",
      "/opt/conda/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=R3D_18_Weights.KINETICS400_V1`. You can also use `weights=R3D_18_Weights.DEFAULT` to get the most up-to-date weights.\n",
      "  warnings.warn(msg)\n",
      "Downloading: \"https://download.pytorch.org/models/r3d_18-b3b3357e.pth\" to /root/.cache/torch/hub/checkpoints/r3d_18-b3b3357e.pth\n",
      "100%|██████████| 127M/127M [00:00<00:00, 199MB/s]\n"
     ]
    }
   ],
   "source": [
    "model = ResNet3D(num_classes = 3)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "4ee24abf",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-13T04:22:39.680599Z",
     "iopub.status.busy": "2024-10-13T04:22:39.679859Z",
     "iopub.status.idle": "2024-10-13T04:22:39.944036Z",
     "shell.execute_reply": "2024-10-13T04:22:39.942981Z"
    },
    "papermill": {
     "duration": 0.280755,
     "end_time": "2024-10-13T04:22:39.946085",
     "exception": false,
     "start_time": "2024-10-13T04:22:39.665330",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "ResNet3D(\n",
       "  (model): VideoResNet(\n",
       "    (stem): BasicStem(\n",
       "      (0): Conv3d(1, 64, kernel_size=(7, 7, 7), stride=(2, 2, 2), padding=(3, 3, 3), bias=False)\n",
       "      (1): BatchNorm3d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "      (2): ReLU(inplace=True)\n",
       "    )\n",
       "    (layer1): Sequential(\n",
       "      (0): BasicBlock(\n",
       "        (conv1): Sequential(\n",
       "          (0): Conv3DSimple(64, 64, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "          (2): ReLU(inplace=True)\n",
       "        )\n",
       "        (conv2): Sequential(\n",
       "          (0): Conv3DSimple(64, 64, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "        )\n",
       "        (relu): ReLU(inplace=True)\n",
       "      )\n",
       "      (1): BasicBlock(\n",
       "        (conv1): Sequential(\n",
       "          (0): Conv3DSimple(64, 64, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "          (2): ReLU(inplace=True)\n",
       "        )\n",
       "        (conv2): Sequential(\n",
       "          (0): Conv3DSimple(64, 64, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "        )\n",
       "        (relu): ReLU(inplace=True)\n",
       "      )\n",
       "    )\n",
       "    (layer2): Sequential(\n",
       "      (0): BasicBlock(\n",
       "        (conv1): Sequential(\n",
       "          (0): Conv3DSimple(64, 128, kernel_size=(3, 3, 3), stride=(2, 2, 2), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "          (2): ReLU(inplace=True)\n",
       "        )\n",
       "        (conv2): Sequential(\n",
       "          (0): Conv3DSimple(128, 128, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "        )\n",
       "        (relu): ReLU(inplace=True)\n",
       "        (downsample): Sequential(\n",
       "          (0): Conv3d(64, 128, kernel_size=(1, 1, 1), stride=(2, 2, 2), bias=False)\n",
       "          (1): BatchNorm3d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "        )\n",
       "      )\n",
       "      (1): BasicBlock(\n",
       "        (conv1): Sequential(\n",
       "          (0): Conv3DSimple(128, 128, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "          (2): ReLU(inplace=True)\n",
       "        )\n",
       "        (conv2): Sequential(\n",
       "          (0): Conv3DSimple(128, 128, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "        )\n",
       "        (relu): ReLU(inplace=True)\n",
       "      )\n",
       "    )\n",
       "    (layer3): Sequential(\n",
       "      (0): BasicBlock(\n",
       "        (conv1): Sequential(\n",
       "          (0): Conv3DSimple(128, 256, kernel_size=(3, 3, 3), stride=(2, 2, 2), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "          (2): ReLU(inplace=True)\n",
       "        )\n",
       "        (conv2): Sequential(\n",
       "          (0): Conv3DSimple(256, 256, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "        )\n",
       "        (relu): ReLU(inplace=True)\n",
       "        (downsample): Sequential(\n",
       "          (0): Conv3d(128, 256, kernel_size=(1, 1, 1), stride=(2, 2, 2), bias=False)\n",
       "          (1): BatchNorm3d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "        )\n",
       "      )\n",
       "      (1): BasicBlock(\n",
       "        (conv1): Sequential(\n",
       "          (0): Conv3DSimple(256, 256, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "          (2): ReLU(inplace=True)\n",
       "        )\n",
       "        (conv2): Sequential(\n",
       "          (0): Conv3DSimple(256, 256, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "        )\n",
       "        (relu): ReLU(inplace=True)\n",
       "      )\n",
       "    )\n",
       "    (layer4): Sequential(\n",
       "      (0): BasicBlock(\n",
       "        (conv1): Sequential(\n",
       "          (0): Conv3DSimple(256, 512, kernel_size=(3, 3, 3), stride=(2, 2, 2), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "          (2): ReLU(inplace=True)\n",
       "        )\n",
       "        (conv2): Sequential(\n",
       "          (0): Conv3DSimple(512, 512, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "        )\n",
       "        (relu): ReLU(inplace=True)\n",
       "        (downsample): Sequential(\n",
       "          (0): Conv3d(256, 512, kernel_size=(1, 1, 1), stride=(2, 2, 2), bias=False)\n",
       "          (1): BatchNorm3d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "        )\n",
       "      )\n",
       "      (1): BasicBlock(\n",
       "        (conv1): Sequential(\n",
       "          (0): Conv3DSimple(512, 512, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "          (2): ReLU(inplace=True)\n",
       "        )\n",
       "        (conv2): Sequential(\n",
       "          (0): Conv3DSimple(512, 512, kernel_size=(3, 3, 3), stride=(1, 1, 1), padding=(1, 1, 1), bias=False)\n",
       "          (1): BatchNorm3d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n",
       "        )\n",
       "        (relu): ReLU(inplace=True)\n",
       "      )\n",
       "    )\n",
       "    (avgpool): AdaptiveAvgPool3d(output_size=(1, 1, 1))\n",
       "    (fc): Linear(in_features=512, out_features=3, bias=True)\n",
       "  )\n",
       ")"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "device = torch.device(\"cuda\" if torch.cuda.is_available() else \"cpu\")\n",
    "model.to(device)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "4c8f00c2",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-13T04:22:39.974739Z",
     "iopub.status.busy": "2024-10-13T04:22:39.974428Z",
     "iopub.status.idle": "2024-10-13T04:22:51.877076Z",
     "shell.execute_reply": "2024-10-13T04:22:51.875940Z"
    },
    "papermill": {
     "duration": 11.919442,
     "end_time": "2024-10-13T04:22:51.879380",
     "exception": false,
     "start_time": "2024-10-13T04:22:39.959938",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Collecting focal_loss_torch\r\n",
      "  Downloading focal_loss_torch-0.1.2-py3-none-any.whl.metadata (2.2 kB)\r\n",
      "Requirement already satisfied: torch in /opt/conda/lib/python3.10/site-packages (from focal_loss_torch) (2.4.0)\r\n",
      "Requirement already satisfied: numpy in /opt/conda/lib/python3.10/site-packages (from focal_loss_torch) (1.26.4)\r\n",
      "Requirement already satisfied: filelock in /opt/conda/lib/python3.10/site-packages (from torch->focal_loss_torch) (3.15.1)\r\n",
      "Requirement already satisfied: typing-extensions>=4.8.0 in /opt/conda/lib/python3.10/site-packages (from torch->focal_loss_torch) (4.12.2)\r\n",
      "Requirement already satisfied: sympy in /opt/conda/lib/python3.10/site-packages (from torch->focal_loss_torch) (1.13.3)\r\n",
      "Requirement already satisfied: networkx in /opt/conda/lib/python3.10/site-packages (from torch->focal_loss_torch) (3.3)\r\n",
      "Requirement already satisfied: jinja2 in /opt/conda/lib/python3.10/site-packages (from torch->focal_loss_torch) (3.1.4)\r\n",
      "Requirement already satisfied: fsspec in /opt/conda/lib/python3.10/site-packages (from torch->focal_loss_torch) (2024.6.1)\r\n",
      "Requirement already satisfied: MarkupSafe>=2.0 in /opt/conda/lib/python3.10/site-packages (from jinja2->torch->focal_loss_torch) (2.1.5)\r\n",
      "Requirement already satisfied: mpmath<1.4,>=1.1.0 in /opt/conda/lib/python3.10/site-packages (from sympy->torch->focal_loss_torch) (1.3.0)\r\n",
      "Downloading focal_loss_torch-0.1.2-py3-none-any.whl (4.5 kB)\r\n",
      "Installing collected packages: focal_loss_torch\r\n",
      "Successfully installed focal_loss_torch-0.1.2\r\n"
     ]
    }
   ],
   "source": [
    "#https://github.com/mathiaszinnen/focal_loss_torch/tree/main\n",
    "!pip install focal_loss_torch"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "f388ca62",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-10-13T04:22:51.910564Z",
     "iopub.status.busy": "2024-10-13T04:22:51.909924Z",
     "iopub.status.idle": "2024-10-13T10:08:21.576603Z",
     "shell.execute_reply": "2024-10-13T10:08:21.575689Z"
    },
    "papermill": {
     "duration": 20729.684887,
     "end_time": "2024-10-13T10:08:21.578919",
     "exception": false,
     "start_time": "2024-10-13T04:22:51.894032",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\u001b[34m\u001b[1mwandb\u001b[0m: Currently logged in as: \u001b[33mpietro-caforio\u001b[0m (\u001b[33mpietro-caforio-politecnico-di-milano\u001b[0m). Use \u001b[1m`wandb login --relogin`\u001b[0m to force relogin\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: Tracking run with wandb version 0.18.3\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: Run data is saved locally in \u001b[35m\u001b[1m/kaggle/working/wandb/run-20241013_042251-wvw6dd5p\u001b[0m\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: Run \u001b[1m`wandb offline`\u001b[0m to turn off syncing.\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: Syncing run \u001b[33mResNet3D original best weighted loss\u001b[0m\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: ⭐️ View project at \u001b[34m\u001b[4mhttps://wandb.ai/pietro-caforio-politecnico-di-milano/3Dunimodal_ct_training\u001b[0m\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: 🚀 View run at \u001b[34m\u001b[4mhttps://wandb.ai/pietro-caforio-politecnico-di-milano/3Dunimodal_ct_training/runs/wvw6dd5p\u001b[0m\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Epoch 1, Loss: 1.062215534704072\n",
      "Validation Loss: 1.1599894828266568, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 0.00%, G2: 0.00%, G3: 100.00%\n",
      "Epoch 2, Loss: 1.0712163022586279\n",
      "Validation Loss: 1.1556809279653761, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 0.00%, G2: 0.00%, G3: 83.33%\n",
      "Epoch 3, Loss: 1.0622664668730326\n",
      "Validation Loss: 1.132807691891988, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 0.00%, G2: 0.00%, G3: 66.67%\n",
      "Epoch 4, Loss: 1.055826097726822\n",
      "Validation Loss: 1.1203995082113478, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 0.00%, G2: 0.00%, G3: 66.67%\n",
      "Epoch 5, Loss: 1.0651454627513885\n",
      "Validation Loss: 1.120175646411048, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 0.00%, G2: 0.00%, G3: 66.67%\n",
      "Epoch 6, Loss: 1.043595695069858\n",
      "Validation Loss: 1.1212565501530964, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 0.00%, G2: 0.00%, G3: 66.67%\n",
      "Epoch 7, Loss: 1.0513239119734084\n",
      "Validation Loss: 1.1190012627177768, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 0.00%, G2: 0.00%, G3: 66.67%\n",
      "Epoch 8, Loss: 1.056910555277552\n",
      "Validation Loss: 1.1218893726666768, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 0.00%, G2: 0.00%, G3: 66.67%\n",
      "Epoch 9, Loss: 1.0489337401730674\n",
      "Validation Loss: 1.1277334888776143, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 0.00%, G2: 0.00%, G3: 66.67%\n",
      "Epoch 10, Loss: 1.0392439727272307\n",
      "Validation Loss: 1.113976193798913, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 0.00%, G2: 0.00%, G3: 66.67%\n",
      "Epoch 11, Loss: 1.0394616616623742\n",
      "Validation Loss: 1.1122617191738553, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 0.00%, G2: 0.00%, G3: 66.67%\n",
      "Epoch 12, Loss: 1.0335004521267754\n",
      "Validation Loss: 1.115768551826477, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 0.00%, G2: 0.00%, G3: 66.67%\n",
      "Epoch 13, Loss: 1.0558492094278336\n",
      "Validation Loss: 1.1179215245776706, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 0.00%, G2: 0.00%, G3: 66.67%\n",
      "Epoch 14, Loss: 1.0348934978246689\n",
      "Validation Loss: 1.1195594271024067, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 0.00%, G2: 0.00%, G3: 66.67%\n",
      "Epoch 15, Loss: 1.039261588028499\n",
      "Validation Loss: 1.1159796648555331, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 0.00%, G2: 0.00%, G3: 66.67%\n",
      "Epoch 16, Loss: 1.0384842199938638\n",
      "Validation Loss: 1.1127433776855469, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 0.00%, G2: 0.00%, G3: 66.67%\n",
      "Epoch 17, Loss: 1.0336268012012755\n",
      "Validation Loss: 1.113200651274787, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 0.00%, G2: 0.00%, G3: 66.67%\n",
      "Epoch 18, Loss: 1.0195970918451036\n",
      "Validation Loss: 1.117137398984697, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 0.00%, G2: 0.00%, G3: 66.67%\n",
      "Epoch 19, Loss: 1.0142375997134618\n",
      "Validation Loss: 1.1185189419322543, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 0.00%, G2: 0.00%, G3: 66.67%\n",
      "Epoch 20, Loss: 1.0244198100907462\n",
      "Validation Loss: 1.1123855710029602, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 0.00%, G2: 0.00%, G3: 66.67%\n",
      "Epoch 21, Loss: 1.011914380959102\n",
      "Validation Loss: 1.1086252795325384, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 0.00%, G2: 0.00%, G3: 66.67%\n",
      "Epoch 22, Loss: 1.0076895015580314\n",
      "Validation Loss: 1.113696277141571, Total Accuracy: 22.22%\n",
      "Accuracy per class - G1: 0.00%, G2: 0.00%, G3: 66.67%\n",
      "Epoch 23, Loss: 1.004943581564086\n",
      "Validation Loss: 1.1039871904585097, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 0.00%, G2: 25.00%, G3: 66.67%\n",
      "Epoch 24, Loss: 1.0065673887729645\n",
      "Validation Loss: 1.1070817311604817, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 0.00%, G2: 12.50%, G3: 66.67%\n",
      "Epoch 25, Loss: 1.0075093380042486\n",
      "Validation Loss: 1.1075584159957037, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 0.00%, G2: 12.50%, G3: 66.67%\n",
      "Epoch 26, Loss: 0.9981166784252439\n",
      "Validation Loss: 1.1038782596588135, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 0.00%, G2: 25.00%, G3: 66.67%\n",
      "Epoch 27, Loss: 1.018065014055797\n",
      "Validation Loss: 1.1100123392211065, Total Accuracy: 27.78%\n",
      "Accuracy per class - G1: 0.00%, G2: 12.50%, G3: 66.67%\n",
      "Epoch 28, Loss: 0.9983987786940166\n",
      "Validation Loss: 1.104469319184621, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 0.00%, G2: 25.00%, G3: 66.67%\n",
      "Epoch 29, Loss: 1.0030887637819563\n",
      "Validation Loss: 1.101963394218021, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 0.00%, G2: 25.00%, G3: 66.67%\n",
      "Epoch 30, Loss: 0.983146852680615\n",
      "Validation Loss: 1.1045491496721904, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 0.00%, G2: 25.00%, G3: 66.67%\n",
      "Epoch 31, Loss: 1.0080098445926393\n",
      "Validation Loss: 1.1051054331991408, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 0.00%, G2: 25.00%, G3: 66.67%\n",
      "Epoch 32, Loss: 0.9886165878602436\n",
      "Validation Loss: 1.1007515125804477, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 0.00%, G2: 37.50%, G3: 66.67%\n",
      "Epoch 33, Loss: 0.9730176265750613\n",
      "Validation Loss: 1.097740650177002, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 0.00%, G2: 25.00%, G3: 66.67%\n",
      "Epoch 34, Loss: 0.9988411388226918\n",
      "Validation Loss: 1.0956761240959167, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 0.00%, G2: 50.00%, G3: 66.67%\n",
      "Epoch 35, Loss: 0.9707456316266742\n",
      "Validation Loss: 1.1030682259135776, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 0.00%, G2: 25.00%, G3: 66.67%\n",
      "Epoch 36, Loss: 0.9727035803454263\n",
      "Validation Loss: 1.102854033311208, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 0.00%, G2: 25.00%, G3: 66.67%\n",
      "Epoch 37, Loss: 0.9789189632449832\n",
      "Validation Loss: 1.1004640195104811, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 0.00%, G2: 25.00%, G3: 66.67%\n",
      "Epoch 38, Loss: 0.9795808259929929\n",
      "Validation Loss: 1.1019398901197646, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 0.00%, G2: 25.00%, G3: 66.67%\n",
      "Epoch 39, Loss: 0.9550375831978661\n",
      "Validation Loss: 1.1037901706165738, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 0.00%, G2: 37.50%, G3: 66.67%\n",
      "Epoch 40, Loss: 0.9742419102362224\n",
      "Validation Loss: 1.1080691946877375, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 0.00%, G2: 25.00%, G3: 66.67%\n",
      "Epoch 41, Loss: 0.9774738997220993\n",
      "Validation Loss: 1.0942488974995084, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 42, Loss: 0.9833453702075141\n",
      "Validation Loss: 1.0984223352538214, Total Accuracy: 38.89%\n",
      "Accuracy per class - G1: 0.00%, G2: 37.50%, G3: 66.67%\n",
      "Epoch 43, Loss: 0.9614267519542149\n",
      "Validation Loss: 1.103026356961992, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 0.00%, G2: 50.00%, G3: 66.67%\n",
      "Epoch 44, Loss: 0.9527499548026493\n",
      "Validation Loss: 1.095297826661004, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 45, Loss: 0.9643549408231463\n",
      "Validation Loss: 1.0970632168981764, Total Accuracy: 44.44%\n",
      "Accuracy per class - G1: 0.00%, G2: 50.00%, G3: 66.67%\n",
      "Epoch 46, Loss: 0.946191885641643\n",
      "Validation Loss: 1.1062369810210333, Total Accuracy: 33.33%\n",
      "Accuracy per class - G1: 0.00%, G2: 25.00%, G3: 66.67%\n",
      "Epoch 47, Loss: 0.9482906290463039\n",
      "Validation Loss: 1.0968318581581116, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 48, Loss: 0.9830067242894854\n",
      "Validation Loss: 1.0929172833760579, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 49, Loss: 0.9499737748077938\n",
      "Validation Loss: 1.0919826163185968, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 50, Loss: 0.9547719444547381\n",
      "Validation Loss: 1.0919977294074164, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 51, Loss: 0.9686064230544227\n",
      "Validation Loss: 1.0930761496225994, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 52, Loss: 0.9504722058773041\n",
      "Validation Loss: 1.097903437084622, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 53, Loss: 0.9350091921431678\n",
      "Validation Loss: 1.0938174923261006, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 54, Loss: 0.93971848487854\n",
      "Validation Loss: 1.0969705515437655, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 55, Loss: 0.9487211321081434\n",
      "Validation Loss: 1.094379226366679, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 56, Loss: 0.9397759416273662\n",
      "Validation Loss: 1.0921255350112915, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 57, Loss: 0.9264915393931525\n",
      "Validation Loss: 1.09952884250217, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 58, Loss: 0.9252631323678153\n",
      "Validation Loss: 1.0852488742934332, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 59, Loss: 0.9174782420907702\n",
      "Validation Loss: 1.0917626023292542, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 60, Loss: 0.9457043409347534\n",
      "Validation Loss: 1.0872805582152472, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 61, Loss: 0.9171587462936129\n",
      "Validation Loss: 1.087227953804864, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 62, Loss: 0.9272192163126809\n",
      "Validation Loss: 1.0938219494289823, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 63, Loss: 0.9202312763248172\n",
      "Validation Loss: 1.0913460387123957, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 64, Loss: 0.9345110335520336\n",
      "Validation Loss: 1.090948502222697, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 65, Loss: 0.9122105219534465\n",
      "Validation Loss: 1.0849593215518527, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 66, Loss: 0.9080618109021869\n",
      "Validation Loss: 1.0838262836138408, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 67, Loss: 0.9063520559242794\n",
      "Validation Loss: 1.0940236184332106, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 68, Loss: 0.919298672250339\n",
      "Validation Loss: 1.0844493442111545, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 69, Loss: 0.9106928982904979\n",
      "Validation Loss: 1.0911601848072476, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 70, Loss: 0.914001247712544\n",
      "Validation Loss: 1.0818554825252957, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 71, Loss: 0.9162513549838748\n",
      "Validation Loss: 1.0802439451217651, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 72, Loss: 0.888615220785141\n",
      "Validation Loss: 1.0844223366843329, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 73, Loss: 0.9037916149411883\n",
      "Validation Loss: 1.0848152372572157, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 74, Loss: 0.9174024718148368\n",
      "Validation Loss: 1.0888150069448683, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 75, Loss: 0.909963167139462\n",
      "Validation Loss: 1.0794684489568074, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 76, Loss: 0.8851879302944455\n",
      "Validation Loss: 1.0903485616048176, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 77, Loss: 0.8899530236210141\n",
      "Validation Loss: 1.0916244917445712, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 78, Loss: 0.8922042442219598\n",
      "Validation Loss: 1.0899378458658855, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 79, Loss: 0.8811661452054977\n",
      "Validation Loss: 1.082157724433475, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 80, Loss: 0.8879222529275077\n",
      "Validation Loss: 1.0853519837061565, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 81, Loss: 0.8752358193908419\n",
      "Validation Loss: 1.083863463666704, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 82, Loss: 0.9047015947954995\n",
      "Validation Loss: 1.0906939506530762, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 83, Loss: 0.8810551996741977\n",
      "Validation Loss: 1.0910503268241882, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 84, Loss: 0.8769108333757946\n",
      "Validation Loss: 1.0933489733272128, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 85, Loss: 0.8782290156398501\n",
      "Validation Loss: 1.084304862552219, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 86, Loss: 0.8698965992246356\n",
      "Validation Loss: 1.0822115739186604, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 87, Loss: 0.8940442608935493\n",
      "Validation Loss: 1.0867643422550626, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 88, Loss: 0.8688494328941617\n",
      "Validation Loss: 1.0870032906532288, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 89, Loss: 0.860866863812719\n",
      "Validation Loss: 1.0783057808876038, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 90, Loss: 0.8809991627931595\n",
      "Validation Loss: 1.0727865762180753, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 91, Loss: 0.8622874000242778\n",
      "Validation Loss: 1.077801399760776, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 92, Loss: 0.8741113500935691\n",
      "Validation Loss: 1.0790590511427984, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 93, Loss: 0.8412363209894725\n",
      "Validation Loss: 1.0716669890615675, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 94, Loss: 0.8453103665794645\n",
      "Validation Loss: 1.0778972837660048, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 95, Loss: 0.8755169276680265\n",
      "Validation Loss: 1.078779074880812, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 96, Loss: 0.8707270473241806\n",
      "Validation Loss: 1.0736965537071228, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 97, Loss: 0.8406119006020683\n",
      "Validation Loss: 1.0752358304129706, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 98, Loss: 0.8641328002725329\n",
      "Validation Loss: 1.0770433412657843, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 99, Loss: 0.822626205427306\n",
      "Validation Loss: 1.0753187073601618, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 100, Loss: 0.8308324004922595\n",
      "Validation Loss: 1.0753863255182903, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 101, Loss: 0.857471085020474\n",
      "Validation Loss: 1.0771858228577509, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 102, Loss: 0.8576233408280781\n",
      "Validation Loss: 1.0862418479389615, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 103, Loss: 0.8514008692332676\n",
      "Validation Loss: 1.0814274152119954, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 104, Loss: 0.8714397123881749\n",
      "Validation Loss: 1.0878220068083868, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 105, Loss: 0.8403845110109874\n",
      "Validation Loss: 1.0754176245795355, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 106, Loss: 0.8572460157530648\n",
      "Validation Loss: 1.071874479452769, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 107, Loss: 0.8474020894084658\n",
      "Validation Loss: 1.0742074714766607, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 108, Loss: 0.8552362152508327\n",
      "Validation Loss: 1.0714257624414232, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 109, Loss: 0.8363332620688847\n",
      "Validation Loss: 1.085067994064755, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 110, Loss: 0.8624488690069744\n",
      "Validation Loss: 1.0724459091822307, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 111, Loss: 0.8369470089673996\n",
      "Validation Loss: 1.0749831597010295, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 112, Loss: 0.8215567171573639\n",
      "Validation Loss: 1.0672602653503418, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 113, Loss: 0.82082841864654\n",
      "Validation Loss: 1.0741312901178997, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 114, Loss: 0.7979850471019745\n",
      "Validation Loss: 1.0788406332333882, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 115, Loss: 0.8413175642490387\n",
      "Validation Loss: 1.0665079355239868, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 116, Loss: 0.8331524878740311\n",
      "Validation Loss: 1.0698402391539679, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 117, Loss: 0.8719645206417356\n",
      "Validation Loss: 1.0764999323421054, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 118, Loss: 0.8359907397202083\n",
      "Validation Loss: 1.0645870632595487, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 119, Loss: 0.8247385770082474\n",
      "Validation Loss: 1.0781229535738628, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 120, Loss: 0.8155487328767776\n",
      "Validation Loss: 1.062347604168786, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 121, Loss: 0.8288726827927998\n",
      "Validation Loss: 1.0671826932165358, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 122, Loss: 0.8359076274292809\n",
      "Validation Loss: 1.0637510551346674, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 123, Loss: 0.8428852728434971\n",
      "Validation Loss: 1.0693134334352281, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 124, Loss: 0.8185628759009498\n",
      "Validation Loss: 1.0766430497169495, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 125, Loss: 0.809751628765038\n",
      "Validation Loss: 1.0609778298272028, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 126, Loss: 0.835387259721756\n",
      "Validation Loss: 1.0643870366944208, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 127, Loss: 0.8094126347984586\n",
      "Validation Loss: 1.067971772617764, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 128, Loss: 0.8520006941897529\n",
      "Validation Loss: 1.0619975195990667, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 129, Loss: 0.8279733061790466\n",
      "Validation Loss: 1.0667189293437533, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 130, Loss: 0.8065910871539798\n",
      "Validation Loss: 1.0619104968176947, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 131, Loss: 0.8293356725147792\n",
      "Validation Loss: 1.071797940466139, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 132, Loss: 0.8051661231688091\n",
      "Validation Loss: 1.0765541659461126, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 133, Loss: 0.786207282117435\n",
      "Validation Loss: 1.0610431830088298, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 134, Loss: 0.8310473007815224\n",
      "Validation Loss: 1.0578490959273443, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 135, Loss: 0.7897364497184753\n",
      "Validation Loss: 1.0657317638397217, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 136, Loss: 0.8122195835624423\n",
      "Validation Loss: 1.06170301967197, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 137, Loss: 0.7682869498218808\n",
      "Validation Loss: 1.058569245868259, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 138, Loss: 0.7914292280163083\n",
      "Validation Loss: 1.0713196065690782, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 139, Loss: 0.8050131904227393\n",
      "Validation Loss: 1.0574906865755718, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 140, Loss: 0.7713548040815762\n",
      "Validation Loss: 1.0628252824147542, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 141, Loss: 0.7929742463997432\n",
      "Validation Loss: 1.0577053758833144, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 142, Loss: 0.8207951518041747\n",
      "Validation Loss: 1.0614614884058635, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 143, Loss: 0.7809753290244511\n",
      "Validation Loss: 1.055381668938531, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 144, Loss: 0.8014355791466576\n",
      "Validation Loss: 1.0516482988993328, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 145, Loss: 0.8099355122872761\n",
      "Validation Loss: 1.0620001819398668, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 146, Loss: 0.7722232490777969\n",
      "Validation Loss: 1.0553854041629367, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 147, Loss: 0.8145623568977628\n",
      "Validation Loss: 1.073260764280955, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 148, Loss: 0.7632422255618232\n",
      "Validation Loss: 1.0532431403795879, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 149, Loss: 0.7918692859155791\n",
      "Validation Loss: 1.0635762744479709, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 150, Loss: 0.7388991468719074\n",
      "Validation Loss: 1.0494113365809123, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 151, Loss: 0.7739423545343536\n",
      "Validation Loss: 1.0436888800726996, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 152, Loss: 0.7646051581416812\n",
      "Validation Loss: 1.0461826589372423, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 153, Loss: 0.7698284706899098\n",
      "Validation Loss: 1.0484985775417752, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 154, Loss: 0.7681100208844457\n",
      "Validation Loss: 1.05340356959237, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 155, Loss: 0.802435217159135\n",
      "Validation Loss: 1.0524765716658697, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 156, Loss: 0.7406338687453952\n",
      "Validation Loss: 1.066965937614441, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 157, Loss: 0.7752810759203774\n",
      "Validation Loss: 1.0577863256136577, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 158, Loss: 0.7685197400195258\n",
      "Validation Loss: 1.057614803314209, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 159, Loss: 0.7835958514894757\n",
      "Validation Loss: 1.0528260601891413, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 160, Loss: 0.7539889120629856\n",
      "Validation Loss: 1.0556594729423523, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 161, Loss: 0.7304387188383511\n",
      "Validation Loss: 1.0565644105275471, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 162, Loss: 0.7827628914799009\n",
      "Validation Loss: 1.0631757842169867, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 163, Loss: 0.7725381957633155\n",
      "Validation Loss: 1.05463355117374, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 164, Loss: 0.7348457968660763\n",
      "Validation Loss: 1.0628221101231046, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 165, Loss: 0.7808849023921149\n",
      "Validation Loss: 1.0466635955704584, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 166, Loss: 0.7508239224553108\n",
      "Validation Loss: 1.0549181302388508, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 167, Loss: 0.7787308618426323\n",
      "Validation Loss: 1.0530739559067621, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 168, Loss: 0.7513693326285907\n",
      "Validation Loss: 1.0465114514033, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 169, Loss: 0.743103662771838\n",
      "Validation Loss: 1.047665211889479, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 170, Loss: 0.7552041060158184\n",
      "Validation Loss: 1.0442491637335882, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 171, Loss: 0.7720220727579934\n",
      "Validation Loss: 1.0579104820887248, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 172, Loss: 0.7280101669686181\n",
      "Validation Loss: 1.0591266751289368, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 173, Loss: 0.7942924754960197\n",
      "Validation Loss: 1.0631954073905945, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 174, Loss: 0.7409607682909284\n",
      "Validation Loss: 1.043815513451894, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 175, Loss: 0.770850423191275\n",
      "Validation Loss: 1.052515983581543, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 176, Loss: 0.7192346677184105\n",
      "Validation Loss: 1.0409011046091716, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 177, Loss: 0.7548888911093984\n",
      "Validation Loss: 1.047733313507504, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 178, Loss: 0.7418111647878375\n",
      "Validation Loss: 1.0558273394902546, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 179, Loss: 0.7584838739463261\n",
      "Validation Loss: 1.0455964141421847, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 180, Loss: 0.7382691672870091\n",
      "Validation Loss: 1.0532493326399062, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 181, Loss: 0.7262201021824565\n",
      "Validation Loss: 1.0509569711155362, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 182, Loss: 0.741755544074944\n",
      "Validation Loss: 1.0504064228799608, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 183, Loss: 0.7492821823273387\n",
      "Validation Loss: 1.042464296023051, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 184, Loss: 0.7411390138523919\n",
      "Validation Loss: 1.0466221504741244, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 185, Loss: 0.7272535977619035\n",
      "Validation Loss: 1.0527761114968195, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 186, Loss: 0.7397742154342788\n",
      "Validation Loss: 1.042899529139201, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 187, Loss: 0.726866544357368\n",
      "Validation Loss: 1.0332894656393263, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 188, Loss: 0.7203271229352269\n",
      "Validation Loss: 1.0310594042142232, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 189, Loss: 0.7440396515386445\n",
      "Validation Loss: 1.0389772189988031, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 190, Loss: 0.7429006919264793\n",
      "Validation Loss: 1.0277542273203533, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 191, Loss: 0.7397314310073853\n",
      "Validation Loss: 1.037826074494256, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 192, Loss: 0.73564234908138\n",
      "Validation Loss: 1.0414692958196003, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 193, Loss: 0.7115562558174133\n",
      "Validation Loss: 1.038483613067203, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 194, Loss: 0.737951187150819\n",
      "Validation Loss: 1.0376192927360535, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 195, Loss: 0.7309752117310252\n",
      "Validation Loss: 1.043232520421346, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 196, Loss: 0.7164933681488037\n",
      "Validation Loss: 1.0398844480514526, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 197, Loss: 0.7090174385479519\n",
      "Validation Loss: 1.0470407340261672, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 198, Loss: 0.7532622143626213\n",
      "Validation Loss: 1.0455148418744404, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 199, Loss: 0.7126215323805809\n",
      "Validation Loss: 1.0391819808218214, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 200, Loss: 0.7081641203590802\n",
      "Validation Loss: 1.0349574089050293, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 201, Loss: 0.7493392867701394\n",
      "Validation Loss: 1.036950455771552, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 202, Loss: 0.6969292578952653\n",
      "Validation Loss: 1.0326617161432903, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 203, Loss: 0.6947147186313357\n",
      "Validation Loss: 1.0488364431593153, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 204, Loss: 0.683397613465786\n",
      "Validation Loss: 1.0488198002179463, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 205, Loss: 0.7058802129966872\n",
      "Validation Loss: 1.0374821888075934, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 206, Loss: 0.7286688004221235\n",
      "Validation Loss: 1.0458938479423523, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 207, Loss: 0.6629254679594722\n",
      "Validation Loss: 1.029844840367635, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 208, Loss: 0.6992996271167483\n",
      "Validation Loss: 1.042761868900723, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 209, Loss: 0.7218584737607411\n",
      "Validation Loss: 1.0403672986560397, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 210, Loss: 0.7067253355469022\n",
      "Validation Loss: 1.0379985570907593, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 211, Loss: 0.7267495925937381\n",
      "Validation Loss: 1.0451031923294067, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 212, Loss: 0.6647688427141735\n",
      "Validation Loss: 1.0422329439057245, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 213, Loss: 0.6526093940649714\n",
      "Validation Loss: 1.0229116545783148, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 214, Loss: 0.6804827792303902\n",
      "Validation Loss: 1.0346443321969774, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 215, Loss: 0.6973320543766022\n",
      "Validation Loss: 1.046387771765391, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 216, Loss: 0.7627297682421548\n",
      "Validation Loss: 1.0513396130667791, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 217, Loss: 0.6739012428692409\n",
      "Validation Loss: 1.0392940243085225, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 218, Loss: 0.6735209354332515\n",
      "Validation Loss: 1.0349410242504544, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 219, Loss: 0.6918437161615917\n",
      "Validation Loss: 1.0452548662821453, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 220, Loss: 0.7289465921265739\n",
      "Validation Loss: 1.0387414164013333, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 221, Loss: 0.7301509486777442\n",
      "Validation Loss: 1.0470604565408494, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 222, Loss: 0.6900247239640781\n",
      "Validation Loss: 1.0417077740033467, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 223, Loss: 0.7054671102336475\n",
      "Validation Loss: 1.041286336051093, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 224, Loss: 0.6991709406886782\n",
      "Validation Loss: 1.0390265252855089, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 225, Loss: 0.6679434052535466\n",
      "Validation Loss: 1.04027611679501, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 226, Loss: 0.6564377109919276\n",
      "Validation Loss: 1.02777608566814, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 227, Loss: 0.669881423669202\n",
      "Validation Loss: 1.02566001812617, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 228, Loss: 0.698920947100435\n",
      "Validation Loss: 1.0431550277603998, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 229, Loss: 0.6887284485357148\n",
      "Validation Loss: 1.0395655830701191, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 230, Loss: 0.6584698674934251\n",
      "Validation Loss: 1.0539593034320407, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 231, Loss: 0.6654594114848545\n",
      "Validation Loss: 1.0424038701587253, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 232, Loss: 0.6801307041730199\n",
      "Validation Loss: 1.0322765939765506, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 233, Loss: 0.681359833904675\n",
      "Validation Loss: 1.0322413974338107, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 234, Loss: 0.6863047395433698\n",
      "Validation Loss: 1.0550714631875355, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 235, Loss: 0.6832244768738747\n",
      "Validation Loss: 1.04342254002889, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 236, Loss: 0.697866535612515\n",
      "Validation Loss: 1.03139814403322, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 237, Loss: 0.6492612415126392\n",
      "Validation Loss: 1.0369587143262227, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 238, Loss: 0.6801145598292351\n",
      "Validation Loss: 1.0279492537180583, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 239, Loss: 0.683598915381091\n",
      "Validation Loss: 1.0468355615933735, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 240, Loss: 0.6488091349601746\n",
      "Validation Loss: 1.0371298326386347, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 241, Loss: 0.6527578287890979\n",
      "Validation Loss: 1.0253924330075581, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 242, Loss: 0.6450792987431798\n",
      "Validation Loss: 1.021730535560184, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 243, Loss: 0.6935174401317324\n",
      "Validation Loss: 1.0369013216760423, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 244, Loss: 0.6481384932994843\n",
      "Validation Loss: 1.0404331783453624, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 245, Loss: 0.6777391561440059\n",
      "Validation Loss: 1.0333778195910983, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 246, Loss: 0.6483711174556187\n",
      "Validation Loss: 1.029305550787184, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 247, Loss: 0.6275548455970628\n",
      "Validation Loss: 1.0440255535973444, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 248, Loss: 0.6685600940670285\n",
      "Validation Loss: 1.02402553624577, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 249, Loss: 0.6785324460693768\n",
      "Validation Loss: 1.0308638148837619, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 250, Loss: 0.6633324186716761\n",
      "Validation Loss: 1.0438765353626676, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 251, Loss: 0.6471688651612827\n",
      "Validation Loss: 1.041141089465883, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 252, Loss: 0.6058555096387863\n",
      "Validation Loss: 1.0290778776009877, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 253, Loss: 0.6253622078469822\n",
      "Validation Loss: 1.0270336502128177, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 254, Loss: 0.6404949086053031\n",
      "Validation Loss: 1.0263839264710743, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 255, Loss: 0.655136668256351\n",
      "Validation Loss: 1.0274215506182776, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 256, Loss: 0.6286451348236629\n",
      "Validation Loss: 1.0183050400680966, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 257, Loss: 0.6666120141744614\n",
      "Validation Loss: 1.0141351686583624, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 258, Loss: 0.6051595200385366\n",
      "Validation Loss: 1.0290903117921617, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 259, Loss: 0.6772567321147237\n",
      "Validation Loss: 1.0325297680166032, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 260, Loss: 0.6454180287463325\n",
      "Validation Loss: 1.035472767220603, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 261, Loss: 0.6135353456650462\n",
      "Validation Loss: 1.0219709012243483, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 262, Loss: 0.64903674274683\n",
      "Validation Loss: 1.0286455783579085, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 263, Loss: 0.6488848232797214\n",
      "Validation Loss: 1.020331194003423, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 264, Loss: 0.6287677330630166\n",
      "Validation Loss: 1.0261382559935253, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 265, Loss: 0.6671165036303657\n",
      "Validation Loss: 1.0302561355961695, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 266, Loss: 0.5949893114822251\n",
      "Validation Loss: 1.0248392754130893, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 267, Loss: 0.6537145546504429\n",
      "Validation Loss: 1.037840677632226, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 268, Loss: 0.5766841641494206\n",
      "Validation Loss: 1.0229446391264598, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 269, Loss: 0.6688490424837384\n",
      "Validation Loss: 1.0420971877045102, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 270, Loss: 0.665588301207338\n",
      "Validation Loss: 1.0235518548223708, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 271, Loss: 0.6384702069418771\n",
      "Validation Loss: 1.0259821315606434, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 272, Loss: 0.6497094950505665\n",
      "Validation Loss: 1.0286653770340815, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 273, Loss: 0.638911457998412\n",
      "Validation Loss: 1.032795011997223, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 274, Loss: 0.6058873874800546\n",
      "Validation Loss: 1.022642993264728, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 275, Loss: 0.631085468190057\n",
      "Validation Loss: 1.023720446560118, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 276, Loss: 0.7095239354031426\n",
      "Validation Loss: 1.0216571125719283, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 277, Loss: 0.5752078518271446\n",
      "Validation Loss: 1.0279599726200104, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 278, Loss: 0.5909209666507584\n",
      "Validation Loss: 1.031821032365163, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 279, Loss: 0.6529325151017734\n",
      "Validation Loss: 1.032080716556973, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 280, Loss: 0.6463953267250743\n",
      "Validation Loss: 1.0342413617504969, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 281, Loss: 0.5791174524596759\n",
      "Validation Loss: 1.041966822412279, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 282, Loss: 0.6072876208594867\n",
      "Validation Loss: 1.0334188441435497, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 283, Loss: 0.6171274802514485\n",
      "Validation Loss: 1.031763666205936, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 284, Loss: 0.5695641221744674\n",
      "Validation Loss: 1.0284218854374356, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 285, Loss: 0.5964299472314971\n",
      "Validation Loss: 1.0210891034868028, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 286, Loss: 0.619514310998576\n",
      "Validation Loss: 1.0346713728374906, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 287, Loss: 0.5894201078585216\n",
      "Validation Loss: 1.0309492150942485, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 288, Loss: 0.6587280396904264\n",
      "Validation Loss: 1.0157833496729534, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 289, Loss: 0.6191676067454475\n",
      "Validation Loss: 1.0281013482146792, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 290, Loss: 0.6130677397762027\n",
      "Validation Loss: 1.021776341729694, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 291, Loss: 0.6558088809251785\n",
      "Validation Loss: 1.02652574578921, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 292, Loss: 0.5882678159645626\n",
      "Validation Loss: 1.0160657001866236, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 293, Loss: 0.6314500761883599\n",
      "Validation Loss: 1.0186726715829637, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 294, Loss: 0.6452718558056014\n",
      "Validation Loss: 1.0082577632533178, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 295, Loss: 0.6270741032702583\n",
      "Validation Loss: 1.0296925273206499, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 296, Loss: 0.601477141891207\n",
      "Validation Loss: 1.0222232706016965, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 297, Loss: 0.6107114617313657\n",
      "Validation Loss: 1.0339378813902538, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 298, Loss: 0.6641169232981545\n",
      "Validation Loss: 1.023208436038759, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 299, Loss: 0.5962631585342544\n",
      "Validation Loss: 1.0280445218086243, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 300, Loss: 0.6044428071805409\n",
      "Validation Loss: 1.0198297964202032, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 301, Loss: 0.5856516254799706\n",
      "Validation Loss: 1.0173802971839905, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 302, Loss: 0.582062556807484\n",
      "Validation Loss: 1.0220959815714095, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 303, Loss: 0.6672660538128444\n",
      "Validation Loss: 1.0314721299542322, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 304, Loss: 0.5908884869090149\n",
      "Validation Loss: 1.0256309575504727, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 305, Loss: 0.5825215131044388\n",
      "Validation Loss: 1.0189320378833346, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 306, Loss: 0.585548962865557\n",
      "Validation Loss: 1.0348493258158367, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 307, Loss: 0.5098172905189651\n",
      "Validation Loss: 1.030424588256412, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 308, Loss: 0.5804908999374935\n",
      "Validation Loss: 1.0305964946746826, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 309, Loss: 0.6138339532273156\n",
      "Validation Loss: 1.0223144392172496, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 310, Loss: 0.5369112119078636\n",
      "Validation Loss: 1.0314867231580946, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 311, Loss: 0.5518815283264432\n",
      "Validation Loss: 1.0328895350297291, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 312, Loss: 0.5698446854948997\n",
      "Validation Loss: 1.0235756072733138, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 313, Loss: 0.5627037403838975\n",
      "Validation Loss: 1.0352598362498813, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 314, Loss: 0.5857576600142888\n",
      "Validation Loss: 1.030405428674486, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 315, Loss: 0.5837074821548802\n",
      "Validation Loss: 1.0528083940347035, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 316, Loss: 0.5507215570126262\n",
      "Validation Loss: 1.0313030944930182, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 317, Loss: 0.5396187795060021\n",
      "Validation Loss: 1.0335322552257113, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 318, Loss: 0.5779912918806076\n",
      "Validation Loss: 1.0342132945855458, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 319, Loss: 0.5698443257382938\n",
      "Validation Loss: 1.0209299325942993, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 320, Loss: 0.6117370064769473\n",
      "Validation Loss: 1.026577694548501, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 321, Loss: 0.598302564982857\n",
      "Validation Loss: 1.032641890976164, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 322, Loss: 0.5944090677159173\n",
      "Validation Loss: 1.0313864019181993, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 323, Loss: 0.602225952914783\n",
      "Validation Loss: 1.0202160014046564, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 324, Loss: 0.5897266609328133\n",
      "Validation Loss: 1.0166497396098242, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 325, Loss: 0.5231045159910407\n",
      "Validation Loss: 1.0180455810493894, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 326, Loss: 0.6201461159757206\n",
      "Validation Loss: 1.055948532289929, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 327, Loss: 0.6055047959089279\n",
      "Validation Loss: 1.0111710959010654, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 328, Loss: 0.5736791507474014\n",
      "Validation Loss: 1.0274785790178511, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 329, Loss: 0.5677367720220771\n",
      "Validation Loss: 1.0294116735458374, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 330, Loss: 0.5656305721827916\n",
      "Validation Loss: 1.023047192229165, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 331, Loss: 0.5599889707352433\n",
      "Validation Loss: 1.0336589018503826, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 332, Loss: 0.55746171942779\n",
      "Validation Loss: 1.0157265663146973, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 333, Loss: 0.5188495612570218\n",
      "Validation Loss: 1.024392094877031, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 334, Loss: 0.5756090826221875\n",
      "Validation Loss: 1.019052220715417, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 335, Loss: 0.5624563342758587\n",
      "Validation Loss: 1.025668975379732, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 336, Loss: 0.6147845536470413\n",
      "Validation Loss: 1.0136986904674106, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 337, Loss: 0.5384420827031136\n",
      "Validation Loss: 1.0234245359897614, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 338, Loss: 0.5369396486452648\n",
      "Validation Loss: 1.0198992556995816, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 339, Loss: 0.48991493774311884\n",
      "Validation Loss: 1.0279888543817732, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 340, Loss: 0.583224241222654\n",
      "Validation Loss: 1.0163697335455153, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 341, Loss: 0.5762073445533004\n",
      "Validation Loss: 1.031588743130366, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 342, Loss: 0.5615353094679969\n",
      "Validation Loss: 1.0211209787262812, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 343, Loss: 0.6009103011872087\n",
      "Validation Loss: 1.0362816287411585, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 344, Loss: 0.5888340398669243\n",
      "Validation Loss: 1.032753285434511, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 345, Loss: 0.5604305900633335\n",
      "Validation Loss: 1.0218631260924869, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 346, Loss: 0.5237735286355019\n",
      "Validation Loss: 1.0139569838841755, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 347, Loss: 0.5814473985561303\n",
      "Validation Loss: 1.021699246433046, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 348, Loss: 0.5483897791377136\n",
      "Validation Loss: 1.0101194083690643, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 349, Loss: 0.5561784064131123\n",
      "Validation Loss: 1.0154774983723958, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 350, Loss: 0.5496764672654015\n",
      "Validation Loss: 1.0187518695990245, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 351, Loss: 0.5623492795441832\n",
      "Validation Loss: 1.0221632950835757, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 352, Loss: 0.5072727490748677\n",
      "Validation Loss: 1.0219499336348639, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 353, Loss: 0.5577732814209801\n",
      "Validation Loss: 1.027592612637414, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 354, Loss: 0.5380125609891755\n",
      "Validation Loss: 1.0262829462687175, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 355, Loss: 0.5472902863153389\n",
      "Validation Loss: 1.018225567208396, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 356, Loss: 0.5368926679449422\n",
      "Validation Loss: 1.0319335261980693, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 357, Loss: 0.566623925098351\n",
      "Validation Loss: 1.0245659384462569, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 358, Loss: 0.5621656381658146\n",
      "Validation Loss: 1.0306310554345448, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 359, Loss: 0.5193907437579972\n",
      "Validation Loss: 1.00303049882253, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 360, Loss: 0.5469371101685933\n",
      "Validation Loss: 1.0190068085988362, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 361, Loss: 0.560219484780516\n",
      "Validation Loss: 1.0314123001363542, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 362, Loss: 0.5152672582439014\n",
      "Validation Loss: 1.0270222226778667, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 363, Loss: 0.5584965944290161\n",
      "Validation Loss: 1.025640047258801, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 364, Loss: 0.6246820629707405\n",
      "Validation Loss: 1.0261820885870192, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 365, Loss: 0.5306230496082988\n",
      "Validation Loss: 1.0297771195570629, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 366, Loss: 0.5619318038225174\n",
      "Validation Loss: 1.0110341244273715, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 367, Loss: 0.5314656581197467\n",
      "Validation Loss: 1.0140665074189503, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 368, Loss: 0.5004809120936053\n",
      "Validation Loss: 1.0167073143853083, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 369, Loss: 0.5421199186572007\n",
      "Validation Loss: 1.0218565165996552, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 370, Loss: 0.5607127930436816\n",
      "Validation Loss: 1.0228305690818362, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 371, Loss: 0.5274751149117947\n",
      "Validation Loss: 1.0276505715317197, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 372, Loss: 0.5371557367699487\n",
      "Validation Loss: 1.0109502540694342, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 373, Loss: 0.5211095096809524\n",
      "Validation Loss: 1.018228315644794, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 374, Loss: 0.5646497160196304\n",
      "Validation Loss: 1.0222215851147969, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 375, Loss: 0.5472440442868641\n",
      "Validation Loss: 1.0155011117458344, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 376, Loss: 0.5575112503554139\n",
      "Validation Loss: 1.0266417298052046, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 377, Loss: 0.5675632203263896\n",
      "Validation Loss: 1.0231975979275174, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 378, Loss: 0.5419289352638381\n",
      "Validation Loss: 1.0241469376617007, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 379, Loss: 0.5586905367672443\n",
      "Validation Loss: 1.0221247971057892, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 380, Loss: 0.5379802446280207\n",
      "Validation Loss: 1.0326395167244806, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 381, Loss: 0.5648100525140762\n",
      "Validation Loss: 1.037385904126697, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 382, Loss: 0.547805015529905\n",
      "Validation Loss: 1.0374020404285855, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 383, Loss: 0.5167131785835538\n",
      "Validation Loss: 1.0210649735397763, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 384, Loss: 0.617660080747945\n",
      "Validation Loss: 1.033778793281979, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 385, Loss: 0.5543447818074908\n",
      "Validation Loss: 1.0338469909297094, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 386, Loss: 0.5446014058377061\n",
      "Validation Loss: 1.0225885212421417, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 387, Loss: 0.5273850352636406\n",
      "Validation Loss: 1.0183323721090953, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 388, Loss: 0.5438135867672307\n",
      "Validation Loss: 1.030383480919732, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 389, Loss: 0.526733289871897\n",
      "Validation Loss: 1.031252642472585, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 390, Loss: 0.5304159788148743\n",
      "Validation Loss: 1.0305900209479861, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 391, Loss: 0.5050156302750111\n",
      "Validation Loss: 1.0243539247247908, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 392, Loss: 0.5117329034422126\n",
      "Validation Loss: 1.0070315500100453, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 393, Loss: 0.533295781484672\n",
      "Validation Loss: 1.0280916061666276, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 394, Loss: 0.5491443648934364\n",
      "Validation Loss: 1.0462493201096852, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 395, Loss: 0.572743150804724\n",
      "Validation Loss: 1.0500562753942277, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 396, Loss: 0.5464597748858588\n",
      "Validation Loss: 1.0282567607031927, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 397, Loss: 0.5515060424804688\n",
      "Validation Loss: 1.0377602378527324, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 398, Loss: 0.5263471113783973\n",
      "Validation Loss: 1.0087159739600287, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 399, Loss: 0.5943898154156548\n",
      "Validation Loss: 1.0261391864882574, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n",
      "Epoch 400, Loss: 0.5349246359297207\n",
      "Validation Loss: 1.0194942222701178, Total Accuracy: 50.00%\n",
      "Accuracy per class - G1: 0.00%, G2: 62.50%, G3: 66.67%\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\u001b[34m\u001b[1mwandb\u001b[0m:                                                                                \n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: \n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: Run history:\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:          G1_Acc ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:     G1_TrainAcc ▁▂▃▄▄▄▄▄▅▅▄▅▅▅▅▇▆▅▆▅▇█▇▆███▇█▇███▇██████\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:          G2_Acc ▁▁▁▁▁▅██████████████████████████████████\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:     G2_TrainAcc ▁▁▁▂▃▃▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▆▇▇▇▇▆▇▇▇▇██▇█████\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:          G3_Acc ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:     G3_TrainAcc ████▅▇█▇█▇▅▇█▅▇▄█▅▇▄▄▅▁▇▇▅▇▅▅▅▇▇▄▇▇▇▅▄▄▇\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:  Total Accuracy ▁▁▁▁▂▇██████████████████████████████████\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:  Train Accuracy ▁▁▂▂▂▃▄▄▄▅▅▆▅▅▆▆▇▆▆▆▆▆▇▇▇▇▇▇██▇██▇█▇████\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:      Train loss █▇▇▇▇▆▆▆▆▆▆▆▅▅▆▅▅▅▅▄▄▄▄▄▄▃▃▃▃▂▂▂▂▂▂▂▂▂▁▂\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: Validation Loss ██▇▇▇▆▆▇▇▆▆▆▅▆▅▃▅▃▄▂▃▃▃▃▂▃▂▂▂▁▂▂▂▁▂▂▁▁▁▁\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: \n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: Run summary:\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:          G1_Acc 0\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:     G1_TrainAcc 100\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:          G2_Acc 62.5\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:     G2_TrainAcc 71.42857\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:          G3_Acc 66.66667\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:     G3_TrainAcc 100\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:  Total Accuracy 50\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:  Train Accuracy 81.29496\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m:      Train loss 0.53492\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: Validation Loss 1.01949\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: \n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: 🚀 View run \u001b[33mResNet3D original best weighted loss\u001b[0m at: \u001b[34m\u001b[4mhttps://wandb.ai/pietro-caforio-politecnico-di-milano/3Dunimodal_ct_training/runs/wvw6dd5p\u001b[0m\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: ⭐️ View project at: \u001b[34m\u001b[4mhttps://wandb.ai/pietro-caforio-politecnico-di-milano/3Dunimodal_ct_training\u001b[0m\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)\n",
      "\u001b[34m\u001b[1mwandb\u001b[0m: Find logs at: \u001b[35m\u001b[1m./wandb/run-20241013_042251-wvw6dd5p/logs\u001b[0m\n"
     ]
    }
   ],
   "source": [
    "from focal_loss.focal_loss import FocalLoss\n",
    "config={\n",
    "    \"learning_rate\": 1e-7,\n",
    "    \"architecture\": \"ResNet3D original best weighted loss\",\n",
    "    \"epochs\": 400,\n",
    "    \"weight_decay\": 1e-6,\n",
    "    \"reduce_lr_factor\": 0.25,\n",
    "    \"patience\": 40,\n",
    "    \"class_weights\": class_weights,\n",
    "    \"early_stop_patience\": None,\n",
    "    \"focal_loss\": None\n",
    "    }\n",
    "train(model, config, run_name = config[\"architecture\"])"
   ]
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "gpu",
   "dataSources": [
    {
     "datasetId": 5664308,
     "sourceId": 9547833,
     "sourceType": "datasetVersion"
    },
    {
     "datasetId": 5863281,
     "sourceId": 9609374,
     "sourceType": "datasetVersion"
    }
   ],
   "dockerImageVersionId": 30787,
   "isGpuEnabled": true,
   "isInternetEnabled": true,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.14"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 20805.099873,
   "end_time": "2024-10-13T10:08:24.608906",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2024-10-13T04:21:39.509033",
   "version": "2.6.0"
  },
  "widgets": {
   "application/vnd.jupyter.widget-state+json": {
    "state": {
     "0f74e50d11824c589594423e545fb4fd": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.5.0",
      "model_name": "DescriptionStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "1.5.0",
       "_model_name": "DescriptionStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "1.2.0",
       "_view_name": "StyleView",
       "description_width": ""
      }
     },
     "143ad20d35434be89f39cdac70e0081d": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.5.0",
      "model_name": "DescriptionStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "1.5.0",
       "_model_name": "DescriptionStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "1.2.0",
       "_view_name": "StyleView",
       "description_width": ""
      }
     },
     "148dbfbb28564c9392b3e506f8ad78d6": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.5.0",
      "model_name": "HBoxModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "1.5.0",
       "_model_name": "HBoxModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "1.5.0",
       "_view_name": "HBoxView",
       "box_style": "",
       "children": [
        "IPY_MODEL_6a4a435278744922ba00185fa0628e06",
        "IPY_MODEL_a290bba08f9542f9bf35798535d390d9",
        "IPY_MODEL_4dc614faa4bd4cf9a688353619da2b0e"
       ],
       "layout": "IPY_MODEL_655f98d76beb4cfdbd790f0620af4fce"
      }
     },
     "19c4b812c58d4ab6bc3cd5d7bea9fdf8": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.2.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "1.2.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "1.2.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "overflow_x": null,
       "overflow_y": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "4dc614faa4bd4cf9a688353619da2b0e": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.5.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "1.5.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "1.5.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_tooltip": null,
       "layout": "IPY_MODEL_19c4b812c58d4ab6bc3cd5d7bea9fdf8",
       "placeholder": "​",
       "style": "IPY_MODEL_b13021f1f89f4786a7353648fc1a5884",
       "value": " 46.8M/46.8M [00:03&lt;00:00, 15.1MB/s]"
      }
     },
     "5aabee46e73c4e1e949fe611f697add0": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.5.0",
      "model_name": "ProgressStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "1.5.0",
       "_model_name": "ProgressStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "1.2.0",
       "_view_name": "StyleView",
       "bar_color": null,
       "description_width": ""
      }
     },
     "5e578b3fcc5c437791b41c60ead2f373": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.2.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "1.2.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "1.2.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "overflow_x": null,
       "overflow_y": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "6213dd8318994913b79d296acfb123b7": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.5.0",
      "model_name": "FloatProgressModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "1.5.0",
       "_model_name": "FloatProgressModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "1.5.0",
       "_view_name": "ProgressView",
       "bar_style": "success",
       "description": "",
       "description_tooltip": null,
       "layout": "IPY_MODEL_5e578b3fcc5c437791b41c60ead2f373",
       "max": 69548,
       "min": 0,
       "orientation": "horizontal",
       "style": "IPY_MODEL_5aabee46e73c4e1e949fe611f697add0",
       "value": 69548
      }
     },
     "62de300bb21143b68602e94c74e3f39b": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.2.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "1.2.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "1.2.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "overflow_x": null,
       "overflow_y": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "655f98d76beb4cfdbd790f0620af4fce": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.2.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "1.2.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "1.2.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "overflow_x": null,
       "overflow_y": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "6a4a435278744922ba00185fa0628e06": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.5.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "1.5.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "1.5.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_tooltip": null,
       "layout": "IPY_MODEL_f1e9deee886e441990c8086b244101b2",
       "placeholder": "​",
       "style": "IPY_MODEL_143ad20d35434be89f39cdac70e0081d",
       "value": "model.safetensors: 100%"
      }
     },
     "70c0081ec8cf4159b2cd1184eae53b5d": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.2.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "1.2.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "1.2.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "overflow_x": null,
       "overflow_y": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "7dd733ad658b48359feb02f8c0436c62": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.2.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "1.2.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "1.2.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "overflow_x": null,
       "overflow_y": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "7f4be5cd22f64a6ebf8629388d9fe314": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.5.0",
      "model_name": "HBoxModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "1.5.0",
       "_model_name": "HBoxModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "1.5.0",
       "_view_name": "HBoxView",
       "box_style": "",
       "children": [
        "IPY_MODEL_f98e6a28a77b460aa5b9c367684afbf6",
        "IPY_MODEL_6213dd8318994913b79d296acfb123b7",
        "IPY_MODEL_97a6dfab7007407cac133d69ba3394c0"
       ],
       "layout": "IPY_MODEL_7fe107f7ec564556bbd41a700510e787"
      }
     },
     "7fe107f7ec564556bbd41a700510e787": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.2.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "1.2.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "1.2.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "overflow_x": null,
       "overflow_y": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "8c90ff6ae7f44ed1a6a8496e9269d845": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.5.0",
      "model_name": "ProgressStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "1.5.0",
       "_model_name": "ProgressStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "1.2.0",
       "_view_name": "StyleView",
       "bar_color": null,
       "description_width": ""
      }
     },
     "97a6dfab7007407cac133d69ba3394c0": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.5.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "1.5.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "1.5.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_tooltip": null,
       "layout": "IPY_MODEL_70c0081ec8cf4159b2cd1184eae53b5d",
       "placeholder": "​",
       "style": "IPY_MODEL_e7c6b1c1c6304d2ca4e35472b1f690b4",
       "value": " 69.5k/69.5k [00:00&lt;00:00, 326kB/s]"
      }
     },
     "a290bba08f9542f9bf35798535d390d9": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.5.0",
      "model_name": "FloatProgressModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "1.5.0",
       "_model_name": "FloatProgressModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "1.5.0",
       "_view_name": "ProgressView",
       "bar_style": "success",
       "description": "",
       "description_tooltip": null,
       "layout": "IPY_MODEL_7dd733ad658b48359feb02f8c0436c62",
       "max": 46812324,
       "min": 0,
       "orientation": "horizontal",
       "style": "IPY_MODEL_8c90ff6ae7f44ed1a6a8496e9269d845",
       "value": 46812324
      }
     },
     "b13021f1f89f4786a7353648fc1a5884": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.5.0",
      "model_name": "DescriptionStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "1.5.0",
       "_model_name": "DescriptionStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "1.2.0",
       "_view_name": "StyleView",
       "description_width": ""
      }
     },
     "e7c6b1c1c6304d2ca4e35472b1f690b4": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.5.0",
      "model_name": "DescriptionStyleModel",
      "state": {
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "1.5.0",
       "_model_name": "DescriptionStyleModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "1.2.0",
       "_view_name": "StyleView",
       "description_width": ""
      }
     },
     "f1e9deee886e441990c8086b244101b2": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.2.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "1.2.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "1.2.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "overflow_x": null,
       "overflow_y": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "f98e6a28a77b460aa5b9c367684afbf6": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.5.0",
      "model_name": "HTMLModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "@jupyter-widgets/controls",
       "_model_module_version": "1.5.0",
       "_model_name": "HTMLModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/controls",
       "_view_module_version": "1.5.0",
       "_view_name": "HTMLView",
       "description": "",
       "description_tooltip": null,
       "layout": "IPY_MODEL_62de300bb21143b68602e94c74e3f39b",
       "placeholder": "​",
       "style": "IPY_MODEL_0f74e50d11824c589594423e545fb4fd",
       "value": "config.json: 100%"
      }
     }
    },
    "version_major": 2,
    "version_minor": 0
   }
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
